(* Content-type: application/mathematica *)

(*** Wolfram Notebook File ***)
(* http://www.wolfram.com/nb *)

(* CreatedBy='Mathematica 7.0' *)

(*CacheID: 234*)
(* Internal cache information:
NotebookFileLineBreakTest
NotebookFileLineBreakTest
NotebookDataPosition[       145,          7]
NotebookDataLength[    329137,       9668]
NotebookOptionsPosition[    314860,       9221]
NotebookOutlinePosition[    315295,       9239]
CellTagsIndexPosition[    315252,       9236]
WindowFrame->Normal*)

(* Beginning of Notebook Content *)
Notebook[{
Cell[BoxData[
 RowBox[{
  RowBox[{"Needs", "[", "\"\<Statistics`ContinuousDistributions`\>\"", "]"}], 
  ";"}]], "Input",
 InitializationCell->True],

Cell[BoxData[
 RowBox[{
  RowBox[{"Needs", "[", "\"\<Statistics`DiscreteDistributions`\>\"", "]"}], 
  ";"}]], "Input",
 InitializationCell->True],

Cell[BoxData[
 RowBox[{
  RowBox[{"Needs", "[", "\"\<Statistics`NormalDistribution`\>\"", "]"}], 
  ";"}]], "Input",
 InitializationCell->True],

Cell[BoxData[
 RowBox[{
  RowBox[{"Needs", "[", "\"\<MultivariateStatistics`\>\"", "]"}], 
  ";"}]], "Input",
 InitializationCell->True],

Cell[BoxData[{
 RowBox[{
  RowBox[{
  "The", " ", "distributions", " ", "and", " ", "the", " ", "processes", " ", 
   "that", " ", "are", " ", "below", " ", "described"}], " ", ",", " ", 
  RowBox[{
  "assume", " ", "given", " ", "a", " ", "state", " ", "ofthe", " ", "world", 
   " ", "that", " ", "they", " ", "can", " ", "access", " ", "because", " ", 
   "they", " ", "are", " ", "specified", " ", "as", " ", "functions", " ", 
   "of", " ", "this", " ", 
   RowBox[{"argument", " ", ".", " ", "They"}], " ", "are", " ", "assumed", 
   " ", "to", " ", "discribe", " ", "the", " ", "distribution", " ", "of", 
   " ", "the", " ", "shift", " ", "on", " ", "this", " ", 
   RowBox[{"argument", ".", "\[IndentingNewLine]", "A"}], " ", "distribution",
    " ", "is", " ", "a", " ", "function", " ", "which", " ", "applied", " ", 
   "to", " ", "this", " ", "argument"}], ",", " ", 
  RowBox[{
  "returns", " ", "an", " ", "object", " ", "dist", " ", "that", " ", "can", 
   " ", "be", " ", "submitted", " ", "to", " ", "the", " ", "function", " ", 
   RowBox[{"Random", "[", "dist", "]"}], " ", "and", " ", 
   RowBox[{"Quantile", "[", "dist", "]"}]}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
  "A", " ", "process", " ", "is", " ", "a", " ", "function", " ", "that", " ",
    "return", " ", "an", " ", "other", " ", "function", " ", "that", " ", 
   "can", " ", "be", " ", "applied", " ", "to", " ", "two", " ", 
   RowBox[{"arguments", " ", ":", " ", "t1"}]}], ",", 
  RowBox[{
  "t2", " ", "and", " ", "the", " ", "result", " ", "of", " ", "this", " ", 
   "function", " ", "on", " ", 
   RowBox[{"{", 
    RowBox[{"t1", ",", "t2"}], "}"}], " ", "is", " ", "a", " ", "sample", " ",
    "of", " ", "the", " ", "shift", " ", "to", " ", 
   RowBox[{"apply", "."}]}]}]}], "Input"],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", " ", 
   RowBox[{"exemple", " ", "of", " ", "distribution"}], " ", "*)"}], 
  "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{"dist1", "=", " ", 
    RowBox[{
     RowBox[{"If", "[", 
      RowBox[{
       RowBox[{"#", "\[GreaterEqual]", " ", "0"}], ",", 
       RowBox[{"StudentTDistribution", "[", 
        RowBox[{"2.2", " ", "#"}], "]"}], " ", ",", " ", 
       RowBox[{"ExponentialDistribution", "[", 
        RowBox[{
         RowBox[{"-", "1.1"}], " ", "#"}], "]"}]}], "]"}], "&"}]}], 
   ";"}]}]], "Input"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"MultiStepScenarioTree", "[", 
   RowBox[{"DimensionList_", ",", "DateList_", ",", "NodeList_"}], "]"}], " ",
   "is", " ", "the", " ", "result", " ", "of", "  ", 
  "generation"}], "\[IndentingNewLine]", 
 RowBox[{"      ", 
  RowBox[{
   RowBox[{
   "DimensionList", " ", "is", " ", "a", " ", "list", " ", "of", " ", 
    "descriptor", " ", "of", " ", "the", " ", "dimensions"}], ",", " ", 
   RowBox[{
   "it", " ", "could", " ", "be", " ", "strings", " ", "or", " ", 
    "symbols"}]}]}], "\[IndentingNewLine]", 
 RowBox[{"      ", 
  RowBox[{
  "DateList", " ", "is", " ", "the", " ", "list", " ", "of", " ", "the", " ", 
   "dates", " ", "associated", " ", "with", " ", 
   RowBox[{"nodes", ".", "\[IndentingNewLine]", "NodeList"}], " ", "is", " ", 
   "a", " ", "list", " ", "of", " ", 
   RowBox[{"{", 
    RowBox[{
    "nodename", ",", " ", "date", ",", " ", "Valuelist", ",", 
     "antecedentnodename"}], "}"}], " ", "they", " ", "are", " ", "sorted", 
   " ", "by", " ", "dates"}]}], "\[IndentingNewLine]", 
 RowBox[{"Valuelist", " ", "is", " ", "a", " ", "n", " ", "ordered", " ", 
  "list", " ", "of", " ", "reals", " ", "or", " ", "integer"}]}], "Input"],

Cell[BoxData[{
 RowBox[{"FromDistributionTree", "[", 
  RowBox[{"DimensionList_", ",", "OneStepDistributionList_"}], 
  "]"}], "\[IndentingNewLine]", 
 RowBox[{"  ", 
  RowBox[{
  "need", " ", "a", " ", "description", " ", "of", " ", "the", " ", "list", 
   " ", "of", " ", 
   RowBox[{"{", 
    RowBox[{"dist_", ",", "timestep_", ",", "branching_"}], "}"}], 
   "branching", " ", "numbers", " ", "and", " ", "the", " ", "distributions", 
   " ", "involved", " ", "at", " ", "each", "  ", 
   "branching"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"it", " ", "generates", " ", "a", " ", "MultiStepScenarioTree"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{"FromProcessTree", "[", 
  RowBox[{
  "DimensionList_", ",", "Process_", ",", "TimeStepsList_", ",", " ", 
   "branchingfactorlist_"}], "]"}], "\[IndentingNewLine]", 
 RowBox[{"generates", " ", "a", " ", "MultiStepScenarioTree"}]}], "Input"],

Cell[BoxData[{
 RowBox[{"OrthogonalCombineSpaces", "[", "TreeList_", 
  "]"}], "\[IndentingNewLine]", 
 RowBox[{"     ", 
  RowBox[{
  "Combine", " ", "the", " ", "trees", " ", "by", " ", "assuming", " ", 
   "orthogonality", " ", "between", " ", "risk", " ", 
   RowBox[{"factors", ".", "\[IndentingNewLine]", "TreeList"}], " ", "is", 
   " ", "a", " ", "list", " ", "of", " ", "objects", " ", "that", " ", "can", 
   " ", "be", " ", "FromProcessTree", " ", "or", " ", "FromDistributionTree", 
   " ", "or", " ", "OrthogonalCombineSpaces", " ", "or", " ", "a", " ", 
   "Sequence"}]}], "\[IndentingNewLine]", 
 RowBox[{"    ", 
  RowBox[{
  "the", " ", "DateList", " ", "of", " ", "both", " ", "objects", " ", 
   "should", " ", "be", " ", "the", " ", "same"}]}]}], "Input"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"Sequence", "[", "ScenGenObjList_", "]"}], "\[IndentingNewLine]", 
  " "}], "\n", 
 RowBox[{"Declare", " ", "a", " ", "ScenGenObj", " ", "that", " ", "sequence",
   " ", "the", " ", "ScenGenObj", " ", "declared", " ", "in", " ", "the", " ", 
  RowBox[{"list", ".", " "}]}]}], "Input"],

Cell[BoxData[
 RowBox[{
  RowBox[{"DateListFrom", "[", "ScenGenObj_", "]"}], " ", "compute", " ", 
  "the", " ", "DateList", " ", "ofthe", " ", 
  RowBox[{"ScenGenObj", "."}]}]], "Input"],

Cell[BoxData[
 RowBox[{
  RowBox[{"CompleteScenGen", "[", 
   RowBox[{"ScenGenObj_", ",", " ", "dateList_"}], "]"}], " ", "Try", " ", 
  "to", " ", "build", "  ", "a", " ", "ScenGenObj", "  ", "that", " ", "has", 
  " ", "the", " ", "requested", " ", "datelist", " "}]], "Input"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"GenerateTree", "[", 
   RowBox[{"ScenGenObj_", ",", "x0_"}], "]"}], " ", "create", " ", "the", " ",
   "tree", " ", "associated", " ", "with", " ", "obj", " ", "applying", " ", 
  "the", " ", "shifts", " ", "on", " ", 
  RowBox[{"x0", ".", "\[IndentingNewLine]", "ScenGenObj"}], " ", "can", " ", 
  "be", " ", "FromDistributionTree", " ", "or", " ", "FromProcessTree", " ", 
  "or", " ", "OrthogonalCombineSpaces", " ", "or", " ", "a", " ", 
  "Sequence"}], "\[IndentingNewLine]", 
 RowBox[{"  ", 
  RowBox[{
  "It", " ", "check", " ", "first", " ", "that", " ", "the", " ", "datelist", 
   " ", "of", " ", "all", " ", "the", " ", "objects", " ", "are", " ", 
   "consistent"}]}]}], "Input"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"d1", "=", 
  RowBox[{"StudentTDistribution", "[", "2.2", "]"}]}]], "Input"],

Cell[BoxData[
 RowBox[{"StudentTDistribution", "[", "2.2`", "]"}]], "Output"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"Quantile", "[", 
  RowBox[{"d1", ",", "0.009925"}], "]"}]], "Input"],

Cell[BoxData[
 RowBox[{"-", "6.187394160166634`"}]], "Output"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"Plot", "[", 
  RowBox[{
   RowBox[{"CDF", "[", 
    RowBox[{
     RowBox[{"dist1", "[", "3.4", "]"}], ",", "x"}], "]"}], ",", 
   RowBox[{"{", 
    RowBox[{"x", ",", 
     RowBox[{"-", "5"}], ",", 
     RowBox[{"+", "5"}]}], "}"}]}], "]"}]], "Input"],

Cell[GraphicsData["PostScript", "\<\
%!
%%Creator: Mathematica
%%AspectRatio: .61803 
MathPictureStart
/Mabs {
Mgmatrix idtransform
Mtmatrix dtransform
} bind def
/Mabsadd { Mabs
3 -1 roll add
3 1 roll add
exch } bind def
%% Graphics
%%IncludeResource: font Courier
%%IncludeFont: Courier
/Courier findfont 10  scalefont  setfont
% Scaling calculations
0.5 0.0952381 0.0147151 0.588983 [
[.11905 .00222 -6 -9 ]
[.11905 .00222 6 0 ]
[.30952 .00222 -6 -9 ]
[.30952 .00222 6 0 ]
[.69048 .00222 -3 -9 ]
[.69048 .00222 3 0 ]
[.88095 .00222 -3 -9 ]
[.88095 .00222 3 0 ]
[.4875 .13251 -18 -4.5 ]
[.4875 .13251 0 4.5 ]
[.4875 .25031 -18 -4.5 ]
[.4875 .25031 0 4.5 ]
[.4875 .3681 -18 -4.5 ]
[.4875 .3681 0 4.5 ]
[.4875 .4859 -18 -4.5 ]
[.4875 .4859 0 4.5 ]
[.4875 .6037 -6 -4.5 ]
[.4875 .6037 0 4.5 ]
[ 0 0 0 0 ]
[ 1 .61803 0 0 ]
] MathScale
% Start of Graphics
1 setlinecap
1 setlinejoin
newpath
0 g
.25 Mabswid
[ ] 0 setdash
.11905 .01472 m
.11905 .02097 L
s
[(-4)] .11905 .00222 0 1 Mshowa
.30952 .01472 m
.30952 .02097 L
s
[(-2)] .30952 .00222 0 1 Mshowa
.69048 .01472 m
.69048 .02097 L
s
[(2)] .69048 .00222 0 1 Mshowa
.88095 .01472 m
.88095 .02097 L
s
[(4)] .88095 .00222 0 1 Mshowa
.125 Mabswid
.16667 .01472 m
.16667 .01847 L
s
.21429 .01472 m
.21429 .01847 L
s
.2619 .01472 m
.2619 .01847 L
s
.35714 .01472 m
.35714 .01847 L
s
.40476 .01472 m
.40476 .01847 L
s
.45238 .01472 m
.45238 .01847 L
s
.54762 .01472 m
.54762 .01847 L
s
.59524 .01472 m
.59524 .01847 L
s
.64286 .01472 m
.64286 .01847 L
s
.7381 .01472 m
.7381 .01847 L
s
.78571 .01472 m
.78571 .01847 L
s
.83333 .01472 m
.83333 .01847 L
s
.07143 .01472 m
.07143 .01847 L
s
.02381 .01472 m
.02381 .01847 L
s
.92857 .01472 m
.92857 .01847 L
s
.97619 .01472 m
.97619 .01847 L
s
.25 Mabswid
0 .01472 m
1 .01472 L
s
.5 .13251 m
.50625 .13251 L
s
[(0.2)] .4875 .13251 1 0 Mshowa
.5 .25031 m
.50625 .25031 L
s
[(0.4)] .4875 .25031 1 0 Mshowa
.5 .3681 m
.50625 .3681 L
s
[(0.6)] .4875 .3681 1 0 Mshowa
.5 .4859 m
.50625 .4859 L
s
[(0.8)] .4875 .4859 1 0 Mshowa
.5 .6037 m
.50625 .6037 L
s
[(1)] .4875 .6037 1 0 Mshowa
.125 Mabswid
.5 .04416 m
.50375 .04416 L
s
.5 .07361 m
.50375 .07361 L
s
.5 .10306 m
.50375 .10306 L
s
.5 .16196 m
.50375 .16196 L
s
.5 .19141 m
.50375 .19141 L
s
.5 .22086 m
.50375 .22086 L
s
.5 .27976 m
.50375 .27976 L
s
.5 .30921 m
.50375 .30921 L
s
.5 .33866 m
.50375 .33866 L
s
.5 .39755 m
.50375 .39755 L
s
.5 .427 m
.50375 .427 L
s
.5 .45645 m
.50375 .45645 L
s
.5 .51535 m
.50375 .51535 L
s
.5 .5448 m
.50375 .5448 L
s
.5 .57425 m
.50375 .57425 L
s
.25 Mabswid
.5 0 m
.5 .61803 L
s
0 0 m
1 0 L
1 .61803 L
0 .61803 L
closepath
clip
newpath
.5 Mabswid
.02381 .01509 m
.04262 .0152 L
.06244 .01534 L
.08255 .01552 L
.10458 .01581 L
.12415 .01615 L
.14509 .01665 L
.16639 .01735 L
.18653 .01827 L
.20651 .01954 L
.22495 .02112 L
.24367 .0233 L
.2643 .02661 L
.28371 .03092 L
.30459 .03731 L
.32572 .04629 L
.34581 .05793 L
.36562 .07316 L
.384 .09136 L
.42313 .14562 L
.46472 .22713 L
.50478 .32061 L
.54333 .40874 L
.56288 .44794 L
.58434 .48489 L
.60499 .51403 L
.62382 .53532 L
.64333 .55265 L
.66425 .56674 L
.68333 .57632 L
.70409 .58402 L
.72387 .58933 L
.74488 .59341 L
.76435 .59612 L
.78263 .598 L
.80281 .59952 L
.82131 .60053 L
.84024 .60131 L
.86094 .60193 L
.88055 .60236 L
.9015 .60269 L
.92284 .60294 L
.943 .60312 L
.96027 .60323 L
.97619 .60332 L
s
% End of Graphics
MathPictureEnd
\
\>"], "Graphics",
 ImageSize->{288, 177.938},
 ImageMargins->{{43, 0}, {0, 0}},
 ImageRegion->{{0, 1}, {0, 1}},
 ImageCache->GraphicsData["CompressedBitmap", "\<\
eJzlmUtTFDEUhRtmeIsgvlBUBhBEsATR0nLBwrJKF8oCF1oWUlSLCMObYQSB
4Q0Kyuuv+AuR3I6ZkDk3M9PEciGL7nDPl9M3me4kne7xkyNDE34yPujHXib8
6ZH44GzsxVTiJBQp8LyCmOd5v2KeKB+fFOWB/hrEwfPaxCki4h2iFBUlX5W6
lNoS4O10osix/PPug9hHEHsEYs2Bbas4FQmlM0ezTlVDZtaoki6kQFTHRblN
AdEcr9GBje4E57tGDU9ln1HDx+EHwEGaU7KFCqLSoCo9VCWJU3X5ix6Clhz8
JalEtaVGHEqDf86DCuUgVgZiZFEtQudydPnfYqjXEFdJR3mHnJZqxbFchKqA
at6W+cTkw/hanIqF0g0gefO8ESd6KJ7y0FtxIuUxD70XJ3oe0BgjoT4FdfFQ
v4I6VSm4/70BFUADnqzvK+geD6Uf5DYeGgIS+i0l/hlILTw+rFKwQHEgNfH4
KJAazV4cA1AD7zkOpBiPTwCpnscngXSLx6eAdJPHp4F0wxk+A6Q6cdR7OwGg
67znLJCuOcOTQKrl8S9Ausrjc0CKqP6IqhLF2GWAxYxZVpQCtIh3npeA7iKd
5BVOVysBMUqcQtL0K04N+aF0I3y6C4bEpVmMM7B0sel8TF188h/NZVSydOMi
kGqc4UtAuuAMTwGpWjX6MAuEPZeBhOb2cPgKkNAiLxy+CqRKZ/gakGhpqfc2
C2HPdSBVOMM3gIQWeOHwTSChJWU4fAtINOTovc1C2HMbSGhYDId/A1KxMzyl
2m7MQBljKhA0n2CIYSaffIZdm1GRSkKfXGw1KO2gyh89RCvK1CUtiad7suJ0
n2J8F0iWzH4ACc1z4fCfdMKT/pGORE1Ef2z2cO8dnV3dN1L3cpIOVIJc4NBs
QrZdhgw2e8DIjdmzyJAyumLfvIhxW+/ptfFPmS+S/f7ZdYaje38nwNkximi0
CLOYnX2gcmvODivfs1uy7c/fD02ZyAVdLZhytJ+p3NowiwW6MdDkte0MRxPv
Vni8kOvLTd4TrSwsOHLf+Fc4WsetO8PRGnRNw6m30TJ4jfdE+KozHK3zV5zh
6B1l2RmO3q9SGk69jV7xUrwnwpec4egddpHH0Qv1QigczUjpEhrgLoJYsCvi
YEZya04+l4DlvNWyzNr+yyA256r9FnNjUmLzuwJiwQYfvDfQPl+Sx9Eu4qwz
HG1pJjScGl0HoBneE+HTPI72gad4HG1KT/I42vKe4PF6EBvn8RiIjfE4+hgw
quHU2+grRJz3RPgIj98GsWEeb1ZpWSD06eYTj7cqTwuEvh75PN6uPHUo/UWL
SgN8/Q4F9fNQ+nN1Hw/R92saet7x0BNxpG+IvTzUraBXAUTL8PRGhoE/F0f6
8PkswHPdJugRxyoR6spSkUIfRKlJlKryu0643Ysd1emWLXPLu7dX8Bs7qsiF
\
\>"],
 ImageRangeCache->{{{78.375, 307.75}, {562.5, 421.188}} -> {-9.34245, \
3.21813, 0.0387126, 0.0062598}}],

Cell[BoxData[
 TagBox[
  RowBox[{"\[SkeletonIndicator]", "Graphics", "\[SkeletonIndicator]"}],
  False,
  Editable->False]], "Output"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"Plot", "[", 
  RowBox[{
   RowBox[{"CDF", "[", 
    RowBox[{
     RowBox[{"dist1", "[", 
      RowBox[{"-", "3.4"}], "]"}], ",", "x"}], "]"}], ",", 
   RowBox[{"{", 
    RowBox[{"x", ",", 
     RowBox[{"-", "5"}], ",", 
     RowBox[{"+", "5"}]}], "}"}]}], "]"}]], "Input"],

Cell[GraphicsData["PostScript", "\<\
%!
%%Creator: Mathematica
%%AspectRatio: .61803 
MathPictureStart
/Mabs {
Mgmatrix idtransform
Mtmatrix dtransform
} bind def
/Mabsadd { Mabs
3 -1 roll add
3 1 roll add
exch } bind def
%% Graphics
%%IncludeResource: font Courier
%%IncludeFont: Courier
/Courier findfont 10  scalefont  setfont
% Scaling calculations
0.5 0.0952381 0.0147151 0.588604 [
[.11905 .00222 -6 -9 ]
[.11905 .00222 6 0 ]
[.30952 .00222 -6 -9 ]
[.30952 .00222 6 0 ]
[.69048 .00222 -3 -9 ]
[.69048 .00222 3 0 ]
[.88095 .00222 -3 -9 ]
[.88095 .00222 3 0 ]
[.4875 .13244 -18 -4.5 ]
[.4875 .13244 0 4.5 ]
[.4875 .25016 -18 -4.5 ]
[.4875 .25016 0 4.5 ]
[.4875 .36788 -18 -4.5 ]
[.4875 .36788 0 4.5 ]
[.4875 .4856 -18 -4.5 ]
[.4875 .4856 0 4.5 ]
[.4875 .60332 -6 -4.5 ]
[.4875 .60332 0 4.5 ]
[ 0 0 0 0 ]
[ 1 .61803 0 0 ]
] MathScale
% Start of Graphics
1 setlinecap
1 setlinejoin
newpath
0 g
.25 Mabswid
[ ] 0 setdash
.11905 .01472 m
.11905 .02097 L
s
[(-4)] .11905 .00222 0 1 Mshowa
.30952 .01472 m
.30952 .02097 L
s
[(-2)] .30952 .00222 0 1 Mshowa
.69048 .01472 m
.69048 .02097 L
s
[(2)] .69048 .00222 0 1 Mshowa
.88095 .01472 m
.88095 .02097 L
s
[(4)] .88095 .00222 0 1 Mshowa
.125 Mabswid
.16667 .01472 m
.16667 .01847 L
s
.21429 .01472 m
.21429 .01847 L
s
.2619 .01472 m
.2619 .01847 L
s
.35714 .01472 m
.35714 .01847 L
s
.40476 .01472 m
.40476 .01847 L
s
.45238 .01472 m
.45238 .01847 L
s
.54762 .01472 m
.54762 .01847 L
s
.59524 .01472 m
.59524 .01847 L
s
.64286 .01472 m
.64286 .01847 L
s
.7381 .01472 m
.7381 .01847 L
s
.78571 .01472 m
.78571 .01847 L
s
.83333 .01472 m
.83333 .01847 L
s
.07143 .01472 m
.07143 .01847 L
s
.02381 .01472 m
.02381 .01847 L
s
.92857 .01472 m
.92857 .01847 L
s
.97619 .01472 m
.97619 .01847 L
s
.25 Mabswid
0 .01472 m
1 .01472 L
s
.5 .13244 m
.50625 .13244 L
s
[(0.2)] .4875 .13244 1 0 Mshowa
.5 .25016 m
.50625 .25016 L
s
[(0.4)] .4875 .25016 1 0 Mshowa
.5 .36788 m
.50625 .36788 L
s
[(0.6)] .4875 .36788 1 0 Mshowa
.5 .4856 m
.50625 .4856 L
s
[(0.8)] .4875 .4856 1 0 Mshowa
.5 .60332 m
.50625 .60332 L
s
[(1)] .4875 .60332 1 0 Mshowa
.125 Mabswid
.5 .04415 m
.50375 .04415 L
s
.5 .07358 m
.50375 .07358 L
s
.5 .10301 m
.50375 .10301 L
s
.5 .16187 m
.50375 .16187 L
s
.5 .1913 m
.50375 .1913 L
s
.5 .22073 m
.50375 .22073 L
s
.5 .27959 m
.50375 .27959 L
s
.5 .30902 m
.50375 .30902 L
s
.5 .33845 m
.50375 .33845 L
s
.5 .39731 m
.50375 .39731 L
s
.5 .42674 m
.50375 .42674 L
s
.5 .45617 m
.50375 .45617 L
s
.5 .51503 m
.50375 .51503 L
s
.5 .54446 m
.50375 .54446 L
s
.5 .57389 m
.50375 .57389 L
s
.25 Mabswid
.5 0 m
.5 .61803 L
s
0 0 m
1 0 L
1 .61803 L
0 .61803 L
closepath
clip
newpath
.5 Mabswid
.02381 .01472 m
.06244 .01472 L
.10458 .01472 L
.14415 .01472 L
.18221 .01472 L
.22272 .01472 L
.26171 .01472 L
.30316 .01472 L
.34309 .01472 L
.3815 .01472 L
.42237 .01472 L
.46172 .01472 L
.48147 .01472 L
.49012 .01472 L
.49468 .01472 L
.49719 .01472 L
.49842 .01472 L
.49955 .01472 L
.50085 .03407 L
.50154 .04916 L
.50226 .06466 L
.50471 .11414 L
.5095 .19802 L
.51896 .32377 L
.52411 .37494 L
.52891 .41421 L
.53415 .44934 L
.53984 .48019 L
.54527 .50383 L
.55029 .52164 L
.555 .53542 L
.56019 .54795 L
.56919 .56443 L
.57412 .57128 L
.57875 .5766 L
.58858 .58516 L
.59352 .58836 L
.59893 .59122 L
.60357 .59324 L
.60852 .59502 L
.61744 .59747 L
.62276 .59858 L
.62768 .59941 L
.63296 .60014 L
.63878 .60079 L
.64857 .6016 L
.65392 .60192 L
.65893 .60217 L
.66391 .60238 L
.66934 .60256 L
Mistroke
.67413 .60269 L
.67922 .6028 L
.68427 .6029 L
.68884 .60296 L
.69776 .60307 L
.70265 .60311 L
.70781 .60315 L
.71704 .6032 L
.72219 .60322 L
.72698 .60324 L
.7322 .60325 L
.73788 .60327 L
.74332 .60328 L
.74835 .60328 L
.75307 .60329 L
.75827 .6033 L
.76728 .6033 L
.77221 .60331 L
.77684 .60331 L
.78669 .60331 L
.79165 .60331 L
.79706 .60331 L
.8017 .60331 L
.80666 .60332 L
.81558 .60332 L
.82092 .60332 L
.82584 .60332 L
.83114 .60332 L
.83696 .60332 L
.84676 .60332 L
.85212 .60332 L
.85713 .60332 L
.86212 .60332 L
.86756 .60332 L
.87236 .60332 L
.87745 .60332 L
.88203 .60332 L
.88708 .60332 L
.896 .60332 L
.90091 .60332 L
.90608 .60332 L
.91533 .60332 L
.92048 .60332 L
.92528 .60332 L
.9305 .60332 L
.93617 .60332 L
.94164 .60332 L
.94668 .60332 L
.9514 .60332 L
.95661 .60332 L
Mistroke
.96563 .60332 L
.97056 .60332 L
.97519 .60332 L
.97619 .60332 L
Mfstroke
% End of Graphics
MathPictureEnd
\
\>"], "Graphics",
 ImageSize->{288, 177.938},
 ImageMargins->{{43, 0}, {0, 0}},
 ImageRegion->{{0, 1}, {0, 1}},
 ImageCache->GraphicsData["CompressedBitmap", "\<\
eJztmdlu1DAUhj2TpJ22lEIRIHGBBsRaJFqWZ4ArnoCrMEJqkRBVGZBoy76W
ZfosPGHpOTYnied34sySTmDmwjn5/fn3EttZ5kHcXX/8NO5udOL2/a14c32j
87x979nWoRQ0lGq0lVK/24rig8PQJPy7QIlSK3QISF+lKKQolui25F7R+A0+
sHJgfuom0B4B7S7QLmvba3SIKGfN02xNSpiWXZRGN1kI0zjFKwKEnnWsYqOr
+njdKqGk9X0lYizfAg7GnBvbFIijjkR3JDI4FzdXdB/0pDemrFnpyzIlLX1y
HBSYA9r8VKtEQ2O/yKmZP9kse1oOq5kFWuW8LMritbNfaQ1TwS3sihBKFFAU
ZjWD7/ChbzttgUsSeZZFS4TrZamXWxYtucDSVKFLC8v2vSpllIzavESRG7dn
7Niz0kNXeeX9I/lrRLk8zvoC/8XUz0pqPqrcsfY4yuQaIms/LIK2F14ogWw0
+QaOJbvAx+zCbw7sxhtAJC0KwKD/KDZw7SCDtMjeFJWfWzLcCxJ5FKtsOvgi
3PCmNQZ09v1IGozmWVbbm1Q8uaHXpcV1xlMLLgt9c3uii/MP4M4Hy0DuAf5m
wz24aahf+zqweeCqxsPS2f/yfs5HZ39n60nW2bEcCzQxaoVz92cA9MXtiS7g
FPfBKxht5P75/8R5tGfLeSL8U01w9CXio8bRHcl6K/E3G/6ONFrzIAHKWM5N
ZP99Pq/QGbr/fdAWaG5MFI4+Xb1P4clbXA5kZSH8XU3wY0B7WxnOo43+PHnj
9lwshyP31yPDl4C268ZPAG1nZPhJoG2ncB7t5QLIykL4Kzd+SurJgU4D7aUb
PwO0F278LKUsdTXEz5zJZyYLP0cp75ybGt8DECp4ntIZkp4UFGTpEkUPKVoq
V09vIJzf4Jw7ePFfOqrxB8Hb2lc=\
\>"],
 ImageRangeCache->{{{78.375, 307.75}, {226.813, 85.5}} -> {-9.33654, \
0.591452, 0.0386882, 0.00625988}}],

Cell[BoxData[
 TagBox[
  RowBox[{"\[SkeletonIndicator]", "Graphics", "\[SkeletonIndicator]"}],
  False,
  Editable->False]], "Output"]
}, Open  ]],

Cell[BoxData[
 RowBox[{
  RowBox[{"CDF", "[", 
   RowBox[{
    RowBox[{"Frechet", "[", 
     RowBox[{"alpha_", ",", "beta_"}], "]"}], ",", "x_"}], "]"}], ":=", 
  RowBox[{"Exp", "[", 
   RowBox[{
    RowBox[{"-", "alpha"}], " ", "/", 
    RowBox[{"x", "^", "beta"}]}], "]"}]}]], "Input",
 InitializationCell->True],

Cell[BoxData[
 RowBox[{
  RowBox[{"PDF", "[", 
   RowBox[{
    RowBox[{"Frechet", "[", 
     RowBox[{"alpha_", ",", "beta_"}], "]"}], ",", "x_"}], "]"}], ":=", 
  RowBox[{"alpha", " ", "beta", " ", 
   SuperscriptBox["\[ExponentialE]", 
    RowBox[{
     RowBox[{"-", "alpha"}], " ", 
     SuperscriptBox["x", 
      RowBox[{"-", "beta"}]]}]], " ", 
   SuperscriptBox["x", 
    RowBox[{
     RowBox[{"-", "1"}], "-", "beta"}]]}]}]], "Input",
 InitializationCell->True],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"Unprotect", "[", 
  RowBox[{"Quantile", ",", "Random"}], "]"}]], "Input",
 InitializationCell->True],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{"\<\"Quantile\"\>", ",", "\<\"Random\"\>"}], "}"}]], "Output"]
}, Open  ]],

Cell[BoxData[
 RowBox[{
  RowBox[{"Quantile", "[", 
   RowBox[{
    RowBox[{"Frechet", "[", 
     RowBox[{"alpha_", ",", "beta_"}], "]"}], ",", "y_"}], "]"}], ":=", 
  SuperscriptBox[
   RowBox[{"(", 
    RowBox[{"-", 
     FractionBox["alpha", 
      RowBox[{"Log", "[", "y", "]"}]]}], ")"}], 
   FractionBox["1", "beta"]]}]], "Input",
 InitializationCell->True],

Cell[BoxData[
 RowBox[{
  RowBox[{"Random", "[", 
   RowBox[{"Frechet", "[", 
    RowBox[{"alpha_", ",", "beta_"}], "]"}], "]"}], ":=", 
  RowBox[{"Quantile", "[", 
   RowBox[{
    RowBox[{"Frechet", "[", 
     RowBox[{"alpha", ",", "beta"}], "]"}], ",", 
    RowBox[{"Random", "[", 
     RowBox[{"UniformDistribution", "[", 
      RowBox[{"0", ",", "1"}], "]"}], "]"}]}], "]"}]}]], "Input",
 InitializationCell->True],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"Protect", "[", 
  RowBox[{"Quantile", ",", "Random"}], "]"}]], "Input",
 InitializationCell->True],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{"\<\"Quantile\"\>", ",", "\<\"Random\"\>"}], "}"}]], "Output"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"PDF", "[", 
  RowBox[{
   RowBox[{"ExtremeValueDistribution", "[", 
    RowBox[{"alpha", ",", "lambda"}], "]"}], ",", "x"}], "]"}]], "Input"],

Cell[BoxData[
 FractionBox[
  SuperscriptBox["\[ExponentialE]", 
   RowBox[{
    RowBox[{"-", 
     SuperscriptBox["\[ExponentialE]", 
      FractionBox[
       RowBox[{"alpha", "-", "x"}], "lambda"]]}], "+", 
    FractionBox[
     RowBox[{"alpha", "-", "x"}], "lambda"]}]], "lambda"]], "Output"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"PDF", "[", 
  RowBox[{
   RowBox[{"ParetoDistribution", "[", 
    RowBox[{"alpha", ",", "lambda"}], "]"}], ",", "x"}], "]"}]], "Input"],

Cell[BoxData[
 RowBox[{
  SuperscriptBox["alpha", "lambda"], " ", "lambda", " ", 
  SuperscriptBox["x", 
   RowBox[{
    RowBox[{"-", "1"}], "-", "lambda"}]]}]], "Output"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"PDF", "[", 
  RowBox[{
   RowBox[{"Frechet", "[", 
    RowBox[{"alpha", ",", "lambda"}], "]"}], ",", "x"}], "]"}]], "Input"],

Cell[BoxData[
 RowBox[{"alpha", " ", 
  SuperscriptBox["\[ExponentialE]", 
   RowBox[{
    RowBox[{"-", "alpha"}], " ", 
    SuperscriptBox["x", 
     RowBox[{"-", "lambda"}]]}]], " ", "lambda", " ", 
  SuperscriptBox["x", 
   RowBox[{
    RowBox[{"-", "1"}], "-", "lambda"}]]}]], "Output"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"Random", "[", 
  RowBox[{"UniformDistribution", "[", 
   RowBox[{
    RowBox[{
     RowBox[{"-", "Pi"}], "/", "2"}], ",", 
    RowBox[{"Pi", "/", "2"}]}], "]"}], "]"}]], "Input"],

Cell[BoxData["0.19542471787142057`"], "Output"]
}, Open  ]],

Cell[BoxData[
 RowBox[{"Off", "[", 
  RowBox[{"General", "::", "\"\<spell1\>\""}], "]"}]], "Input",
 InitializationCell->True],

Cell[BoxData[
 StyleBox[
  RowBox[{"(*", " ", 
   RowBox[{
   "je", " ", "ne", " ", "suis", " ", "pas", " ", "sur", " ", "que", " ", 
    "ca", " ", 
    RowBox[{"serve", " ", ":", " ", 
     RowBox[{"dimension", " ", "[", "...", "]"}]}]}], "*)"}],
  FontSize->18,
  FontColor->RGBColor[0.0234379, 0.00781262, 0.375006]]], "Input"],

Cell[BoxData[
 RowBox[{
  RowBox[{"Dimension", "[", 
   RowBox[{"FromDistributionTree", "[", 
    RowBox[{
    "DimensionList_", ",", "initialvalue_", ",", "OneStepDistributionList_"}],
     "]"}], "]"}], ":=", 
  RowBox[{"Dimension", "[", 
   RowBox[{"OneStepDistributionList", "[", 
    RowBox[{"[", "1", "]"}], "]"}], "]"}]}]], "Input",
 InitializationCell->True],

Cell[BoxData[
 RowBox[{
  RowBox[{"Dimension", "[", 
   RowBox[{"OrthogonalCombineSpaces", "[", "SpecList_", "]"}], "]"}], ":=", 
  RowBox[{"Apply", "[", 
   RowBox[{"Sum", ",", 
    RowBox[{"Map", "[", 
     RowBox[{"Dimension", ",", "SpecList"}], "]"}]}], "]"}]}]], "Input",
 InitializationCell->True],

Cell[BoxData[
 RowBox[{
  RowBox[{"Dimension", "[", 
   RowBox[{"NormalRankCombineSpaces", "[", 
    RowBox[{"SpecList_", ",", "CorrelationMatrix_"}], "]"}], "]"}], ":=", 
  RowBox[{"Module", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{"dim1", "=", 
      RowBox[{"Apply", "[", 
       RowBox[{"Plus", ",", 
        RowBox[{"Map", "[", 
         RowBox[{"Dimension", ",", "SpecList"}], "]"}]}], "]"}]}], "}"}], ",",
     "\[IndentingNewLine]", 
    RowBox[{"If", "[", 
     RowBox[{
      RowBox[{
       RowBox[{"(", 
        RowBox[{"dim1", "\[Equal]", 
         RowBox[{"Length", "[", "CorrelationMatrix", "]"}]}], ")"}], "&&", 
       RowBox[{"(", 
        RowBox[{"dim1", "\[Equal]", 
         RowBox[{"Length", "[", 
          RowBox[{"CorrelationMatrix", "[", 
           RowBox[{"[", "1", "]"}], "]"}], "]"}]}], ")"}]}], ",", "dim1", ",", 
      RowBox[{
       RowBox[{
       "Print", "[", 
        "\"\<Dimension[NormalRankCombineSpaces[SpecList,CorrelationMatrix]] : \
problem in the dimensions\>\"", "]"}], ";", "0"}]}], "]"}]}], 
   "]"}]}]], "Input",
 InitializationCell->True],

Cell[BoxData[
 RowBox[{
  RowBox[{"Dimension", "[", 
   RowBox[{"{", 
    RowBox[{"a_", ",", "b_", ",", "c_"}], "}"}], "]"}], ":=", 
  RowBox[{"Dimension", "[", "a", "]"}]}]], "Input",
 InitializationCell->True],

Cell[BoxData[
 StyleBox[
  RowBox[{"(*", " ", 
   RowBox[{"Definition", " ", "of", " ", 
    RowBox[{"TimeSteps", "[", "...", "]"}], " ", "for", " ", "the", " ", 
    "operators"}], " ", "*)"}],
  FontSize->18,
  FontColor->RGBColor[0.0117189, 0.0117189, 0.335943]]], "Input"],

Cell[BoxData[
 RowBox[{
  RowBox[{"TimeStepList", "[", 
   RowBox[{"FromDistributionTree", "[", 
    RowBox[{"DimensionList_", ",", "initialvalue_", ",", "dlist_"}], "]"}], 
   "]"}], ":=", 
  RowBox[{"Map", "[", 
   RowBox[{
    RowBox[{
     RowBox[{"#", "[", 
      RowBox[{"[", "2", "]"}], "]"}], "&"}], ",", "dlist"}], "]"}]}]], "Input",
 InitializationCell->True],

Cell[BoxData[
 RowBox[{
  RowBox[{"TimeStepList", "[", 
   RowBox[{"OrthogonalCombineSpaces", "[", "TreeList_", "]"}], "]"}], ":=", 
  RowBox[{"Module", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{"consistenceQ", ",", "i", ",", "tsl1", ",", 
      RowBox[{"tsl", "=", 
       RowBox[{"Map", "[", 
        RowBox[{"TimeStepList", ",", "TreeList"}], "]"}]}]}], "}"}], ",", 
    "\[IndentingNewLine]", "\t", 
    RowBox[{"If", "[", 
     RowBox[{
      RowBox[{
       RowBox[{"Length", "[", "TreeList", "]"}], "\[Equal]", "1"}], ",", 
      RowBox[{"tsl", "[", 
       RowBox[{"[", "1", "]"}], "]"}], ",", "\[IndentingNewLine]", "\t", 
      RowBox[{
       RowBox[{"tsl1", "=", 
        RowBox[{"tsl", "[", 
         RowBox[{"[", "1", "]"}], "]"}]}], ";", "\[IndentingNewLine]", "\t", 
       RowBox[{"consistenceQ", "=", 
        RowBox[{"Apply", "[", 
         RowBox[{"And", ",", 
          RowBox[{"Map", "[", 
           RowBox[{
            RowBox[{
             RowBox[{"(", 
              RowBox[{"tsl1", "\[Equal]", "#"}], ")"}], "&"}], ",", 
            RowBox[{"Table", "[", 
             RowBox[{
              RowBox[{"tsl", "[", 
               RowBox[{"[", "i", "]"}], "]"}], ",", 
              RowBox[{"{", 
               RowBox[{"i", ",", "2", ",", 
                RowBox[{"Length", "[", "tsl", "]"}]}], "}"}]}], "]"}]}], 
           "]"}]}], "]"}]}], ";", "\[IndentingNewLine]", "\t", 
       RowBox[{"If", "[", 
        RowBox[{
         RowBox[{"consistenceQ", "\[Equal]", "True"}], ",", " ", "tsl1", ",", 
         "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{
          "Print", "[", 
           "\"\<TimeStepList[OrthogonalCombineSpaces[...]] : different list \
of stimesteps !\>\"", "]"}], ";", "0"}]}], "]"}]}]}], "]"}]}], 
   "]"}]}]], "Input",
 InitializationCell->True],

Cell[BoxData[
 RowBox[{
  RowBox[{"TimeStepList", "[", 
   RowBox[{"NormalRankCombineSpaces", "[", 
    RowBox[{"TreeList_", ",", "CorrelationMatrix_"}], "]"}], "]"}], ":=", 
  RowBox[{"Module", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{"consistenceQ", ",", "i", ",", "tsl1", ",", 
      RowBox[{"tsl", "=", 
       RowBox[{"Map", "[", 
        RowBox[{"TimeStepList", ",", "TreeList"}], "]"}]}]}], "}"}], ",", 
    "\[IndentingNewLine]", "\t", 
    RowBox[{"If", "[", 
     RowBox[{
      RowBox[{
       RowBox[{"Length", "[", "TreeList", "]"}], "\[Equal]", "1"}], ",", 
      RowBox[{"tsl", "[", 
       RowBox[{"[", "1", "]"}], "]"}], ",", "\[IndentingNewLine]", "\t", 
      RowBox[{
       RowBox[{"tsl1", "=", 
        RowBox[{"tsl", "[", 
         RowBox[{"[", "1", "]"}], "]"}]}], ";", "\[IndentingNewLine]", "\t", 
       RowBox[{"consistenceQ", "=", 
        RowBox[{"Apply", "[", 
         RowBox[{"And", ",", 
          RowBox[{"Map", "[", 
           RowBox[{
            RowBox[{
             RowBox[{"(", 
              RowBox[{"tsl1", "\[Equal]", "#"}], ")"}], "&"}], ",", 
            RowBox[{"Table", "[", 
             RowBox[{
              RowBox[{"tsl", "[", 
               RowBox[{"[", "i", "]"}], "]"}], ",", 
              RowBox[{"{", 
               RowBox[{"i", ",", "2", ",", 
                RowBox[{"Length", "[", "tsl", "]"}]}], "}"}]}], "]"}]}], 
           "]"}]}], "]"}]}], ";", "\[IndentingNewLine]", "\t", 
       RowBox[{"If", "[", 
        RowBox[{
         RowBox[{"consistenceQ", "\[Equal]", "True"}], ",", " ", "tsl1", ",", 
         "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{
          "Print", "[", 
           "\"\<TimeStepList[OrthogonalCombineSpaces[...]] : different list \
of stimesteps !\>\"", "]"}], ";", "0"}]}], "]"}]}]}], "]"}]}], 
   "]"}]}]], "Input",
 InitializationCell->True],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"TimeStepList", "[", 
  RowBox[{"FromDistributionTree", "[", 
   RowBox[{
    RowBox[{"{", "\"\<equity\>\"", "}"}], ",", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{
        RowBox[{"StudentTDistributionD", "[", "1.1", "]"}], ",", "1", ",", 
        "3"}], "}"}], ",", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"StudentTDistributionD", "[", "1.1", "]"}], ",", "1", ",", 
        "2"}], "}"}]}], "}"}]}], "]"}], "]"}]], "Input"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{"1", ",", "1"}], "}"}]], "Output"]
}, Open  ]],

Cell[BoxData[
 StyleBox[
  RowBox[{"(*", " ", 
   RowBox[{
   "Tensorial", " ", "product", " ", "up", " ", "to", " ", "dimension", " ", 
    "3"}], " ", "*)"}],
  FontSize->18,
  FontColor->RGBColor[0, 0.0351568, 0.421881]]], "Input"],

Cell[BoxData[
 RowBox[{
  RowBox[{"MultiDimensionalTimeSliceTensorialProduct", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{"x1_", ",", "x2_"}], "}"}], ",", "reducedNodeNumberVector_"}], 
   "]"}], ":=", 
  RowBox[{"Module", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{"i1", ",", "i2"}], "}"}], ",", "\[IndentingNewLine]", 
    RowBox[{"Flatten", "[", 
     RowBox[{
      RowBox[{"Table", "[", 
       RowBox[{
        RowBox[{"MultiDimensionalNodeListTensorialProduct", "[", 
         RowBox[{
          RowBox[{"{", 
           RowBox[{
            RowBox[{"x1", "[", 
             RowBox[{"[", "i1", "]"}], "]"}], ",", 
            RowBox[{"x2", "[", 
             RowBox[{"[", "i2", "]"}], "]"}]}], "}"}], ",", 
          "reducedNodeNumberVector"}], "]"}], ",", " ", 
        RowBox[{"{", 
         RowBox[{"i1", ",", "1", ",", 
          RowBox[{"Length", "[", "x1", "]"}]}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{"i2", ",", "1", ",", 
          RowBox[{"Length", "[", "x2", "]"}]}], "}"}]}], "]"}], ",", "1"}], 
     "]"}]}], "]"}]}]], "Input",
 InitializationCell->True],

Cell[BoxData[
 RowBox[{
  RowBox[{"MultiDimensionalTimeSliceTensorialProduct", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{"x1_", ",", "x2_", ",", "x3_"}], "}"}], ",", 
    "reducedNodeNumberVector_"}], "]"}], ":=", 
  RowBox[{"Module", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{"i1", ",", "i2"}], "}"}], ",", "\[IndentingNewLine]", 
    RowBox[{"Flatten", "[", 
     RowBox[{
      RowBox[{"Table", "[", 
       RowBox[{
        RowBox[{"MultiDimensionalNodeListTensorialProduct", "[", 
         RowBox[{
          RowBox[{"{", 
           RowBox[{
            RowBox[{"x1", "[", 
             RowBox[{"[", "i1", "]"}], "]"}], ",", 
            RowBox[{"x2", "[", 
             RowBox[{"[", "i2", "]"}], "]"}], ",", 
            RowBox[{"x3", "[", 
             RowBox[{"[", "i3", "]"}], "]"}]}], "}"}], ",", 
          "reducedNodeNumberVector"}], "]"}], ",", " ", 
        RowBox[{"{", 
         RowBox[{"i1", ",", "1", ",", 
          RowBox[{"Length", "[", "x1", "]"}]}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{"i2", ",", "1", ",", 
          RowBox[{"Length", "[", "x2", "]"}]}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{"i3", ",", "1", ",", 
          RowBox[{"Length", "[", "x3", "]"}]}], "}"}]}], "]"}], ",", "2"}], 
     "]"}]}], "]"}]}]], "Input",
 InitializationCell->True],

Cell[BoxData[
 RowBox[{
  RowBox[{"MultiDimensionalTimeSliceTensorialProduct", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{"x1_", ",", "x2_"}], "}"}], ",", "Mcorrelation_", ",", 
    "Speclist_", ",", "reducedNodeNumberVector_", ",", 
    RowBox[{"{", 
     RowBox[{"antex1_", ",", "antex2_"}], "}"}]}], "]"}], ":=", 
  RowBox[{"Module", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{"i1", ",", "i2"}], "}"}], ",", "\[IndentingNewLine]", 
    RowBox[{"Flatten", "[", 
     RowBox[{
      RowBox[{"Table", "[", 
       RowBox[{
        RowBox[{"MultiDimensionalNodeListTensorialProduct", "[", 
         RowBox[{
          RowBox[{"{", 
           RowBox[{
            RowBox[{"x1", "[", 
             RowBox[{"[", "i1", "]"}], "]"}], ",", 
            RowBox[{"x2", "[", 
             RowBox[{"[", "i2", "]"}], "]"}]}], "}"}], ",", "Mcorrelation", 
          ",", "Speclist", ",", "reducedNodeNumberVector", ",", 
          RowBox[{"Join", "[", 
           RowBox[{
            RowBox[{"NodeValue", "[", 
             RowBox[{"antex1", ",", 
              RowBox[{"x1", "[", 
               RowBox[{"[", 
                RowBox[{"i1", ",", "1", ",", "4"}], "]"}], "]"}]}], "]"}], 
            ",", 
            RowBox[{"NodeValue", "[", 
             RowBox[{"antex2", ",", 
              RowBox[{"x2", "[", 
               RowBox[{"[", 
                RowBox[{"i2", ",", "1", ",", "4"}], "]"}], "]"}]}], "]"}]}], 
           "]"}]}], "]"}], ",", " ", 
        RowBox[{"{", 
         RowBox[{"i1", ",", "1", ",", 
          RowBox[{"Length", "[", "x1", "]"}]}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{"i2", ",", "1", ",", 
          RowBox[{"Length", "[", "x2", "]"}]}], "}"}]}], "]"}], ",", "1"}], 
     "]"}]}], "]"}]}]], "Input",
 InitializationCell->True],

Cell[BoxData[
 RowBox[{
  RowBox[{"MultiDimensionalTimeSliceTensorialProduct", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{"x1_", ",", "x2_", ",", "x3_"}], "}"}], ",", "Mcorrelation_", 
    ",", "Speclist_", ",", "reducedNodeNumberVector_", ",", 
    RowBox[{"{", 
     RowBox[{"antex1_", ",", "antex2_", ",", "antex3_"}], "}"}]}], "]"}], ":=", 
  RowBox[{"Module", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{"i1", ",", "i2", ",", "i3"}], "}"}], ",", "\[IndentingNewLine]", 
    RowBox[{"Flatten", "[", 
     RowBox[{
      RowBox[{"Table", "[", 
       RowBox[{
        RowBox[{"MultiDimensionalNodeListTensorialProduct", "[", 
         RowBox[{
          RowBox[{"{", 
           RowBox[{
            RowBox[{"x1", "[", 
             RowBox[{"[", "i1", "]"}], "]"}], ",", 
            RowBox[{"x2", "[", 
             RowBox[{"[", "i2", "]"}], "]"}], ",", 
            RowBox[{"x3", "[", 
             RowBox[{"[", "i3", "]"}], "]"}]}], "}"}], ",", "Mcorrelation", 
          ",", "Speclist", ",", "reducedNodeNumberVector", ",", 
          RowBox[{"Join", "[", 
           RowBox[{
            RowBox[{"NodeValue", "[", 
             RowBox[{"antex1", ",", 
              RowBox[{"x1", "[", 
               RowBox[{"[", 
                RowBox[{"i1", ",", "1", ",", "4"}], "]"}], "]"}]}], "]"}], 
            ",", 
            RowBox[{"NodeValue", "[", 
             RowBox[{"antex2", ",", 
              RowBox[{"x2", "[", 
               RowBox[{"[", 
                RowBox[{"i2", ",", "1", ",", "4"}], "]"}], "]"}]}], "]"}], 
            ",", 
            RowBox[{"NodeValue", "[", 
             RowBox[{"antex3", ",", 
              RowBox[{"x3", "[", 
               RowBox[{"[", 
                RowBox[{"i3", ",", "1", ",", "4"}], "]"}], "]"}]}], "]"}]}], 
           "]"}]}], "]"}], ",", " ", 
        RowBox[{"{", 
         RowBox[{"i1", ",", "1", ",", 
          RowBox[{"Length", "[", "x1", "]"}]}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{"i2", ",", "1", ",", 
          RowBox[{"Length", "[", "x2", "]"}]}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{"i3", ",", "1", ",", 
          RowBox[{"Length", "[", "x3", "]"}]}], "}"}]}], "]"}], ",", "2"}], 
     "]"}]}], "]"}]}]], "Input",
 InitializationCell->True],

Cell[BoxData[
 RowBox[{
  RowBox[{"MultiDimensionalNodeListTensorialProduct", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{"a_", ",", "b_"}], "}"}], ",", "reducedNodeNumberVector_"}], 
   "]"}], ":=", 
  RowBox[{"Module", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{"i", ",", "j"}], "}"}], ",", "\[IndentingNewLine]", 
    RowBox[{"Flatten", "[", 
     RowBox[{
      RowBox[{"Table", "[", 
       RowBox[{
        RowBox[{"{", "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{"NodeName", "[", 
           RowBox[{"reducedNodeNumberVector", ",", 
            RowBox[{"{", 
             RowBox[{
              RowBox[{"a", "[", 
               RowBox[{"[", 
                RowBox[{"i", ",", "1"}], "]"}], "]"}], ",", 
              RowBox[{"b", "[", 
               RowBox[{"[", 
                RowBox[{"j", ",", "1"}], "]"}], "]"}]}], "}"}]}], "]"}], ",", 
          "\[IndentingNewLine]", 
          RowBox[{"a", "[", 
           RowBox[{"[", 
            RowBox[{"i", ",", "2"}], "]"}], "]"}], ",", "\[IndentingNewLine]", 
          RowBox[{"Join", "[", 
           RowBox[{
            RowBox[{"a", "[", 
             RowBox[{"[", 
              RowBox[{"i", ",", "3"}], "]"}], "]"}], ",", 
            RowBox[{"b", "[", 
             RowBox[{"[", 
              RowBox[{"j", ",", "3"}], "]"}], "]"}]}], "]"}], ",", 
          "\[IndentingNewLine]", 
          RowBox[{"NodeName", "[", 
           RowBox[{"reducedNodeNumberVector", ",", 
            RowBox[{"{", 
             RowBox[{
              RowBox[{"a", "[", 
               RowBox[{"[", 
                RowBox[{"i", ",", "4"}], "]"}], "]"}], ",", 
              RowBox[{"b", "[", 
               RowBox[{"[", 
                RowBox[{"j", ",", "4"}], "]"}], "]"}]}], "}"}]}], "]"}]}], 
         "}"}], ",", " ", 
        RowBox[{"{", 
         RowBox[{"i", ",", "1", ",", 
          RowBox[{"Length", "[", "a", "]"}]}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{"j", ",", "1", ",", 
          RowBox[{"Length", "[", "b", "]"}]}], "}"}]}], "]"}], ",", "1"}], 
     "]"}]}], "]"}]}]], "Input",
 InitializationCell->True],

Cell[BoxData[
 RowBox[{
  RowBox[{"MultiDimensionalNodeListTensorialProduct", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{"x1_", ",", "x2_", ",", "x3_"}], "}"}], ",", 
    "reducedNodeNumberVector_"}], "]"}], ":=", 
  RowBox[{"Module", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{"i1", ",", "i2", ",", "i3"}], "}"}], ",", "\[IndentingNewLine]", 
    RowBox[{"Flatten", "[", 
     RowBox[{
      RowBox[{"Table", "[", 
       RowBox[{
        RowBox[{"{", "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{"NodeName", "[", 
           RowBox[{"reducedNodeNumberVector", ",", 
            RowBox[{"{", 
             RowBox[{
              RowBox[{"x1", "[", 
               RowBox[{"[", 
                RowBox[{"i1", ",", "1"}], "]"}], "]"}], ",", 
              RowBox[{"x2", "[", 
               RowBox[{"[", 
                RowBox[{"i2", ",", "1"}], "]"}], "]"}], ",", 
              RowBox[{"x3", "[", 
               RowBox[{"[", 
                RowBox[{"i3", ",", "1"}], "]"}], "]"}]}], "}"}]}], "]"}], ",",
           "\[IndentingNewLine]", 
          RowBox[{"x1", "[", 
           RowBox[{"[", 
            RowBox[{"i1", ",", "2"}], "]"}], "]"}], ",", 
          "\[IndentingNewLine]", 
          RowBox[{"Join", "[", 
           RowBox[{
            RowBox[{"x1", "[", 
             RowBox[{"[", 
              RowBox[{"i1", ",", "3"}], "]"}], "]"}], ",", 
            RowBox[{"x2", "[", 
             RowBox[{"[", 
              RowBox[{"i2", ",", "3"}], "]"}], "]"}], ",", 
            RowBox[{"x3", "[", 
             RowBox[{"[", 
              RowBox[{"i3", ",", "3"}], "]"}], "]"}]}], "]"}], ",", 
          "\[IndentingNewLine]", 
          RowBox[{"NodeName", "[", 
           RowBox[{"reducedNodeNumberVector", ",", 
            RowBox[{"{", 
             RowBox[{
              RowBox[{"x1", "[", 
               RowBox[{"[", 
                RowBox[{"i1", ",", "4"}], "]"}], "]"}], ",", 
              RowBox[{"x2", "[", 
               RowBox[{"[", 
                RowBox[{"i2", ",", "4"}], "]"}], "]"}], ",", 
              RowBox[{"x3", "[", 
               RowBox[{"[", 
                RowBox[{"i3", ",", "4"}], "]"}], "]"}]}], "}"}]}], "]"}]}], 
         "\[IndentingNewLine]", "}"}], ",", " ", 
        RowBox[{"{", 
         RowBox[{"i1", ",", "1", ",", 
          RowBox[{"Length", "[", "x1", "]"}]}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{"i2", ",", "1", ",", 
          RowBox[{"Length", "[", "x2", "]"}]}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{"i3", ",", "1", ",", 
          RowBox[{"Length", "[", "x3", "]"}]}], "}"}]}], "]"}], ",", "2"}], 
     "]"}]}], "]"}]}]], "Input",
 InitializationCell->True],

Cell[BoxData[
 RowBox[{
  RowBox[{"MultiDimensionalNodeListTensorialProduct", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{"a_", ",", "b_"}], "}"}], ",", "Mcorrelation_", ",", "Speclist_",
     ",", "reducedNodeNumberVector_", ",", 
    RowBox[{"{", 
     RowBox[{"aPrecedingValue_", ",", "bPrecedingValue_"}], "}"}]}], "]"}], ":=", 
  RowBox[{"Module", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{"i", ",", "j"}], "}"}], ",", "\[IndentingNewLine]", 
    RowBox[{"Flatten", "[", 
     RowBox[{
      RowBox[{"Table", "[", 
       RowBox[{
        RowBox[{"{", "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{"NodeName", "[", 
           RowBox[{"reducedNodeNumberVector", ",", 
            RowBox[{"{", 
             RowBox[{
              RowBox[{"a", "[", 
               RowBox[{"[", 
                RowBox[{"i", ",", "1"}], "]"}], "]"}], ",", 
              RowBox[{"b", "[", 
               RowBox[{"[", 
                RowBox[{"j", ",", "1"}], "]"}], "]"}]}], "}"}]}], "]"}], ",", 
          "\[IndentingNewLine]", 
          RowBox[{"a", "[", 
           RowBox[{"[", 
            RowBox[{"i", ",", "2"}], "]"}], "]"}], ",", "\[IndentingNewLine]", 
          RowBox[{"Module", "[", 
           RowBox[{
            RowBox[{"{", 
             RowBox[{"Y", ",", 
              RowBox[{"ashift", "=", 
               RowBox[{
                RowBox[{"a", "[", 
                 RowBox[{"[", 
                  RowBox[{"i", ",", "3", ",", "1"}], "]"}], "]"}], "-", 
                "aPrecedingValue"}]}], ",", 
              RowBox[{"bshift", "=", 
               RowBox[{
                RowBox[{"b", "[", 
                 RowBox[{"[", 
                  RowBox[{"j", ",", "3", ",", "1"}], "]"}], "]"}], "-", 
                "bPrecedingValue"}]}]}], "}"}], ",", 
            RowBox[{
             RowBox[{"Y", "=", 
              RowBox[{"Mcorrelation", ".", 
               RowBox[{"{", 
                RowBox[{
                 RowBox[{
                  RowBox[{"ToGaussian", "[", 
                   RowBox[{
                    RowBox[{"Speclist", "[", 
                    RowBox[{"[", 
                    RowBox[{"1", ",", "1"}], "]"}], "]"}], ",", "ashift"}], 
                   "]"}], "[", "aPrecedingValue", "]"}], ",", 
                 RowBox[{
                  RowBox[{"ToGaussian", "[", 
                   RowBox[{
                    RowBox[{"Speclist", "[", 
                    RowBox[{"[", 
                    RowBox[{"2", ",", "1"}], "]"}], "]"}], ",", "bshift"}], 
                   "]"}], "[", "bPrecedingValue", "]"}]}], "}"}]}]}], ";", 
             "\[IndentingNewLine]", 
             RowBox[{"{", 
              RowBox[{
               RowBox[{
                RowBox[{
                 RowBox[{"FromGaussian", "[", 
                  RowBox[{
                   RowBox[{"Speclist", "[", 
                    RowBox[{"[", 
                    RowBox[{"1", ",", "1"}], "]"}], "]"}], ",", 
                   RowBox[{"Y", "[", 
                    RowBox[{"[", "1", "]"}], "]"}]}], "]"}], "[", 
                 "aPrecedingValue", "]"}], "+", "aPrecedingValue"}], ",", 
               RowBox[{
                RowBox[{
                 RowBox[{"FromGaussian", "[", 
                  RowBox[{
                   RowBox[{"Speclist", "[", 
                    RowBox[{"[", 
                    RowBox[{"2", ",", "1"}], "]"}], "]"}], ",", 
                   RowBox[{"Y", "[", 
                    RowBox[{"[", "2", "]"}], "]"}]}], "]"}], "[", 
                 "bPrecedingValue", "]"}], "+", "bPrecedingValue"}]}], 
              "}"}]}]}], "]"}], ",", "\[IndentingNewLine]", 
          RowBox[{"NodeName", "[", 
           RowBox[{"reducedNodeNumberVector", ",", 
            RowBox[{"{", 
             RowBox[{
              RowBox[{"a", "[", 
               RowBox[{"[", 
                RowBox[{"i", ",", "4"}], "]"}], "]"}], ",", 
              RowBox[{"b", "[", 
               RowBox[{"[", 
                RowBox[{"j", ",", "4"}], "]"}], "]"}]}], "}"}]}], "]"}]}], 
         "\[IndentingNewLine]", "}"}], ",", " ", 
        RowBox[{"{", 
         RowBox[{"i", ",", "1", ",", 
          RowBox[{"Length", "[", "a", "]"}]}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{"j", ",", "1", ",", 
          RowBox[{"Length", "[", "b", "]"}]}], "}"}]}], "]"}], ",", "1"}], 
     "]"}]}], "]"}]}]], "Input",
 InitializationCell->True],

Cell[BoxData[
 RowBox[{
  RowBox[{"MultiDimensionalNodeListTensorialProduct", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{"x1_", ",", "x2_", ",", "x3_"}], "}"}], ",", "Mcorrelation_", 
    ",", "Speclist_", ",", "reducedNodeNumberVector_", ",", 
    RowBox[{"{", 
     RowBox[{
     "x1PrecedingValue_", ",", "x2PrecedingValue_", ",", 
      "x3PrecedingValue_"}], "}"}]}], "]"}], ":=", 
  RowBox[{"Module", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{"i1", ",", "i2", ",", "i3"}], "}"}], ",", "\[IndentingNewLine]", 
    RowBox[{"Flatten", "[", 
     RowBox[{
      RowBox[{"Table", "[", 
       RowBox[{
        RowBox[{"{", "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{"NodeName", "[", 
           RowBox[{"reducedNodeNumberVector", ",", 
            RowBox[{"{", 
             RowBox[{
              RowBox[{"x1", "[", 
               RowBox[{"[", 
                RowBox[{"i1", ",", "1"}], "]"}], "]"}], ",", 
              RowBox[{"x2", "[", 
               RowBox[{"[", 
                RowBox[{"i2", ",", "1"}], "]"}], "]"}], ",", 
              RowBox[{"x3", "[", 
               RowBox[{"[", 
                RowBox[{"i3", ",", "1"}], "]"}], "]"}]}], "}"}]}], "]"}], ",",
           "\[IndentingNewLine]", 
          RowBox[{"x1", "[", 
           RowBox[{"[", 
            RowBox[{"i1", ",", "2"}], "]"}], "]"}], ",", 
          "\[IndentingNewLine]", 
          RowBox[{"Module", "[", 
           RowBox[{
            RowBox[{"{", 
             RowBox[{"Y", "=", 
              RowBox[{"Mcorrelation", ".", 
               RowBox[{"{", 
                RowBox[{
                 RowBox[{
                  RowBox[{"ToGaussian", "[", 
                   RowBox[{
                    RowBox[{"Speclist", "[", 
                    RowBox[{"[", 
                    RowBox[{"1", ",", "1"}], "]"}], "]"}], ",", 
                    RowBox[{
                    RowBox[{"x1", "[", 
                    RowBox[{"[", 
                    RowBox[{"i1", ",", "3", ",", "1"}], "]"}], "]"}], "-", 
                    "x1PrecedingValue"}]}], "]"}], "[", "x1PrecedingValue", 
                  "]"}], ",", 
                 RowBox[{
                  RowBox[{"ToGaussian", "[", 
                   RowBox[{
                    RowBox[{"Speclist", "[", 
                    RowBox[{"[", 
                    RowBox[{"2", ",", "1"}], "]"}], "]"}], ",", 
                    RowBox[{
                    RowBox[{"x2", "[", 
                    RowBox[{"[", 
                    RowBox[{"i2", ",", "3", ",", "1"}], "]"}], "]"}], "-", 
                    "x2PrecedingValue"}]}], "]"}], "[", "x2PrecedingValue", 
                  "]"}], ",", 
                 RowBox[{
                  RowBox[{"ToGaussian", "[", 
                   RowBox[{
                    RowBox[{"Speclist", "[", 
                    RowBox[{"[", 
                    RowBox[{"3", ",", "1"}], "]"}], "]"}], ",", 
                    RowBox[{
                    RowBox[{"x3", "[", 
                    RowBox[{"[", 
                    RowBox[{"i3", ",", "3", ",", "1"}], "]"}], "]"}], "-", 
                    "x3PrecedingValue"}]}], "]"}], "[", "x3PrecedingValue", 
                  "]"}]}], "}"}]}]}], "}"}], ",", 
            RowBox[{"{", 
             RowBox[{
              RowBox[{
               RowBox[{
                RowBox[{"FromGaussian", "[", 
                 RowBox[{
                  RowBox[{"Speclist", "[", 
                   RowBox[{"[", 
                    RowBox[{"1", ",", "1"}], "]"}], "]"}], ",", 
                  RowBox[{"Y", "[", 
                   RowBox[{"[", "1", "]"}], "]"}]}], "]"}], "[", 
                "x1PrecedingValue", "]"}], "+", "x1PrecedingValue"}], ",", 
              RowBox[{
               RowBox[{
                RowBox[{"FromGaussian", "[", 
                 RowBox[{
                  RowBox[{"Speclist", "[", 
                   RowBox[{"[", 
                    RowBox[{"2", ",", "1"}], "]"}], "]"}], ",", 
                  RowBox[{"Y", "[", 
                   RowBox[{"[", "2", "]"}], "]"}]}], "]"}], "[", 
                "x2PrecedingValue", "]"}], "+", "x2PrecedingValue"}], ",", 
              RowBox[{
               RowBox[{
                RowBox[{"FromGaussian", "[", 
                 RowBox[{
                  RowBox[{"Speclist", "[", 
                   RowBox[{"[", 
                    RowBox[{"3", ",", "1"}], "]"}], "]"}], ",", 
                  RowBox[{"Y", "[", 
                   RowBox[{"[", "3", "]"}], "]"}]}], "]"}], "[", 
                "x3PrecedingValue", "]"}], "+", "x3PrecedingValue"}]}], 
             "}"}]}], "]"}], ",", "\[IndentingNewLine]", 
          RowBox[{"NodeName", "[", 
           RowBox[{"reducedNodeNumberVector", ",", 
            RowBox[{"{", 
             RowBox[{
              RowBox[{"x1", "[", 
               RowBox[{"[", 
                RowBox[{"i1", ",", "4"}], "]"}], "]"}], ",", 
              RowBox[{"x2", "[", 
               RowBox[{"[", 
                RowBox[{"i2", ",", "4"}], "]"}], "]"}], ",", 
              RowBox[{"x2", "[", 
               RowBox[{"[", 
                RowBox[{"i2", ",", "4"}], "]"}], "]"}]}], "}"}]}], "]"}]}], 
         "\[IndentingNewLine]", "}"}], ",", " ", 
        RowBox[{"{", 
         RowBox[{"i1", ",", "1", ",", 
          RowBox[{"Length", "[", "x1", "]"}]}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{"i2", ",", "1", ",", 
          RowBox[{"Length", "[", "x2", "]"}]}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{"i3", ",", "1", ",", 
          RowBox[{"Length", "[", "x3", "]"}]}], "}"}]}], "]"}], ",", "2"}], 
     "]"}]}], "]"}]}]], "Input",
 InitializationCell->True],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"NodeName", "[", 
    RowBox[{"LengthList_", ",", "IndexList_"}], "]"}], ":=", 
   RowBox[{"If", "[", 
    RowBox[{
     RowBox[{
      RowBox[{"Length", "[", "LengthList", "]"}], "\[Equal]", "0"}], ",", 
     RowBox[{"IndexList", "[", 
      RowBox[{"[", "1", "]"}], "]"}], ",", 
     RowBox[{
      RowBox[{"IndexList", "[", 
       RowBox[{"[", "1", "]"}], "]"}], "+", 
      RowBox[{
       RowBox[{"LengthList", "[", 
        RowBox[{"[", "1", "]"}], "]"}], " ", 
       RowBox[{"NodeName", "[", 
        RowBox[{
         RowBox[{"Rest", "[", "LengthList", "]"}], ",", 
         RowBox[{"Rest", "[", "IndexList", "]"}]}], "]"}]}]}]}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"(*", " ", 
   RowBox[{
    RowBox[{
     RowBox[{"LengthList", " ", "should", " ", "have", " ", "n"}], "-", 
     RowBox[{"1", " ", "elements"}]}], " ", ",", " ", 
    RowBox[{"when", " ", "IndexList", " ", "has", " ", "n", " ", "elements"}],
     " ", ",", " ", 
    RowBox[{
     RowBox[{
     "the", " ", "value", " ", "of", " ", "Indexlist", " ", "should", " ", 
      "between", " ", "0", " ", "and", " ", "N"}], "-", "1"}], ",", " ", 
    RowBox[{
    "N", " ", "being", " ", "the", " ", "corresponding", " ", "elements", " ",
      "of", " ", "LengthList"}]}], "*)"}]}]}], "Input",
 InitializationCell->True],

Cell[BoxData[
 RowBox[{
  RowBox[{"InverseNodeName", "[", 
   RowBox[{"LengthList_", ",", "nb_"}], "]"}], ":=", 
  RowBox[{"If", "[", 
   RowBox[{
    RowBox[{
     RowBox[{"Length", "[", "LengthList", "]"}], "\[Equal]", "0"}], ",", 
    RowBox[{"{", "nb", "}"}], ",", 
    RowBox[{"Prepend", "[", 
     RowBox[{
      RowBox[{"InverseNodeName", "[", 
       RowBox[{
        RowBox[{"Rest", "[", "LengthList", "]"}], ",", 
        RowBox[{"Quotient", "[", 
         RowBox[{"nb", ",", 
          RowBox[{"LengthList", "[", 
           RowBox[{"[", "1", "]"}], "]"}]}], "]"}]}], "]"}], ",", 
      RowBox[{"Mod", "[", 
       RowBox[{"nb", ",", 
        RowBox[{"LengthList", "[", 
         RowBox[{"[", "1", "]"}], "]"}]}], "]"}]}], "]"}]}], "]"}]}]], "Input",
 InitializationCell->True],

Cell[BoxData[
 RowBox[{
  RowBox[{"NodeValue", "[", 
   RowBox[{"timeslice_", ",", "nodename_"}], "]"}], ":=", 
  RowBox[{
   RowBox[{"Select", "[", 
    RowBox[{
     RowBox[{"Flatten", "[", 
      RowBox[{"timeslice", ",", "1"}], "]"}], ",", 
     RowBox[{
      RowBox[{"(", 
       RowBox[{
        RowBox[{"#", "[", 
         RowBox[{"[", "1", "]"}], "]"}], "\[Equal]", "nodename"}], ")"}], 
      "&"}]}], "]"}], "[", 
   RowBox[{"[", 
    RowBox[{"1", ",", "3"}], "]"}], "]"}]}]], "Input",
 InitializationCell->True],

Cell[BoxData[
 StyleBox[
  RowBox[{"(*", " ", 
   RowBox[{"LogNormal", " ", "Distribution"}], " ", "*)"}],
  FontSize->18,
  FontColor->RGBColor[1, 0, 1]]], "Input"],

Cell[BoxData[
 RowBox[{
  RowBox[{"ConditionalDistribution", "[", 
   RowBox[{"LogNormalDistributionD", "[", 
    RowBox[{"mean_", ",", "sigma_"}], "]"}], "]"}], ":=", 
  RowBox[{"Function", "[", 
   RowBox[{
    RowBox[{"{", "x", "}"}], ",", 
    RowBox[{"LogNormalDistribution", "[", 
     RowBox[{"mean", ",", "sigma"}], "]"}]}], "]"}]}]], "Input",
 InitializationCell->True],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"Dimension", "[", 
    RowBox[{"LogNormalDistributionD", "[", 
     RowBox[{"mean_", ",", "sigma_"}], "]"}], "]"}], "=", "1"}], 
  ";"}]], "Input",
 InitializationCell->True],

Cell[BoxData[
 RowBox[{
  RowBox[{"ToGaussian", "[", 
   RowBox[{
    RowBox[{"LogNormalDistributionD", "[", 
     RowBox[{"mean_", ",", "sigma_"}], "]"}], ",", "x_"}], "]"}], ":=", 
  RowBox[{"Function", "[", 
   RowBox[{
    RowBox[{"{", "z", "}"}], ",", 
    RowBox[{"N", "[", 
     RowBox[{"Quantile", "[", 
      RowBox[{
       RowBox[{"NormalDistribution", "[", 
        RowBox[{"0", ",", "1"}], "]"}], ",", 
       RowBox[{"CDF", "[", 
        RowBox[{
         RowBox[{"LogNormalDistribution", "[", 
          RowBox[{"mean", ",", "sigma"}], "]"}], ",", "x"}], "]"}]}], "]"}], 
     "]"}]}], "]"}]}]], "Input",
 InitializationCell->True],

Cell[BoxData[
 RowBox[{
  RowBox[{"FromGaussian", "[", 
   RowBox[{
    RowBox[{"LogNormalDistributionD", "[", 
     RowBox[{"mean_", ",", "sigma_"}], "]"}], ",", "x_"}], "]"}], ":=", 
  RowBox[{"Function", "[", 
   RowBox[{
    RowBox[{"{", "z", "}"}], ",", 
    RowBox[{"N", "[", 
     RowBox[{"Quantile", "[", 
      RowBox[{
       RowBox[{"LogNormalDistribution", "[", 
        RowBox[{"mean", ",", "sigma"}], "]"}], ",", 
       RowBox[{"CDF", "[", 
        RowBox[{
         RowBox[{"NormalDistribution", "[", 
          RowBox[{"0", ",", "1"}], "]"}], ",", "x"}], "]"}]}], "]"}], "]"}]}],
    "]"}]}]], "Input",
 InitializationCell->True],

Cell[BoxData[
 StyleBox[
  RowBox[{"(*", " ", 
   RowBox[{"Gamma", " ", "Distribution"}], " ", "*)"}],
  FontSize->18,
  FontColor->RGBColor[1, 0, 1]]], "Input"],

Cell[BoxData[
 RowBox[{
  RowBox[{"ConditionalDistribution", "[", 
   RowBox[{"GammaDistributionD", "[", 
    RowBox[{"alpha_", ",", "lambda_"}], "]"}], "]"}], ":=", 
  RowBox[{"Function", "[", 
   RowBox[{
    RowBox[{"{", "x", "}"}], ",", 
    RowBox[{"GammaDistribution", "[", 
     RowBox[{"alpha", ",", "lambda"}], "]"}]}], "]"}]}]], "Input",
 InitializationCell->True],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"Dimension", "[", 
    RowBox[{"GammaDistributionD", "[", 
     RowBox[{"alpha_", ",", "lambda_"}], "]"}], "]"}], "=", "1"}], 
  ";"}]], "Input",
 InitializationCell->True],

Cell[BoxData[
 RowBox[{
  RowBox[{"ToGaussian", "[", 
   RowBox[{
    RowBox[{"GammaDistributionD", "[", 
     RowBox[{"alpha_", ",", "lambda_"}], "]"}], ",", "x_"}], "]"}], ":=", 
  RowBox[{"Function", "[", 
   RowBox[{
    RowBox[{"{", "z", "}"}], ",", 
    RowBox[{"N", "[", 
     RowBox[{"Quantile", "[", 
      RowBox[{
       RowBox[{"NormalDistribution", "[", 
        RowBox[{"0", ",", "1"}], "]"}], ",", 
       RowBox[{"CDF", "[", 
        RowBox[{
         RowBox[{"GammaDistribution", "[", 
          RowBox[{"alpha", ",", "lambda"}], "]"}], ",", "x"}], "]"}]}], "]"}],
      "]"}]}], "]"}]}]], "Input",
 InitializationCell->True],

Cell[BoxData[
 RowBox[{
  RowBox[{"FromGaussian", "[", 
   RowBox[{
    RowBox[{"GammaDistributionD", "[", 
     RowBox[{"alpha_", ",", "lambda_"}], "]"}], ",", "x_"}], "]"}], ":=", 
  RowBox[{"Function", "[", 
   RowBox[{
    RowBox[{"{", "z", "}"}], ",", 
    RowBox[{"N", "[", 
     RowBox[{"Quantile", "[", 
      RowBox[{
       RowBox[{"GammaDistribution", "[", 
        RowBox[{"alpha", ",", "lambda"}], "]"}], ",", 
       RowBox[{"CDF", "[", 
        RowBox[{
         RowBox[{"NormalDistribution", "[", 
          RowBox[{"0", ",", "1"}], "]"}], ",", "x"}], "]"}]}], "]"}], "]"}]}],
    "]"}]}]], "Input",
 InitializationCell->True],

Cell[BoxData[
 StyleBox[
  RowBox[{"(*", " ", 
   RowBox[{"Chi2", " ", "Distribution"}], " ", "*)"}],
  FontSize->18,
  FontColor->RGBColor[1, 0, 1]]], "Input"],

Cell[BoxData[
 RowBox[{
  RowBox[{"ConditionalDistribution", "[", 
   RowBox[{"ChiSquareDistributionD", "[", "m_", "]"}], "]"}], ":=", 
  RowBox[{"Function", "[", 
   RowBox[{
    RowBox[{"{", "x", "}"}], ",", 
    RowBox[{"ChiSquareDistribution", "[", "m", "]"}]}], "]"}]}]], "Input",
 InitializationCell->True],

Cell[BoxData[
 RowBox[{
  RowBox[{"ToGaussian", "[", 
   RowBox[{
    RowBox[{"ChiSquareDistributionD", "[", "m_", "]"}], ",", "x_"}], "]"}], ":=", 
  RowBox[{"Function", "[", 
   RowBox[{
    RowBox[{"{", "z", "}"}], ",", 
    RowBox[{"N", "[", 
     RowBox[{"Quantile", "[", 
      RowBox[{
       RowBox[{"NormalDistribution", "[", 
        RowBox[{"0", ",", "1"}], "]"}], ",", 
       RowBox[{"CDF", "[", 
        RowBox[{
         RowBox[{"ChiSquareDistribution", "[", "m", "]"}], ",", "x"}], 
        "]"}]}], "]"}], "]"}]}], "]"}]}]], "Input",
 InitializationCell->True],

Cell[BoxData[
 RowBox[{
  RowBox[{"FromGaussian", "[", 
   RowBox[{
    RowBox[{"ChiSquareDistributionD", "[", "m_", "]"}], ",", "x_"}], "]"}], ":=", 
  RowBox[{"Function", "[", 
   RowBox[{
    RowBox[{"{", "z", "}"}], ",", 
    RowBox[{"N", "[", 
     RowBox[{"Quantile", "[", 
      RowBox[{
       RowBox[{"ChiSquareDistribution", "[", "m", "]"}], ",", 
       RowBox[{"CDF", "[", 
        RowBox[{
         RowBox[{"NormalDistribution", "[", 
          RowBox[{"0", ",", "1"}], "]"}], ",", "x"}], "]"}]}], "]"}], "]"}]}],
    "]"}]}]], "Input",
 InitializationCell->True],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"Dimension", "[", 
    RowBox[{"ChiSquareDistributionD", "[", "m_", "]"}], "]"}], "=", "1"}], 
  ";"}]], "Input",
 InitializationCell->True],

Cell[BoxData[
 RowBox[{
  RowBox[{"ConditionalDistribution", "[", 
   RowBox[{"ExponentialDistributionD", "[", "mean_", "]"}], "]"}], ":=", 
  RowBox[{"Function", "[", 
   RowBox[{
    RowBox[{"{", "x", "}"}], ",", 
    RowBox[{"ExponentialDistribution", "[", "mean", "]"}]}], "]"}]}]], "Input",
 InitializationCell->True],

Cell[BoxData[
 StyleBox[
  RowBox[{"(*", " ", 
   RowBox[{"Exponential", " ", "Distribution"}], " ", "*)"}],
  FontSize->18,
  FontColor->RGBColor[1, 0, 1]]], "Input"],

Cell[BoxData[
 RowBox[{
  RowBox[{"ToGaussian", "[", 
   RowBox[{
    RowBox[{"ExponentialDistributionD", "[", "mean_", "]"}], ",", "x_"}], 
   "]"}], ":=", 
  RowBox[{"Function", "[", 
   RowBox[{
    RowBox[{"{", "z", "}"}], ",", 
    RowBox[{"N", "[", 
     RowBox[{"Quantile", "[", 
      RowBox[{
       RowBox[{"NormalDistribution", "[", 
        RowBox[{"0", ",", "1"}], "]"}], ",", 
       RowBox[{"CDF", "[", 
        RowBox[{
         RowBox[{"ExponentialDistribution", "[", "mean", "]"}], ",", "x"}], 
        "]"}]}], "]"}], "]"}]}], "]"}]}]], "Input",
 InitializationCell->True],

Cell[BoxData[
 RowBox[{
  RowBox[{"FromGaussian", "[", 
   RowBox[{
    RowBox[{"ExponentialDistributionD", "[", "mean_", "]"}], ",", "x_"}], 
   "]"}], ":=", 
  RowBox[{"Function", "[", 
   RowBox[{
    RowBox[{"{", "z", "}"}], ",", 
    RowBox[{"N", "[", 
     RowBox[{"Quantile", "[", 
      RowBox[{
       RowBox[{"ExponentialDistribution", "[", "mean", "]"}], ",", 
       RowBox[{"CDF", "[", 
        RowBox[{
         RowBox[{"NormalDistribution", "[", 
          RowBox[{"0", ",", "1"}], "]"}], ",", "x"}], "]"}]}], "]"}], "]"}]}],
    "]"}]}]], "Input",
 InitializationCell->True],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"Dimension", "[", 
    RowBox[{"ExponentialDistributionD", "[", "mean_", "]"}], "]"}], "=", 
   "1"}], ";"}]], "Input",
 InitializationCell->True],

Cell[BoxData[
 StyleBox[
  RowBox[{"(*", " ", 
   RowBox[{"Student", " ", "Distribution"}], " ", "*)"}],
  FontSize->18,
  FontColor->RGBColor[1, 0, 1]]], "Input"],

Cell[BoxData[
 RowBox[{
  RowBox[{"ConditionalDistribution", "[", 
   RowBox[{"StudentTDistributionD", "[", "m_", "]"}], "]"}], ":=", 
  RowBox[{"Function", "[", 
   RowBox[{
    RowBox[{"{", "x", "}"}], ",", 
    RowBox[{"StudentTDistribution", "[", "m", "]"}]}], "]"}]}]], "Input",
 InitializationCell->True],

Cell[BoxData[
 RowBox[{
  RowBox[{"ToGaussian", "[", 
   RowBox[{
    RowBox[{"StudentTDistributionD", "[", "m_", "]"}], ",", "x_"}], "]"}], ":=", 
  RowBox[{"Function", "[", 
   RowBox[{
    RowBox[{"{", "z", "}"}], ",", 
    RowBox[{"N", "[", 
     RowBox[{"Quantile", "[", 
      RowBox[{
       RowBox[{"NormalDistribution", "[", 
        RowBox[{"0", ",", "1"}], "]"}], ",", 
       RowBox[{"CDF", "[", 
        RowBox[{
         RowBox[{"StudentTDistribution", "[", "m", "]"}], ",", "x"}], "]"}]}],
       "]"}], "]"}]}], "]"}]}]], "Input",
 InitializationCell->True],

Cell[BoxData[
 RowBox[{
  RowBox[{"FromGaussian", "[", 
   RowBox[{
    RowBox[{"StudentTDistributionD", "[", "m_", "]"}], ",", "x_"}], "]"}], ":=", 
  RowBox[{"Function", "[", 
   RowBox[{
    RowBox[{"{", "z", "}"}], ",", 
    RowBox[{"N", "[", 
     RowBox[{"Quantile", "[", 
      RowBox[{
       RowBox[{"StudentTDistribution", "[", "m", "]"}], ",", 
       RowBox[{"CDF", "[", 
        RowBox[{
         RowBox[{"NormalDistribution", "[", 
          RowBox[{"0", ",", "1"}], "]"}], ",", "x"}], "]"}]}], "]"}], "]"}]}],
    "]"}]}]], "Input",
 InitializationCell->True],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"Dimension", "[", 
    RowBox[{"StudentTDistributionD", "[", "m_", "]"}], "]"}], "=", "1"}], 
  ";"}]], "Input",
 InitializationCell->True],

Cell[BoxData[
 StyleBox[
  RowBox[{"(*", " ", 
   RowBox[{"ExtremValues", " ", "Distribution"}], " ", "*)"}],
  FontSize->18,
  FontColor->RGBColor[1, 0, 1]]], "Input"],

Cell[BoxData[
 RowBox[{
  RowBox[{"ConditionalDistribution", "[", 
   RowBox[{"ExtremeValueDistributionD", "[", 
    RowBox[{"alpha_", ",", "lambda_"}], "]"}], "]"}], ":=", 
  RowBox[{"Function", "[", 
   RowBox[{
    RowBox[{"{", "x", "}"}], ",", 
    RowBox[{"ExtremeValueDistribution", "[", 
     RowBox[{"alpha", ",", "lambda"}], "]"}]}], "]"}]}]], "Input",
 InitializationCell->True],

Cell[BoxData[
 RowBox[{
  RowBox[{"ToGaussian", "[", 
   RowBox[{
    RowBox[{"ExtremeValueDistributionD", "[", 
     RowBox[{"alpha_", ",", "lambda_"}], "]"}], ",", "x_"}], "]"}], ":=", 
  RowBox[{"Function", "[", 
   RowBox[{
    RowBox[{"{", "z", "}"}], ",", 
    RowBox[{"N", "[", 
     RowBox[{"Quantile", "[", 
      RowBox[{
       RowBox[{"NormalDistribution", "[", 
        RowBox[{"0", ",", "1"}], "]"}], ",", 
       RowBox[{"CDF", "[", 
        RowBox[{
         RowBox[{"ExtremeValueDistribution", "[", 
          RowBox[{"alpha", ",", "lambda"}], "]"}], ",", "x"}], "]"}]}], "]"}],
      "]"}]}], "]"}]}]], "Input",
 InitializationCell->True],

Cell[BoxData[
 RowBox[{
  RowBox[{"FromGaussian", "[", 
   RowBox[{
    RowBox[{"ExtremeValueDistributionD", "[", 
     RowBox[{"alpha_", ",", "lambda_"}], "]"}], ",", "x_"}], "]"}], ":=", 
  RowBox[{"Function", "[", 
   RowBox[{
    RowBox[{"{", "z", "}"}], ",", 
    RowBox[{"N", "[", 
     RowBox[{"Quantile", "[", 
      RowBox[{
       RowBox[{"ExtremeValueDistribution", "[", 
        RowBox[{"alpha", ",", "lambda"}], "]"}], ",", 
       RowBox[{"CDF", "[", 
        RowBox[{
         RowBox[{"NormalDistribution", "[", 
          RowBox[{"0", ",", "1"}], "]"}], ",", "x"}], "]"}]}], "]"}], "]"}]}],
    "]"}]}]], "Input",
 InitializationCell->True],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"Dimension", "[", 
    RowBox[{"ExtremeValueDistributionD", "[", 
     RowBox[{"alpha_", ",", "lambda_"}], "]"}], "]"}], "=", "1"}], 
  ";"}]], "Input",
 InitializationCell->True],

Cell[BoxData[
 StyleBox[
  RowBox[{"(*", " ", 
   RowBox[{"Pareto", " ", "Distribution"}], " ", "*)"}],
  FontSize->18,
  FontColor->RGBColor[1, 0, 1]]], "Input"],

Cell[BoxData[
 RowBox[{
  RowBox[{"ConditionalDistribution", "[", 
   RowBox[{"ParetoDistributionD", "[", 
    RowBox[{"alpha_", ",", "lambda_"}], "]"}], "]"}], ":=", 
  RowBox[{"Function", "[", 
   RowBox[{
    RowBox[{"{", "x", "}"}], ",", 
    RowBox[{"ParetoDistribution", "[", 
     RowBox[{"alpha", ",", "lambda"}], "]"}]}], "]"}]}]], "Input",
 InitializationCell->True],

Cell[BoxData[
 RowBox[{
  RowBox[{"ToGaussian", "[", 
   RowBox[{
    RowBox[{"ParetoDistributionD", "[", 
     RowBox[{"alpha_", ",", "lambda_"}], "]"}], ",", "x_"}], "]"}], ":=", 
  RowBox[{"Function", "[", 
   RowBox[{
    RowBox[{"{", "z", "}"}], ",", 
    RowBox[{"N", "[", 
     RowBox[{"Quantile", "[", 
      RowBox[{
       RowBox[{"NormalDistribution", "[", 
        RowBox[{"0", ",", "1"}], "]"}], ",", 
       RowBox[{"CDF", "[", 
        RowBox[{
         RowBox[{"ParetoDistribution", "[", 
          RowBox[{"alpha", ",", "lambda"}], "]"}], ",", "x"}], "]"}]}], "]"}],
      "]"}]}], "]"}]}]], "Input",
 InitializationCell->True],

Cell[BoxData[
 RowBox[{
  RowBox[{"FromGaussian", "[", 
   RowBox[{
    RowBox[{"ParetoDistributionD", "[", 
     RowBox[{"alpha_", ",", "lambda_"}], "]"}], ",", "x_"}], "]"}], ":=", 
  RowBox[{"Function", "[", 
   RowBox[{
    RowBox[{"{", "z", "}"}], ",", 
    RowBox[{"N", "[", 
     RowBox[{"Quantile", "[", 
      RowBox[{
       RowBox[{"ParetoDistribution", "[", 
        RowBox[{"alpha", ",", "lambda"}], "]"}], ",", 
       RowBox[{"CDF", "[", 
        RowBox[{
         RowBox[{"NormalDistribution", "[", 
          RowBox[{"0", ",", "1"}], "]"}], ",", "x"}], "]"}]}], "]"}], "]"}]}],
    "]"}]}]], "Input",
 InitializationCell->True],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"Dimension", "[", 
    RowBox[{"ParetoDistributionD", "[", 
     RowBox[{"alpha_", ",", "lambda_"}], "]"}], "]"}], "=", "1"}], 
  ";"}]], "Input",
 InitializationCell->True],

Cell[BoxData[
 StyleBox[
  RowBox[{"(*", " ", 
   RowBox[{"Frechet", " ", "Distribution"}], " ", "*)"}],
  FontSize->18,
  FontColor->RGBColor[1, 0, 1]]], "Input"],

Cell[BoxData[
 RowBox[{
  RowBox[{"ConditionalDistribution", "[", 
   RowBox[{"FrechetD", "[", 
    RowBox[{"alpha_", ",", "lambda_"}], "]"}], "]"}], ":=", 
  RowBox[{"Function", "[", 
   RowBox[{
    RowBox[{"{", "x", "}"}], ",", 
    RowBox[{"Frechet", "[", 
     RowBox[{"alpha", ",", "lambda"}], "]"}]}], "]"}]}]], "Input",
 InitializationCell->True],

Cell[BoxData[
 RowBox[{
  RowBox[{"ToGaussian", "[", 
   RowBox[{
    RowBox[{"FrechetD", "[", 
     RowBox[{"alpha_", ",", "lambda_"}], "]"}], ",", "x_"}], "]"}], ":=", 
  RowBox[{"Function", "[", 
   RowBox[{
    RowBox[{"{", "z", "}"}], ",", 
    RowBox[{"N", "[", 
     RowBox[{"Quantile", "[", 
      RowBox[{
       RowBox[{"NormalDistribution", "[", 
        RowBox[{"0", ",", "1"}], "]"}], ",", 
       RowBox[{"CDF", "[", 
        RowBox[{
         RowBox[{"Frechet", "[", 
          RowBox[{"alpha", ",", "lambda"}], "]"}], ",", "x"}], "]"}]}], "]"}],
      "]"}]}], "]"}]}]], "Input",
 InitializationCell->True],

Cell[BoxData[
 RowBox[{
  RowBox[{"FromGaussian", "[", 
   RowBox[{
    RowBox[{"FrechetD", "[", 
     RowBox[{"alpha_", ",", "lambda_"}], "]"}], ",", "x_"}], "]"}], ":=", 
  RowBox[{"Function", "[", 
   RowBox[{
    RowBox[{"{", "z", "}"}], ",", 
    RowBox[{"N", "[", 
     RowBox[{"Quantile", "[", 
      RowBox[{
       RowBox[{"Frechet", "[", 
        RowBox[{"alpha", ",", "lambda"}], "]"}], ",", 
       RowBox[{"CDF", "[", 
        RowBox[{
         RowBox[{"NormalDistribution", "[", 
          RowBox[{"0", ",", "1"}], "]"}], ",", "x"}], "]"}]}], "]"}], "]"}]}],
    "]"}]}]], "Input",
 InitializationCell->True],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"Dimension", "[", 
    RowBox[{"FrechetD", "[", 
     RowBox[{"alpha_", ",", "lambda_"}], "]"}], "]"}], "=", "1"}], 
  ";"}]], "Input",
 InitializationCell->True],

Cell[BoxData[
 StyleBox[
  RowBox[{"(*", " ", 
   RowBox[{"Uniform", " ", "Distribution"}], " ", "*)"}],
  FontSize->18,
  FontColor->RGBColor[1, 0, 1]]], "Input"],

Cell[BoxData[
 RowBox[{
  RowBox[{"ConditionalDistribution", "[", 
   RowBox[{"UniformDistributionD", "[", 
    RowBox[{"min_", ",", "max_"}], "]"}], "]"}], ":=", 
  RowBox[{"Function", "[", 
   RowBox[{
    RowBox[{"{", "x", "}"}], ",", 
    RowBox[{"UniformDistribution", "[", 
     RowBox[{"min", ",", "max"}], "]"}]}], "]"}]}]], "Input",
 InitializationCell->True],

Cell[BoxData[
 RowBox[{
  RowBox[{"ToGaussian", "[", 
   RowBox[{
    RowBox[{"UniformDistributionD", "[", 
     RowBox[{"min_", ",", "max_"}], "]"}], ",", "x_"}], "]"}], ":=", 
  RowBox[{"Function", "[", 
   RowBox[{
    RowBox[{"{", "z", "}"}], ",", 
    RowBox[{"N", "[", 
     RowBox[{"Quantile", "[", 
      RowBox[{
       RowBox[{"NormalDistribution", "[", 
        RowBox[{"0", ",", "1"}], "]"}], ",", 
       RowBox[{"CDF", "[", 
        RowBox[{
         RowBox[{"UniformDistribution", "[", 
          RowBox[{"min", ",", "max"}], "]"}], ",", "x"}], "]"}]}], "]"}], 
     "]"}]}], "]"}]}]], "Input",
 InitializationCell->True],

Cell[BoxData[
 RowBox[{
  RowBox[{"FromGaussian", "[", 
   RowBox[{
    RowBox[{"UniformDistributionD", "[", 
     RowBox[{"min_", ",", "max_"}], "]"}], ",", "x_"}], "]"}], ":=", 
  RowBox[{"Function", "[", 
   RowBox[{
    RowBox[{"{", "z", "}"}], ",", 
    RowBox[{"N", "[", 
     RowBox[{"Quantile", "[", 
      RowBox[{
       RowBox[{"UniformDistribution", "[", 
        RowBox[{"min", ",", "max"}], "]"}], ",", 
       RowBox[{"CDF", "[", 
        RowBox[{
         RowBox[{"NormalDistribution", "[", 
          RowBox[{"0", ",", "1"}], "]"}], ",", "x"}], "]"}]}], "]"}], "]"}]}],
    "]"}]}]], "Input",
 InitializationCell->True],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"Dimension", "[", 
    RowBox[{"UniformDistributionD", "[", 
     RowBox[{"min_", ",", "max_"}], "]"}], "]"}], "=", "1"}], ";"}]], "Input",
 InitializationCell->True],

Cell[BoxData[
 StyleBox[
  RowBox[{"(*", " ", 
   RowBox[{"Normal", " ", "Distribution"}], " ", "*)"}],
  FontSize->18,
  FontColor->RGBColor[1, 0, 1]]], "Input"],

Cell[BoxData[
 RowBox[{
  RowBox[{"ConditionalDistribution", "[", 
   RowBox[{"NormalDistributionD", "[", 
    RowBox[{"mean_", ",", "sd_"}], "]"}], "]"}], ":=", 
  RowBox[{"Function", "[", 
   RowBox[{
    RowBox[{"{", "x", "}"}], ",", 
    RowBox[{"NormalDistribution", "[", 
     RowBox[{"mean", ",", "sd"}], "]"}]}], "]"}]}]], "Input",
 InitializationCell->True],

Cell[BoxData[
 RowBox[{
  RowBox[{"ToGaussian", "[", 
   RowBox[{
    RowBox[{"NormalDistributionD", "[", 
     RowBox[{"mean_", ",", "sd_"}], "]"}], ",", "x_"}], "]"}], ":=", 
  RowBox[{"Function", "[", 
   RowBox[{
    RowBox[{"{", "z", "}"}], ",", 
    RowBox[{
     RowBox[{"(", 
      RowBox[{"x", "-", "mean"}], ")"}], "/", "sd"}]}], "]"}]}]], "Input",
 InitializationCell->True],

Cell[BoxData[
 RowBox[{
  RowBox[{"FromGaussian", "[", 
   RowBox[{
    RowBox[{"NormalDistributionD", "[", 
     RowBox[{"mean_", ",", "sd_"}], "]"}], ",", "x_"}], "]"}], ":=", 
  RowBox[{"Function", "[", 
   RowBox[{
    RowBox[{"{", "z", "}"}], ",", 
    RowBox[{"mean", "+", 
     RowBox[{"sd", " ", "x"}]}]}], "]"}]}]], "Input",
 InitializationCell->True],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"Dimension", "[", 
    RowBox[{"NormalDistributionD", "[", 
     RowBox[{"mean_", ",", "sd_"}], "]"}], "]"}], "=", "1"}], ";"}]], "Input",
 InitializationCell->True],

Cell[BoxData[
 StyleBox[
  RowBox[{"(*", " ", 
   RowBox[{
    RowBox[{"Multi", "Normal"}], " ", "Distribution"}], " ", "*)"}],
  FontSize->18,
  FontColor->RGBColor[1, 0, 1]]], "Input"],

Cell[BoxData[
 RowBox[{
  RowBox[{"ConditionalDistribution", "[", 
   RowBox[{"MultinormalDistributionD", "[", 
    RowBox[{"mean_", ",", "Covmatrix_", ",", "nbpc_"}], "]"}], "]"}], ":=", 
  RowBox[{"Function", "[", 
   RowBox[{
    RowBox[{"{", "x", "}"}], ",", 
    RowBox[{"MultinormalDistribution", "[", 
     RowBox[{"mean", ",", "Covmatrix", ",", "nbpc"}], "]"}]}], 
   "]"}]}]], "Input",
 InitializationCell->True],

Cell[BoxData[
 RowBox[{
  RowBox[{"Dimension", "[", 
   RowBox[{"MultinormalDistributionD", "[", 
    RowBox[{"mean_", ",", "Covmatrix_", ",", "nbpc_"}], "]"}], "]"}], ":=", 
  RowBox[{"If", "[", 
   RowBox[{
    RowBox[{
     RowBox[{"(", 
      RowBox[{
       RowBox[{"Length", "[", "mean", "]"}], "\[Equal]", 
       RowBox[{"Length", "[", "Covmatrix", "]"}]}], ")"}], "&&", 
     "\[IndentingNewLine]", 
     RowBox[{"(", 
      RowBox[{
       RowBox[{"Length", "[", "mean", "]"}], "\[Equal]", 
       RowBox[{"Length", "[", 
        RowBox[{"Covmatrix", "[", 
         RowBox[{"[", "1", "]"}], "]"}], "]"}]}], ")"}]}], ",", 
    RowBox[{"Length", "[", "mean", "]"}], ",", 
    RowBox[{
     RowBox[{
     "Print", "[", 
      "\"\<MultinormalDistributionD : dimension of the mean and the Covmatrix \
not consistent !\>\"", "]"}], ";", "0"}]}], "]"}]}]], "Input",
 InitializationCell->True],

Cell[BoxData[
 StyleBox[
  RowBox[{"(*", " ", "LinearDriftNormalDistributionD", " ", "*)"}],
  FontSize->18,
  FontColor->RGBColor[1, 0, 1]]], "Input"],

Cell[BoxData[
 RowBox[{
  RowBox[{"ConditionalDistribution", "[", 
   RowBox[{"LinearDriftNormalDistributionD", "[", 
    RowBox[{"a_", ",", "b_", ",", "sd_"}], "]"}], "]"}], ":=", 
  RowBox[{"Function", "[", 
   RowBox[{
    RowBox[{"{", "x", "}"}], ",", 
    RowBox[{"NormalDistribution", "[", 
     RowBox[{
      RowBox[{
       RowBox[{"a", " ", "x"}], " ", "+", " ", "b"}], ",", "sd"}], "]"}]}], 
   "]"}]}]], "Input",
 InitializationCell->True],

Cell[BoxData[
 RowBox[{
  RowBox[{"ToGaussian", "[", 
   RowBox[{
    RowBox[{"LinearDriftNormalDistributionD", "[", 
     RowBox[{"a_", ",", "b_", ",", "sd_"}], "]"}], ",", "x_"}], "]"}], ":=", 
  RowBox[{"Function", "[", 
   RowBox[{
    RowBox[{"{", "z", "}"}], ",", 
    RowBox[{
     RowBox[{"(", 
      RowBox[{"x", "-", 
       RowBox[{"a", " ", "z"}], "-", "b"}], ")"}], "/", "sd"}]}], 
   "]"}]}]], "Input",
 InitializationCell->True],

Cell[BoxData[
 RowBox[{
  RowBox[{"FromGaussian", "[", 
   RowBox[{
    RowBox[{"LinearDriftNormalDistributionD", "[", 
     RowBox[{"a_", ",", "b_", ",", "sd_"}], "]"}], ",", "x_"}], "]"}], ":=", 
  RowBox[{"Function", "[", 
   RowBox[{
    RowBox[{"{", "z", "}"}], ",", 
    RowBox[{
     RowBox[{"a", " ", "z"}], " ", "+", " ", "b", "+", 
     RowBox[{"sd", " ", "x"}]}]}], "]"}]}]], "Input",
 InitializationCell->True],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"Dimension", "[", 
    RowBox[{"LinearDriftNormalDistributionD", "[", 
     RowBox[{"a_", ",", "b_", ",", "sd_"}], "]"}], "]"}], "=", "1"}], 
  ";"}]], "Input",
 InitializationCell->True],

Cell[BoxData[
 StyleBox[
  RowBox[{"(*", " ", 
   RowBox[{"S", "chwartz2Factors", "DistributionD"}], " ", "*)"}],
  FontSize->18,
  FontColor->RGBColor[1, 0, 1]]], "Input"],

Cell[BoxData[
 RowBox[{
  RowBox[{"ConditionalDistribution", "[", 
   RowBox[{"Schwartz2FactorsDistributionD", "[", 
    RowBox[{
    "kappaChi_", ",", "sigmaChi_", ",", "muZeta_", ",", "sigmaZeta_", ",", 
     "rho_", ",", "deltaT_"}], "]"}], "]"}], ":=", 
  RowBox[{"Function", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{"chi", ",", "zeta"}], "}"}], ",", 
    RowBox[{"MultinormalDistribution", "[", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{
        RowBox[{
         RowBox[{
          RowBox[{"Exp", "[", 
           RowBox[{
            RowBox[{"-", "kappaChi"}], " ", "deltaT"}], "]"}], "chi"}], "-", 
         "chi"}], ",", 
        RowBox[{"muZeta", " ", "deltaT"}]}], "}"}], ",", 
      "\[IndentingNewLine]", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{
          RowBox[{
           RowBox[{"(", 
            RowBox[{"1", "-", 
             RowBox[{"Exp", "[", 
              RowBox[{
               RowBox[{"-", "2"}], " ", "kappaChi", " ", "deltaT"}], "]"}]}], 
            ")"}], 
           RowBox[{
            RowBox[{"sigmaChi", "^", "2"}], "/", 
            RowBox[{"(", 
             RowBox[{"2", "kappaChi"}], ")"}]}]}], ",", 
          RowBox[{
           RowBox[{"(", 
            RowBox[{"1", "-", 
             RowBox[{"Exp", "[", 
              RowBox[{
               RowBox[{"-", " ", "kappaChi"}], " ", "deltaT"}], "]"}]}], 
            ")"}], "sigmaChi", " ", "sigmaZeta", " ", 
           RowBox[{"rho", "/", "kappaChi"}]}]}], "}"}], ",", 
        "\[IndentingNewLine]", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{
           RowBox[{"(", 
            RowBox[{"1", "-", 
             RowBox[{"Exp", "[", 
              RowBox[{
               RowBox[{"-", " ", "kappaChi"}], " ", "deltaT"}], "]"}]}], 
            ")"}], "sigmaChi", " ", "sigmaZeta", " ", 
           RowBox[{"rho", "/", "kappaChi"}]}], ",", 
          RowBox[{
           RowBox[{"sigmaZeta", "^", "2"}], " ", "deltaT"}]}], "}"}]}], "}"}],
       ",", "2"}], "]"}]}], "]"}]}]], "Input",
 InitializationCell->True],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{"Dimension", "[", 
   RowBox[{"Schwartz2FactorsDistributionD", "[", 
    RowBox[{
    "kappaChi_", ",", "sigmaChi_", ",", "muZeta_", ",", "sigmaZeta_", ",", 
     "rho_", ",", "deltaT_"}], "]"}], "]"}], "=", "2"}]], "Input",
 InitializationCell->True],

Cell[BoxData["2"], "Output"]
}, Open  ]],

Cell[BoxData[
 StyleBox[
  RowBox[{"(*", " ", 
   RowBox[{"GLOBAL", " ", "Function"}], " ", "*)"}],
  FontSize->18,
  FontColor->RGBColor[0.0117189, 0.371099, 0.0390631]]], "Input"],

Cell[BoxData[
 RowBox[{"(*", " ", 
  RowBox[{"dlist", " ", "has", " ", "the", " ", "following", " ", 
   RowBox[{"strucutre", " ", ":", " ", 
    RowBox[{"{", 
     RowBox[{"distrib", ",", "timestep", ",", "branching"}], "}"}]}]}], " ", 
  "*)"}]], "Input"],

Cell[BoxData[
 RowBox[{
  RowBox[{"MCGeneratePath", "[", 
   RowBox[{
    RowBox[{"FromDistributionTree", "[", 
     RowBox[{"DimensionList_", ",", "x0_", ",", "dlist_"}], "]"}], ",", 
    "t0_"}], "]"}], ":=", 
  RowBox[{"Module", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{
     "dim", ",", "currentnode", ",", "nextnode", ",", "slicerank", ",", 
      "Initialnode", ",", "noderank", ",", "j", ",", "z"}], "}"}], ",", 
    "\[IndentingNewLine]", "\t", 
    RowBox[{
     RowBox[{"dim", "=", 
      RowBox[{"Length", "[", "x0", "]"}]}], ";", 
     RowBox[{"noderank", "=", "0"}], ";", "\[IndentingNewLine]", "\t", 
     RowBox[{"Initialnode", "=", 
      RowBox[{"{", 
       RowBox[{"noderank", ",", "t0", ",", "x0", ",", "0"}], "}"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"currentnode", "=", "Initialnode"}], ";", "\[IndentingNewLine]", 
     RowBox[{"Table", "[", 
      RowBox[{
       RowBox[{"If", "[", 
        RowBox[{
         RowBox[{"slicerank", "\[Equal]", "0"}], ",", "Initialnode", ",", 
         "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{"nextnode", "=", 
           RowBox[{"Module", "[", 
            RowBox[{
             RowBox[{"{", "\[IndentingNewLine]", "\t", 
              RowBox[{
               RowBox[{"dist", "=", 
                RowBox[{
                 RowBox[{"ConditionalDistribution", "[", 
                  RowBox[{
                   RowBox[{"dlist", "[", 
                    RowBox[{"[", "slicerank", "]"}], "]"}], "[", 
                   RowBox[{"[", "1", "]"}], "]"}], "]"}], "[", 
                 RowBox[{"currentnode", "[", 
                  RowBox[{"[", "3", "]"}], "]"}], "]"}]}], ",", 
               "\[IndentingNewLine]", "\t", 
               RowBox[{"branchingfactor", "=", 
                RowBox[{
                 RowBox[{"dlist", "[", 
                  RowBox[{"[", "slicerank", "]"}], "]"}], "[", 
                 RowBox[{"[", "3", "]"}], "]"}]}], ",", "\[IndentingNewLine]",
                "\t", 
               RowBox[{"timestep", "=", 
                RowBox[{
                 RowBox[{"dlist", "[", 
                  RowBox[{"[", "slicerank", "]"}], "]"}], "[", 
                 RowBox[{"[", "2", "]"}], "]"}]}], ",", "\[IndentingNewLine]",
                "         ", 
               RowBox[{"xstart", "=", 
                RowBox[{"currentnode", "[", 
                 RowBox[{"[", "3", "]"}], "]"}]}], ",", "\[IndentingNewLine]",
                "         ", 
               RowBox[{"tstart", "=", 
                RowBox[{"currentnode", "[", 
                 RowBox[{"[", "2", "]"}], "]"}]}], ",", "\[IndentingNewLine]",
                "\t", 
               RowBox[{"nodestart", "=", 
                RowBox[{"currentnode", "[", 
                 RowBox[{"[", "1", "]"}], "]"}]}], ",", "j"}], "}"}], ",", 
             "\[IndentingNewLine]", "\t", 
             RowBox[{"If", "[", 
              RowBox[{
               RowBox[{
                RowBox[{"dist", "[", 
                 RowBox[{"[", "0", "]"}], "]"}], "===", 
                "MultinormalDistribution"}], ",", "\[IndentingNewLine]", 
               "\t\t\t", 
               RowBox[{
                RowBox[{"z", "=", 
                 RowBox[{"MultiNormalPath", "[", 
                  RowBox[{
                  "noderank", ",", "tstart", ",", "timestep", ",", "xstart", 
                   ",", "branchingfactor", ",", "nodestart", ",", "dist"}], 
                  "]"}]}], ";", "\[IndentingNewLine]", "\t\t\t", 
                RowBox[{"noderank", "=", 
                 RowBox[{"z", "[", 
                  RowBox[{"[", "2", "]"}], "]"}]}], ";", 
                "\[IndentingNewLine]", "\t\t\t", 
                RowBox[{"z", "[", 
                 RowBox[{"[", "1", "]"}], "]"}]}], ",", "\[IndentingNewLine]",
                "\t", 
               RowBox[{
                RowBox[{"noderank", "=", 
                 RowBox[{"noderank", "+", "1"}]}], ";", "\[IndentingNewLine]",
                 "\t", 
                RowBox[{"If", "[", 
                 RowBox[{
                  RowBox[{"branchingfactor", "\[Equal]", "1"}], ",", 
                  "\[IndentingNewLine]", "\t\t", 
                  RowBox[{"{", 
                   RowBox[{"noderank", ",", 
                    RowBox[{"tstart", "+", "timestep"}], ",", 
                    RowBox[{"xstart", "+", 
                    RowBox[{"{", 
                    RowBox[{"Mean", "[", "dist", "]"}], "}"}]}], ",", 
                    "nodestart"}], "}"}], ",", "\[IndentingNewLine]", "\t\t", 
                  RowBox[{
                   RowBox[{"j", "=", 
                    RowBox[{"Random", "[", 
                    RowBox[{
                    "DiscreteUniformDistribution", "[", "branchingfactor", 
                    "]"}], "]"}]}], ";", "\[IndentingNewLine]", "\t\t", 
                   RowBox[{"{", 
                    RowBox[{"noderank", ",", 
                    RowBox[{"tstart", "+", "timestep"}], ",", 
                    RowBox[{"xstart", "+", 
                    RowBox[{"Quantile", "[", 
                    RowBox[{"dist", ",", 
                    RowBox[{
                    RowBox[{"(", 
                    RowBox[{"j", "-", 
                    RowBox[{"1", "/", "2"}]}], ")"}], "/", 
                    "branchingfactor"}]}], "]"}]}], ",", "nodestart"}], 
                    "}"}]}]}], "]"}]}]}], "]"}]}], "]"}]}], ";", 
          "\[IndentingNewLine]", 
          RowBox[{"currentnode", "=", "nextnode"}], ";", "nextnode"}]}], 
        "]"}], ",", "\[IndentingNewLine]", 
       RowBox[{"{", 
        RowBox[{"slicerank", ",", "0", ",", 
         RowBox[{"Length", "[", "dlist", "]"}]}], "}"}]}], "]"}]}]}], 
   "\[IndentingNewLine]", "]"}]}]], "Input",
 InitializationCell->True],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"MultiNormalPath", "[", 
    RowBox[{
    "noderank0_", ",", "tstart_", ",", "timestep_", ",", "xstart_", ",", 
     "branchingfactor_", ",", "nodestart_", ",", "dist_"}], "]"}], ":=", 
   RowBox[{"Module", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
       RowBox[{"mean", "=", 
        RowBox[{"dist", "[", 
         RowBox[{"[", "1", "]"}], "]"}]}], ",", 
       RowBox[{"covariancematrix", "=", 
        RowBox[{"dist", "[", 
         RowBox[{"[", "2", "]"}], "]"}]}], ",", 
       RowBox[{"nbpc", "=", 
        RowBox[{"dist", "[", 
         RowBox[{"[", "3", "]"}], "]"}]}], ",", "vecs", ",", "vals", ",", 
       "noderank", ",", "k", ",", "j", ",", "result"}], "}"}], ",", 
     "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{
       RowBox[{"{", 
        RowBox[{"vals", ",", "vecs"}], "}"}], "=", 
       RowBox[{"Eigensystem", "[", "covariancematrix", "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"noderank", "=", "noderank0"}], ";", "\[IndentingNewLine]", 
      RowBox[{"j", "=", 
       RowBox[{"Array", "[", 
        RowBox[{
         RowBox[{"0", "&"}], ",", "nbpc"}], "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"noderank", "=", 
       RowBox[{"noderank", "+", "1"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"result", "=", 
       RowBox[{"If", "[", 
        RowBox[{
         RowBox[{"branchingfactor", "\[Equal]", "1"}], ",", 
         "\[IndentingNewLine]", "\t", 
         RowBox[{"{", 
          RowBox[{"noderank", ",", 
           RowBox[{"tstart", "+", "timestep"}], ",", 
           RowBox[{"xstart", "+", "mean"}], ",", "nodestart"}], "}"}], ",", 
         "\[IndentingNewLine]", "\t", 
         RowBox[{"{", 
          RowBox[{"noderank", ",", 
           RowBox[{"tstart", "+", "timestep"}], ",", "\[IndentingNewLine]", 
           RowBox[{
            RowBox[{"Do", "[", 
             RowBox[{
              RowBox[{
               RowBox[{"j", "[", 
                RowBox[{"[", "k", "]"}], "]"}], "=", 
               RowBox[{"Random", "[", 
                RowBox[{
                "DiscreteUniformDistribution", "[", "branchingfactor", "]"}], 
                "]"}]}], ",", 
              RowBox[{"{", 
               RowBox[{"k", ",", "1", ",", "nbpc"}], "}"}]}], "]"}], ";", 
            "\[IndentingNewLine]", 
            RowBox[{"Print", "[", 
             RowBox[{"\"\<j=\>\"", ",", "j"}], "]"}], ";", 
            "\[IndentingNewLine]", 
            RowBox[{"xstart", "+", "mean", "+", 
             RowBox[{"Sum", "[", 
              RowBox[{
               RowBox[{
                RowBox[{"Sqrt", "[", 
                 RowBox[{"vals", "[", 
                  RowBox[{"[", "k", "]"}], "]"}], " ", "]"}], 
                RowBox[{"vecs", "[", 
                 RowBox[{"[", "k", "]"}], "]"}], 
                RowBox[{"Quantile", "[", 
                 RowBox[{
                  RowBox[{"NormalDistribution", "[", 
                   RowBox[{"0", ",", "1"}], "]"}], ",", "\[IndentingNewLine]",
                   "\t\t\t", 
                  RowBox[{
                   RowBox[{"(", 
                    RowBox[{
                    RowBox[{"j", "[", 
                    RowBox[{"[", "k", "]"}], "]"}], "-", 
                    RowBox[{"1", "/", "2"}]}], ")"}], "/", 
                   "branchingfactor"}]}], "]"}]}], ",", 
               RowBox[{"{", 
                RowBox[{"k", ",", "1", ",", "nbpc"}], "}"}]}], "]"}]}]}], ",",
            "nodestart"}], "}"}]}], "]"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"{", 
       RowBox[{"result", ",", "noderank"}], "}"}]}]}], "]"}]}], 
  "\[IndentingNewLine]"}]], "Input",
 InitializationCell->True],

Cell[BoxData[
 RowBox[{
  RowBox[{"GenerateTree", "[", 
   RowBox[{
    RowBox[{"FromDistributionTree", "[", 
     RowBox[{"DimensionList_", ",", "x0_", ",", "dlist_"}], "]"}], ",", 
    "t0_"}], "]"}], ":=", 
  RowBox[{"Module", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{
     "dim", ",", "currentnodesslice", ",", "nextnodeslice", ",", "slicerank", 
      ",", "Initialnode", ",", "noderank", ",", "j", ",", "z"}], "}"}], ",", 
    "\[IndentingNewLine]", "\t", 
    RowBox[{
     RowBox[{"dim", "=", 
      RowBox[{"Length", "[", "x0", "]"}]}], ";", 
     RowBox[{"noderank", "=", "0"}], ";", "\[IndentingNewLine]", "\t", 
     RowBox[{"Initialnode", "=", 
      RowBox[{"{", 
       RowBox[{"{", 
        RowBox[{"noderank", ",", "t0", ",", "x0", ",", "0"}], "}"}], "}"}]}], 
     ";", "\[IndentingNewLine]", 
     RowBox[{"currentnodesslice", "=", "Initialnode"}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"(*", " ", 
      RowBox[{
       RowBox[{"Print", "[", 
        RowBox[{"\"\<initialnode=\>\"", ",", "Initialnode"}], "]"}], ";"}], 
      "*)"}], "\[IndentingNewLine]", 
     RowBox[{"Table", "[", 
      RowBox[{
       RowBox[{"If", "[", 
        RowBox[{
         RowBox[{"slicerank", "\[Equal]", "0"}], ",", 
         RowBox[{"{", "Initialnode", "}"}], ",", "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{"nextnodeslice", "=", 
           RowBox[{"Map", "[", 
            RowBox[{
             RowBox[{
              RowBox[{"(", 
               RowBox[{"Module", "[", 
                RowBox[{
                 RowBox[{"{", "\[IndentingNewLine]", "\t", 
                  RowBox[{
                   RowBox[{"dist", "=", 
                    RowBox[{"Apply", "[", 
                    RowBox[{
                    RowBox[{"ConditionalDistribution", "[", 
                    RowBox[{
                    RowBox[{"dlist", "[", 
                    RowBox[{"[", "slicerank", "]"}], "]"}], "[", 
                    RowBox[{"[", "1", "]"}], "]"}], "]"}], ",", 
                    RowBox[{"#", "[", 
                    RowBox[{"[", "3", "]"}], "]"}]}], "]"}]}], ",", 
                   "\[IndentingNewLine]", "\t", 
                   RowBox[{"branchingfactor", "=", 
                    RowBox[{
                    RowBox[{"dlist", "[", 
                    RowBox[{"[", "slicerank", "]"}], "]"}], "[", 
                    RowBox[{"[", "3", "]"}], "]"}]}], ",", 
                   "\[IndentingNewLine]", "\t", 
                   RowBox[{"timestep", "=", 
                    RowBox[{
                    RowBox[{"dlist", "[", 
                    RowBox[{"[", "slicerank", "]"}], "]"}], "[", 
                    RowBox[{"[", "2", "]"}], "]"}]}], ",", 
                   "\[IndentingNewLine]", "         ", 
                   RowBox[{"xstart", "=", 
                    RowBox[{"#", "[", 
                    RowBox[{"[", "3", "]"}], "]"}]}], ",", 
                   "\[IndentingNewLine]", "         ", 
                   RowBox[{"tstart", "=", 
                    RowBox[{"#", "[", 
                    RowBox[{"[", "2", "]"}], "]"}]}], ",", 
                   "\[IndentingNewLine]", "\t", 
                   RowBox[{"nodestart", "=", 
                    RowBox[{"#", "[", 
                    RowBox[{"[", "1", "]"}], "]"}]}], ",", "j"}], "}"}], ",", 
                 "\[IndentingNewLine]", "\t", 
                 RowBox[{"If", "[", 
                  RowBox[{
                   RowBox[{
                    RowBox[{"dist", "[", 
                    RowBox[{"[", "0", "]"}], "]"}], "===", 
                    "MultinormalDistribution"}], ",", 
                   RowBox[{
                    RowBox[{"z", "=", 
                    RowBox[{"MultiNormalBranching", "[", 
                    RowBox[{
                    "noderank", ",", "tstart", ",", "timestep", ",", "xstart",
                     ",", "branchingfactor", ",", "nodestart", ",", "dist"}], 
                    "]"}]}], ";", "\[IndentingNewLine]", "\t\t", 
                    RowBox[{"noderank", "=", 
                    RowBox[{"z", "[", 
                    RowBox[{"[", "2", "]"}], "]"}]}], ";", 
                    RowBox[{"z", "[", 
                    RowBox[{"[", "1", "]"}], "]"}]}], ",", 
                   "\[IndentingNewLine]", 
                   RowBox[{"Table", "[", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"noderank", "=", 
                    RowBox[{"noderank", "+", "1"}]}], ";", 
                    RowBox[{"If", "[", 
                    RowBox[{
                    RowBox[{"branchingfactor", "\[Equal]", "1"}], ",", 
                    "\[IndentingNewLine]", "\t", 
                    RowBox[{"{", 
                    RowBox[{"noderank", ",", 
                    RowBox[{"tstart", "+", "timestep"}], ",", 
                    RowBox[{"xstart", "+", 
                    RowBox[{"{", 
                    RowBox[{"Mean", "[", "dist", "]"}], "}"}]}], ",", 
                    "nodestart"}], "}"}], ",", "\[IndentingNewLine]", "\t", 
                    RowBox[{"{", 
                    RowBox[{"noderank", ",", 
                    RowBox[{"tstart", "+", "timestep"}], ",", 
                    RowBox[{"xstart", "+", 
                    RowBox[{"{", 
                    RowBox[{"Quantile", "[", 
                    RowBox[{"dist", ",", 
                    RowBox[{
                    RowBox[{"(", 
                    RowBox[{"j", "-", 
                    RowBox[{"1", "/", "2"}]}], ")"}], "/", 
                    "branchingfactor"}]}], "]"}], "}"}]}], ",", "nodestart"}],
                     "}"}]}], "]"}]}], "\[IndentingNewLine]", ",", 
                    RowBox[{"{", 
                    RowBox[{"j", ",", "1", ",", "branchingfactor"}], "}"}]}], 
                    "]"}]}], "]"}]}], "]"}], ")"}], "&"}], ",", 
             "currentnodesslice"}], "]"}]}], ";", "\[IndentingNewLine]", 
          RowBox[{"(*", " ", 
           RowBox[{
            RowBox[{"Print", "[", 
             RowBox[{"\"\<nextnodeslice=\>\"", ",", "nextnodeslice"}], "]"}], 
            ";"}], " ", "*)"}], "\[IndentingNewLine]", 
          RowBox[{"currentnodesslice", "=", 
           RowBox[{"Apply", "[", 
            RowBox[{"Join", ",", "nextnodeslice"}], "]"}]}], ";", 
          "nextnodeslice"}]}], "]"}], ",", "\[IndentingNewLine]", 
       RowBox[{"{", 
        RowBox[{"slicerank", ",", "0", ",", 
         RowBox[{"Length", "[", "dlist", "]"}]}], "}"}]}], "]"}]}]}], 
   "\[IndentingNewLine]", "]"}]}]], "Input",
 InitializationCell->True],

Cell[BoxData[
 RowBox[{"(*", " ", 
  RowBox[{
   RowBox[{"covariancematrix", ".", 
    RowBox[{"vecs", "[", 
     RowBox[{"[", "1", "]"}], "]"}]}], "\[Equal]", 
   RowBox[{
    RowBox[{"vals", "[", 
     RowBox[{"[", "1", "]"}], "]"}], " ", 
    RowBox[{"vecs", "[", 
     RowBox[{"[", "1", "]"}], "]"}]}]}], " ", "*)"}]], "Input"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"MultiNormalBranching", "[", 
    RowBox[{
    "noderank0_", ",", "tstart_", ",", "timestep_", ",", "xstart_", ",", 
     "branchingfactor_", ",", "nodestart_", ",", "dist_"}], "]"}], ":=", 
   RowBox[{"Module", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
       RowBox[{"mean", "=", 
        RowBox[{"dist", "[", 
         RowBox[{"[", "1", "]"}], "]"}]}], ",", 
       RowBox[{"covariancematrix", "=", 
        RowBox[{"dist", "[", 
         RowBox[{"[", "2", "]"}], "]"}]}], ",", 
       RowBox[{"nbpc", "=", 
        RowBox[{"dist", "[", 
         RowBox[{"[", "3", "]"}], "]"}]}], ",", "vecs", ",", "vals", ",", 
       "noderank", ",", "k", ",", "j1", ",", "j2", ",", "j3", ",", "j4", ",", 
       "j", ",", "j5", ",", "result"}], "}"}], ",", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{
       RowBox[{"{", 
        RowBox[{"vals", ",", "vecs"}], "}"}], "=", 
       RowBox[{"Eigensystem", "[", "covariancematrix", "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"noderank", "=", "noderank0"}], ";", "\[IndentingNewLine]", 
      RowBox[{"result", "=", 
       RowBox[{"Which", "[", 
        RowBox[{
         RowBox[{"nbpc", "\[Equal]", "1"}], ",", 
         RowBox[{"Table", "[", 
          RowBox[{
           RowBox[{
            RowBox[{"noderank", "=", 
             RowBox[{"noderank", "+", "1"}]}], ";", 
            RowBox[{"If", "[", 
             RowBox[{
              RowBox[{"branchingfactor", "\[Equal]", "1"}], ",", 
              "\[IndentingNewLine]", "\t", 
              RowBox[{"{", 
               RowBox[{"noderank", ",", 
                RowBox[{"tstart", "+", "timestep"}], ",", 
                RowBox[{"xstart", "+", "mean"}], ",", "nodestart"}], "}"}], 
              ",", "\[IndentingNewLine]", "\t", 
              RowBox[{"{", 
               RowBox[{"noderank", ",", 
                RowBox[{"tstart", "+", "timestep"}], ",", 
                RowBox[{"xstart", "+", "mean", "+", 
                 RowBox[{
                  RowBox[{"Sqrt", "[", 
                   RowBox[{"Abs", "[", 
                    RowBox[{"vals", "[", 
                    RowBox[{"[", "1", "]"}], "]"}], "]"}], " ", "]"}], 
                  RowBox[{"Re", "[", 
                   RowBox[{"vecs", "[", 
                    RowBox[{"[", "1", "]"}], "]"}], "]"}], 
                  RowBox[{"Quantile", "[", 
                   RowBox[{
                    RowBox[{"NormalDistribution", "[", 
                    RowBox[{"0", ",", "1"}], "]"}], ",", 
                    RowBox[{
                    RowBox[{"(", 
                    RowBox[{"j1", "-", 
                    RowBox[{"1", "/", "2"}]}], ")"}], "/", 
                    "branchingfactor"}]}], "]"}]}]}], ",", "nodestart"}], 
               "}"}]}], "]"}]}], ",", "\[IndentingNewLine]", "\t\t\t", 
           RowBox[{"{", 
            RowBox[{"j1", ",", "1", ",", "branchingfactor"}], "}"}]}], "]"}], 
         ",", "\[IndentingNewLine]", "\t", 
         RowBox[{"nbpc", "\[Equal]", "2"}], ",", 
         RowBox[{"Flatten", "[", 
          RowBox[{
           RowBox[{"Table", "[", 
            RowBox[{
             RowBox[{
              RowBox[{"noderank", "=", 
               RowBox[{"noderank", "+", "1"}]}], ";", 
              RowBox[{"If", "[", 
               RowBox[{
                RowBox[{"branchingfactor", "\[Equal]", "1"}], ",", 
                "\[IndentingNewLine]", "\t", 
                RowBox[{"{", 
                 RowBox[{"noderank", ",", 
                  RowBox[{"tstart", "+", "timestep"}], ",", 
                  RowBox[{"xstart", "+", "mean"}], ",", "nodestart"}], "}"}], 
                ",", "\[IndentingNewLine]", "\t", 
                RowBox[{"{", 
                 RowBox[{"noderank", ",", 
                  RowBox[{"tstart", "+", "timestep"}], ",", 
                  "\[IndentingNewLine]", 
                  RowBox[{"(*", 
                   RowBox[{
                    RowBox[{"Print", "[", 
                    RowBox[{"\"\<xstart=\>\"", ",", "xstart"}], "]"}], ";", 
                    "\[IndentingNewLine]", 
                    RowBox[{"Print", "[", 
                    RowBox[{"\"\<mean=\>\"", ",", "mean"}], "]"}], ";", 
                    "\[IndentingNewLine]", 
                    RowBox[{"Print", "[", 
                    RowBox[{"\"\<s=\>\"", ",", 
                    RowBox[{"Sum", "[", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"Sqrt", "[", 
                    RowBox[{"Abs", "[", 
                    RowBox[{"vals", "[", 
                    RowBox[{"[", "k", "]"}], "]"}], "]"}], " ", "]"}], 
                    RowBox[{"Re", "[", 
                    RowBox[{"vecs", "[", 
                    RowBox[{"[", "k", "]"}], "]"}], "]"}], 
                    RowBox[{"Quantile", "[", 
                    RowBox[{
                    RowBox[{"NormalDistribution", "[", 
                    RowBox[{"0", ",", "1"}], "]"}], ",", 
                    RowBox[{
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"Switch", "[", 
                    RowBox[{
                    "k", ",", "1", ",", "j1", ",", "2", ",", "j2", ",", "3", 
                    ",", "j3"}], "]"}], "-", 
                    RowBox[{"1", "/", "2"}]}], ")"}], "/", 
                    "branchingfactor"}]}], "]"}]}], ",", 
                    RowBox[{"{", 
                    RowBox[{"k", ",", "1", ",", "nbpc"}], "}"}]}], "]"}]}], 
                    "]"}], ";"}], "\[IndentingNewLine]", "*)"}], 
                  "\[IndentingNewLine]", 
                  RowBox[{"xstart", "+", "mean", "+", 
                   RowBox[{"Sum", "[", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"Sqrt", "[", 
                    RowBox[{"Abs", "[", 
                    RowBox[{"vals", "[", 
                    RowBox[{"[", "k", "]"}], "]"}], " ", "]"}], "]"}], 
                    RowBox[{"Re", "[", 
                    RowBox[{"vecs", "[", 
                    RowBox[{"[", "k", "]"}], "]"}], "]"}], 
                    RowBox[{"Quantile", "[", 
                    RowBox[{
                    RowBox[{"NormalDistribution", "[", 
                    RowBox[{"0", ",", "1"}], "]"}], ",", 
                    RowBox[{
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"Switch", "[", 
                    RowBox[{
                    "k", ",", "1", ",", "j1", ",", "2", ",", "j2", ",", "3", 
                    ",", "j3"}], "]"}], "-", 
                    RowBox[{"1", "/", "2"}]}], ")"}], "/", 
                    "branchingfactor"}]}], "]"}]}], ",", 
                    RowBox[{"{", 
                    RowBox[{"k", ",", "1", ",", "nbpc"}], "}"}]}], "]"}]}], 
                  ",", "nodestart"}], "}"}]}], "]"}]}], ",", 
             "\[IndentingNewLine]", "\t\t\t", 
             RowBox[{"{", 
              RowBox[{"j1", ",", "1", ",", "branchingfactor"}], "}"}], ",", 
             RowBox[{"{", 
              RowBox[{"j2", ",", "1", ",", "branchingfactor"}], "}"}]}], 
            "]"}], ",", "1"}], "]"}], ",", "\[IndentingNewLine]", 
         RowBox[{"nbpc", "\[Equal]", "3"}], ",", 
         RowBox[{"Flatten", "[", 
          RowBox[{
           RowBox[{"Table", "[", 
            RowBox[{
             RowBox[{
              RowBox[{"noderank", "=", 
               RowBox[{"noderank", "+", "1"}]}], ";", 
              RowBox[{"If", "[", 
               RowBox[{
                RowBox[{"branchingfactor", "\[Equal]", "1"}], ",", 
                "\[IndentingNewLine]", "\t", 
                RowBox[{"{", 
                 RowBox[{"noderank", ",", 
                  RowBox[{"tstart", "+", "timestep"}], ",", 
                  RowBox[{"{", 
                   RowBox[{"xstart", "+", "mean"}], "}"}], ",", "nodestart"}],
                  "}"}], ",", "\[IndentingNewLine]", "\t", 
                RowBox[{"{", 
                 RowBox[{"noderank", ",", 
                  RowBox[{"tstart", "+", "timestep"}], ",", 
                  RowBox[{"{", 
                   RowBox[{"xstart", "+", "mean", "+", 
                    RowBox[{"Sum", "[", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"Sqrt", "[", 
                    RowBox[{"Abs", "[", 
                    RowBox[{"vals", "[", 
                    RowBox[{"[", "k", "]"}], "]"}], " ", "]"}], "]"}], 
                    RowBox[{"Re", "[", 
                    RowBox[{"vecs", "[", 
                    RowBox[{"[", "k", "]"}], "]"}], "]"}], 
                    RowBox[{"Quantile", "[", 
                    RowBox[{
                    RowBox[{"NormalDistribution", "[", 
                    RowBox[{"0", ",", "1"}], "]"}], ",", 
                    RowBox[{
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"Switch", "[", 
                    RowBox[{
                    "k", ",", "1", ",", "j1", ",", "2", ",", "j2", ",", "3", 
                    ",", "j3"}], "]"}], "-", 
                    RowBox[{"1", "/", "2"}]}], ")"}], "/", 
                    "branchingfactor"}]}], "]"}]}], ",", 
                    RowBox[{"{", 
                    RowBox[{"k", ",", "1", ",", "nbpc"}], "}"}]}], "]"}]}], 
                   "}"}], ",", "nodestart"}], "}"}]}], "]"}]}], ",", 
             "\[IndentingNewLine]", "\t\t\t", 
             RowBox[{"{", 
              RowBox[{"j1", ",", "1", ",", "branchingfactor"}], "}"}], ",", 
             RowBox[{"{", 
              RowBox[{"j2", ",", "1", ",", "branchingfactor"}], "}"}], ",", 
             RowBox[{"{", 
              RowBox[{"j3", ",", "1", ",", "branchingfactor"}], "}"}]}], 
            "]"}], ",", "2"}], "]"}], ",", "\[IndentingNewLine]", 
         RowBox[{"nbpc", ">", "3"}], ",", 
         RowBox[{
         "Print", "[", "\"\<branching greater than 3 not implemented\>\"", 
          "]"}]}], "\[IndentingNewLine]", "]"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"{", 
       RowBox[{"result", ",", "noderank"}], "}"}]}]}], "]"}]}], 
  "\[IndentingNewLine]"}]], "Input",
 InitializationCell->True],

Cell[BoxData[""], "Input"],

Cell[BoxData[
 RowBox[{
  RowBox[{"GenerateTree", "[", 
   RowBox[{
    RowBox[{"OrthogonalCombineSpaces", "[", "SpecList_", "]"}], ",", "t0_"}], 
   "]"}], ":=", 
  RowBox[{"Module", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{
     "i", ",", "ioperand", ",", "jdate", ",", "NodeNumberVector", ",", 
      "reducedNodeNumberVector", ",", "result", ",", "Treelist", ",", 
      RowBox[{"tsl", "=", 
       RowBox[{"TimeStepList", "[", 
        RowBox[{"OrthogonalCombineSpaces", "[", "SpecList", "]"}], "]"}]}]}], 
     "}"}], ",", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"Treelist", "=", 
      RowBox[{"Table", "[", 
       RowBox[{
        RowBox[{"GenerateTree", "[", 
         RowBox[{
          RowBox[{"SpecList", "[", 
           RowBox[{"[", "i", "]"}], "]"}], ",", "t0"}], "]"}], ",", 
        RowBox[{"{", 
         RowBox[{"i", ",", "1", ",", 
          RowBox[{"Length", "[", "SpecList", "]"}]}], "}"}]}], "]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"NodeNumberVector", "=", 
      RowBox[{"Table", "[", 
       RowBox[{
        RowBox[{"Length", "[", 
         RowBox[{"Flatten", "[", 
          RowBox[{
           RowBox[{"Treelist", "[", 
            RowBox[{"[", "i", "]"}], "]"}], ",", "2"}], "]"}], "]"}], ",", 
        RowBox[{"{", 
         RowBox[{"i", ",", "1", ",", 
          RowBox[{"Length", "[", "SpecList", "]"}]}], "}"}]}], "]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"reducedNodeNumberVector", "=", 
      RowBox[{"Drop", "[", 
       RowBox[{"NodeNumberVector", ",", 
        RowBox[{"-", "1"}]}], "]"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"result", "=", "\[IndentingNewLine]", 
      RowBox[{"Table", "[", 
       RowBox[{
        RowBox[{"MultiDimensionalTimeSliceTensorialProduct", "[", 
         RowBox[{
          RowBox[{"Table", "[", 
           RowBox[{
            RowBox[{"Treelist", "[", 
             RowBox[{"[", 
              RowBox[{"ioperand", ",", "jdate"}], "]"}], "]"}], ",", 
            RowBox[{"{", 
             RowBox[{"ioperand", ",", "1", ",", 
              RowBox[{"Length", "[", "Treelist", "]"}]}], "}"}]}], "]"}], ",",
           "reducedNodeNumberVector"}], "]"}], ",", "\[IndentingNewLine]", 
        RowBox[{"{", 
         RowBox[{"jdate", ",", "1", ",", 
          RowBox[{
           RowBox[{"Length", "[", "tsl", "]"}], "+", "1"}]}], "}"}]}], 
       "]"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"NodeNameTable", "=", 
      RowBox[{"Map", "[", 
       RowBox[{
        RowBox[{
         RowBox[{"(", 
          RowBox[{"#", "[", 
           RowBox[{"[", "1", "]"}], "]"}], ")"}], "&"}], ",", 
        RowBox[{"Flatten", "[", 
         RowBox[{"result", ",", "2"}], "]"}]}], "]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"Map", "[", 
      RowBox[{
       RowBox[{
        RowBox[{"(", 
         RowBox[{"Map", "[", 
          RowBox[{
           RowBox[{
            RowBox[{"Map", "[", 
             RowBox[{
              RowBox[{"Function", "[", 
               RowBox[{
                RowBox[{"{", "x", "}"}], ",", 
                RowBox[{"{", 
                 RowBox[{
                  RowBox[{
                   RowBox[{
                    RowBox[{"Position", "[", 
                    RowBox[{"NodeNameTable", ",", 
                    RowBox[{"x", "[", 
                    RowBox[{"[", "1", "]"}], "]"}]}], "]"}], "[", 
                    RowBox[{"[", 
                    RowBox[{"1", ",", "1"}], "]"}], "]"}], "-", "1"}], ",", 
                  RowBox[{"x", "[", 
                   RowBox[{"[", "2", "]"}], "]"}], ",", 
                  RowBox[{"x", "[", 
                   RowBox[{"[", "3", "]"}], "]"}], ",", 
                  RowBox[{
                   RowBox[{
                    RowBox[{"Position", "[", 
                    RowBox[{"NodeNameTable", ",", 
                    RowBox[{"x", "[", 
                    RowBox[{"[", "4", "]"}], "]"}]}], "]"}], "[", 
                    RowBox[{"[", 
                    RowBox[{"1", ",", "1"}], "]"}], "]"}], "-", "1"}]}], 
                 "}"}]}], "]"}], ",", "#"}], "]"}], "&"}], ",", "#"}], "]"}], 
         ")"}], "&"}], ",", "result"}], "]"}]}]}], "\[IndentingNewLine]", 
   "]"}]}]], "Input",
 InitializationCell->True],

Cell[BoxData[
 RowBox[{
  RowBox[{"MCGeneratePath", "[", 
   RowBox[{
    RowBox[{"OrthogonalCombineSpaces", "[", "SpecList_", "]"}], ",", "t0_"}], 
   "]"}], ":=", 
  RowBox[{"Module", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{
     "i", ",", "ioperand", ",", "jdate", ",", "NodeNumberVector", ",", 
      "reducedNodeNumberVector", ",", "result", ",", "Treelist", ",", 
      RowBox[{"tsl", "=", 
       RowBox[{"TimeStepList", "[", 
        RowBox[{"OrthogonalCombineSpaces", "[", "SpecList", "]"}], "]"}]}]}], 
     "}"}], ",", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"Treelist", "=", 
      RowBox[{"Table", "[", 
       RowBox[{
        RowBox[{"MCGeneratePath", "[", 
         RowBox[{
          RowBox[{"SpecList", "[", 
           RowBox[{"[", "i", "]"}], "]"}], ",", "t0"}], "]"}], ",", 
        RowBox[{"{", 
         RowBox[{"i", ",", "1", ",", 
          RowBox[{"Length", "[", "SpecList", "]"}]}], "}"}]}], "]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"Table", "[", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{
         RowBox[{"Treelist", "[", 
          RowBox[{"[", 
           RowBox[{"1", ",", "j", ",", "1"}], "]"}], "]"}], ",", 
         RowBox[{"Treelist", "[", 
          RowBox[{"[", 
           RowBox[{"1", ",", "j", ",", "2"}], "]"}], "]"}], ",", 
         RowBox[{"Apply", "[", 
          RowBox[{"Join", ",", 
           RowBox[{"Table", "[", 
            RowBox[{
             RowBox[{"Treelist", "[", 
              RowBox[{"[", 
               RowBox[{"k", ",", "j", ",", "3"}], "]"}], "]"}], ",", 
             RowBox[{"{", 
              RowBox[{"k", ",", "1", ",", 
               RowBox[{"Length", "[", "SpecList", "]"}]}], "}"}]}], "]"}]}], 
          "]"}], ",", 
         RowBox[{"Treelist", "[", 
          RowBox[{"[", 
           RowBox[{"1", ",", "j", ",", "4"}], "]"}], "]"}]}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"j", ",", "1", ",", 
         RowBox[{"Length", "[", 
          RowBox[{"Treelist", "[", 
           RowBox[{"[", "1", "]"}], "]"}], "]"}]}], "}"}]}], "]"}]}]}], 
   "\[IndentingNewLine]", "]"}]}]], "Input",
 InitializationCell->True],

Cell[BoxData[
 RowBox[{
  RowBox[{"GenerateTree", "[", 
   RowBox[{
    RowBox[{"NormalRankCombineSpaces", "[", 
     RowBox[{"SpecList_", ",", "CorrelationMatrix_"}], "]"}], ",", "t0_"}], 
   "]"}], ":=", 
  RowBox[{"Module", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{
     "i", ",", "ioperand", ",", "reducedNodeNumberVector", ",", 
      "NodeNumberVector", ",", "Mcorrelation", ",", "jdate", ",", "dim1", ",",
       "result", ",", "Treelist0", ",", 
      RowBox[{"tsl", "=", 
       RowBox[{"TimeStepList", "[", 
        RowBox[{"NormalRankCombineSpaces", "[", 
         RowBox[{"SpecList", ",", "CorrelationMatrix"}], "]"}], "]"}]}]}], 
     "}"}], ",", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"dim1", "=", 
      RowBox[{"Dimension", "[", 
       RowBox[{"NormalRankCombineSpaces", "[", 
        RowBox[{"SpecList", ",", "CorrelationMatrix"}], "]"}], "]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"Treelist", "=", 
      RowBox[{"Table", "[", 
       RowBox[{
        RowBox[{"GenerateTree", "[", 
         RowBox[{
          RowBox[{"SpecList", "[", 
           RowBox[{"[", "i", "]"}], "]"}], ",", "t0"}], "]"}], ",", 
        RowBox[{"{", 
         RowBox[{"i", ",", "1", ",", 
          RowBox[{"Length", "[", "SpecList", "]"}]}], "}"}]}], "]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"NodeNumberVector", "=", 
      RowBox[{"Table", "[", 
       RowBox[{
        RowBox[{"Length", "[", 
         RowBox[{"Flatten", "[", 
          RowBox[{
           RowBox[{"Treelist", "[", 
            RowBox[{"[", "i", "]"}], "]"}], ",", "2"}], "]"}], "]"}], ",", 
        RowBox[{"{", 
         RowBox[{"i", ",", "1", ",", 
          RowBox[{"Length", "[", "SpecList", "]"}]}], "}"}]}], "]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"reducedNodeNumberVector", "=", 
      RowBox[{"Drop", "[", 
       RowBox[{"NodeNumberVector", ",", 
        RowBox[{"-", "1"}]}], "]"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"Mcorrelation", "=", 
      RowBox[{"CholeskyDecomposition", "[", "CorrelationMatrix", "]"}]}], ";",
      "\[IndentingNewLine]", 
     RowBox[{"(*", " ", 
      RowBox[{
       RowBox[{"Print", "[", 
        RowBox[{"\"\<Treelist=\>\"", ",", "Treelist"}], "]"}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"Print", "[", 
        RowBox[{
        "\"\<reducedNodeNumberVector=\>\"", ",", "reducedNodeNumberVector"}], 
        "]"}], ";", "\[IndentingNewLine]", 
       RowBox[{"Print", "[", 
        RowBox[{"\"\<tsl=\>\"", ",", "tsl"}], "]"}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"Print", "[", 
        RowBox[{"\"\<dim1=\>\"", ",", "dim1"}], "]"}], ";"}], "  ", "*)"}], 
     "\[IndentingNewLine]", 
     RowBox[{"result", "=", 
      RowBox[{"Table", "[", 
       RowBox[{
        RowBox[{"If", "[", 
         RowBox[{
          RowBox[{"jdate", "\[Equal]", "1"}], ",", "\[IndentingNewLine]", 
          RowBox[{"MultiDimensionalTimeSliceTensorialProduct", "[", 
           RowBox[{
            RowBox[{"Table", "[", 
             RowBox[{
              RowBox[{"Treelist", "[", 
               RowBox[{"[", 
                RowBox[{"ioperand", ",", "jdate"}], "]"}], "]"}], ",", 
              RowBox[{"{", 
               RowBox[{"ioperand", ",", "1", ",", 
                RowBox[{"Length", "[", "Treelist", "]"}]}], "}"}]}], "]"}], 
            ",", "reducedNodeNumberVector"}], "]"}], ",", 
          RowBox[{"MultiDimensionalTimeSliceTensorialProduct", "[", 
           RowBox[{
            RowBox[{"Table", "[", 
             RowBox[{
              RowBox[{"Treelist", "[", 
               RowBox[{"[", 
                RowBox[{"ioperand", ",", "jdate"}], "]"}], "]"}], ",", 
              RowBox[{"{", 
               RowBox[{"ioperand", ",", "1", ",", 
                RowBox[{"Length", "[", "Treelist", "]"}]}], "}"}]}], "]"}], 
            ",", "Mcorrelation", ",", 
            RowBox[{"Table", "[", 
             RowBox[{
              RowBox[{"SpecList", "[", 
               RowBox[{"[", 
                RowBox[{"ioperand", ",", "3", ",", 
                 RowBox[{"jdate", "-", "1"}]}], "]"}], "]"}], ",", 
              RowBox[{"{", 
               RowBox[{"ioperand", ",", "1", ",", 
                RowBox[{"Length", "[", "SpecList", "]"}]}], "}"}]}], "]"}], 
            ",", "reducedNodeNumberVector", ",", 
            RowBox[{"Table", "[", 
             RowBox[{
              RowBox[{"Treelist", "[", 
               RowBox[{"[", 
                RowBox[{"ioperand", ",", 
                 RowBox[{"jdate", "-", "1"}]}], "]"}], "]"}], ",", 
              RowBox[{"{", 
               RowBox[{"ioperand", ",", "1", ",", 
                RowBox[{"Length", "[", "Treelist", "]"}]}], "}"}]}], "]"}]}], 
           "]"}]}], "]"}], ",", "\[IndentingNewLine]", 
        RowBox[{"{", 
         RowBox[{"jdate", ",", "1", ",", 
          RowBox[{
           RowBox[{"Length", "[", "tsl", "]"}], "+", "1"}]}], "}"}]}], 
       "]"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"NodeNameTable", "=", 
      RowBox[{"Map", "[", 
       RowBox[{
        RowBox[{
         RowBox[{"(", 
          RowBox[{"#", "[", 
           RowBox[{"[", "1", "]"}], "]"}], ")"}], "&"}], ",", 
        RowBox[{"Flatten", "[", 
         RowBox[{"result", ",", "2"}], "]"}]}], "]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"(*", " ", 
      RowBox[{
       RowBox[{"Print", "[", 
        RowBox[{"\"\<NodeNameTable=\>\"", ",", "NodeNameTable"}], "]"}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"Print", "[", 
        RowBox[{"\"\<result=\>\"", ",", "result"}], "]"}], ";"}], " ", "*)"}],
      "\[IndentingNewLine]", 
     RowBox[{"Map", "[", 
      RowBox[{
       RowBox[{
        RowBox[{"(", 
         RowBox[{"Map", "[", 
          RowBox[{
           RowBox[{
            RowBox[{"Map", "[", 
             RowBox[{
              RowBox[{"Function", "[", 
               RowBox[{
                RowBox[{"{", "x", "}"}], ",", 
                RowBox[{"{", 
                 RowBox[{
                  RowBox[{
                   RowBox[{
                    RowBox[{"Position", "[", 
                    RowBox[{"NodeNameTable", ",", 
                    RowBox[{"x", "[", 
                    RowBox[{"[", "1", "]"}], "]"}]}], "]"}], "[", 
                    RowBox[{"[", 
                    RowBox[{"1", ",", "1"}], "]"}], "]"}], "-", "1"}], ",", 
                  RowBox[{"x", "[", 
                   RowBox[{"[", "2", "]"}], "]"}], ",", 
                  RowBox[{"x", "[", 
                   RowBox[{"[", "3", "]"}], "]"}], ",", 
                  RowBox[{
                   RowBox[{
                    RowBox[{"Position", "[", 
                    RowBox[{"NodeNameTable", ",", 
                    RowBox[{"x", "[", 
                    RowBox[{"[", "4", "]"}], "]"}]}], "]"}], "[", 
                    RowBox[{"[", 
                    RowBox[{"1", ",", "1"}], "]"}], "]"}], "-", "1"}]}], 
                 "}"}]}], "]"}], ",", "#"}], "]"}], "&"}], ",", "#"}], "]"}], 
         ")"}], "&"}], ",", "result"}], "]"}]}]}], "\[IndentingNewLine]", 
   "]"}]}]], "Input",
 InitializationCell->True],

Cell[BoxData[
 RowBox[{
  RowBox[{"MCGeneratePath", "[", 
   RowBox[{
    RowBox[{"NormalRankCombineSpaces", "[", 
     RowBox[{"SpecList_", ",", "CorrelationMatrix_"}], "]"}], ",", "t0_"}], 
   "]"}], ":=", 
  RowBox[{"Module", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{
     "i", ",", "ioperand", ",", "jdate", ",", "NodeNumberVector", ",", 
      "reducedNodeNumberVector", ",", "result", ",", "Treelist", ",", 
      RowBox[{"tsl", "=", 
       RowBox[{"TimeStepList", "[", 
        RowBox[{"OrthogonalCombineSpaces", "[", "SpecList", "]"}], "]"}]}]}], 
     "}"}], ",", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"Treelist", "=", 
      RowBox[{"Table", "[", 
       RowBox[{
        RowBox[{"MCGeneratePath", "[", 
         RowBox[{
          RowBox[{"SpecList", "[", 
           RowBox[{"[", "i", "]"}], "]"}], ",", "t0"}], "]"}], ",", 
        RowBox[{"{", 
         RowBox[{"i", ",", "1", ",", 
          RowBox[{"Length", "[", "SpecList", "]"}]}], "}"}]}], "]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"Mcorrelation", "=", 
      RowBox[{"CholeskyDecomposition", "[", "CorrelationMatrix", "]"}]}], ";",
      "\[IndentingNewLine]", 
     RowBox[{"Table", "[", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{
         RowBox[{"Treelist", "[", 
          RowBox[{"[", 
           RowBox[{"1", ",", "j", ",", "1"}], "]"}], "]"}], ",", 
         RowBox[{"Treelist", "[", 
          RowBox[{"[", 
           RowBox[{"1", ",", "j", ",", "2"}], "]"}], "]"}], ",", 
         RowBox[{"If", "[", 
          RowBox[{
           RowBox[{"j", "\[Equal]", "1"}], ",", 
           RowBox[{"Apply", "[", 
            RowBox[{"Join", ",", 
             RowBox[{"Table", "[", 
              RowBox[{
               RowBox[{"Treelist", "[", 
                RowBox[{"[", 
                 RowBox[{"k", ",", "j", ",", "3"}], "]"}], "]"}], ",", 
               RowBox[{"{", 
                RowBox[{"k", ",", "1", ",", 
                 RowBox[{"Length", "[", "SpecList", "]"}]}], "}"}]}], "]"}]}],
             "]"}], ",", "\[IndentingNewLine]", 
           RowBox[{"Module", "[", 
            RowBox[{
             RowBox[{"{", 
              RowBox[{"Y", "=", 
               RowBox[{"Mcorrelation", ".", 
                RowBox[{"Table", "[", 
                 RowBox[{
                  RowBox[{
                   RowBox[{"ToGaussian", "[", 
                    RowBox[{
                    RowBox[{"SpecList", "[", 
                    RowBox[{"[", 
                    RowBox[{"k", ",", "3", ",", 
                    RowBox[{"j", "-", "1"}], ",", "1"}], "]"}], "]"}], ",", 
                    RowBox[{
                    RowBox[{"Treelist", "[", 
                    RowBox[{"[", 
                    RowBox[{"k", ",", "j", ",", "3", ",", "1"}], "]"}], "]"}],
                     "-", 
                    RowBox[{"Treelist", "[", 
                    RowBox[{"[", 
                    RowBox[{"k", ",", 
                    RowBox[{"j", "-", "1"}], ",", "3", ",", "1"}], "]"}], 
                    "]"}]}]}], "]"}], "[", 
                   RowBox[{"Treelist", "[", 
                    RowBox[{"[", 
                    RowBox[{"k", ",", 
                    RowBox[{"j", "-", "1"}], ",", "3", ",", "1"}], "]"}], 
                    "]"}], "]"}], ",", 
                  RowBox[{"{", 
                   RowBox[{"k", ",", "1", ",", 
                    RowBox[{"Length", "[", "SpecList", "]"}]}], "}"}]}], 
                 "]"}]}]}], "}"}], ",", "\[IndentingNewLine]", 
             RowBox[{"Table", "[", 
              RowBox[{
               RowBox[{
                RowBox[{
                 RowBox[{"FromGaussian", "[", 
                  RowBox[{
                   RowBox[{"SpecList", "[", 
                    RowBox[{"[", 
                    RowBox[{"k", ",", "3", ",", 
                    RowBox[{"j", "-", "1"}], ",", "1"}], "]"}], "]"}], ",", 
                   RowBox[{"Y", "[", 
                    RowBox[{"[", "k", "]"}], "]"}]}], "]"}], "[", 
                 RowBox[{"Treelist", "[", 
                  RowBox[{"[", 
                   RowBox[{"k", ",", 
                    RowBox[{"j", "-", "1"}], ",", "3", ",", "1"}], "]"}], 
                  "]"}], "]"}], "+", 
                RowBox[{"Treelist", "[", 
                 RowBox[{"[", 
                  RowBox[{"k", ",", 
                   RowBox[{"j", "-", "1"}], ",", "3", ",", "1"}], "]"}], 
                 "]"}]}], ",", 
               RowBox[{"{", 
                RowBox[{"k", ",", "1", ",", 
                 RowBox[{"Length", "[", "SpecList", "]"}]}], "}"}]}], "]"}]}],
             "]"}]}], "\[IndentingNewLine]", "]"}], ",", 
         RowBox[{"Treelist", "[", 
          RowBox[{"[", 
           RowBox[{"1", ",", "j", ",", "4"}], "]"}], "]"}]}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"j", ",", "1", ",", 
         RowBox[{"Length", "[", 
          RowBox[{"Treelist", "[", 
           RowBox[{"[", "1", "]"}], "]"}], "]"}]}], "}"}]}], "]"}]}]}], 
   "\[IndentingNewLine]", "]"}]}]], "Input",
 InitializationCell->True],

Cell[BoxData[
 RowBox[{
  RowBox[{"CompileProcess", "[", 
   RowBox[{"FromProcessTree", "[", 
    RowBox[{
    "DimensionList_", ",", "Process_", ",", "TimeStepsList_", ",", " ", 
     "branchingfactorlist_", ",", "x0_"}], "]"}], "]"}], ":=", 
  RowBox[{"Module", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{
      RowBox[{"nb", "=", 
       RowBox[{"Length", "[", "TimeStepsList", "]"}]}], ",", "i", ",", 
      "DistList"}], "}"}], ",", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"DistList", "=", 
      RowBox[{"Table", "[", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{
          RowBox[{
           RowBox[{"ProcessToDistribution", "[", "Process", "]"}], "[", 
           RowBox[{"TimeStepsList", "[", 
            RowBox[{"[", "i", "]"}], "]"}], "]"}], ",", 
          RowBox[{"TimeStepsList", "[", 
           RowBox[{"[", "i", "]"}], "]"}], ",", 
          RowBox[{"branchingfactorlist", "[", 
           RowBox[{"[", "i", "]"}], "]"}]}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{"i", ",", "1", ",", "nb"}], "}"}]}], "]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"FromDistributionTree", "[", 
      RowBox[{"DimensionList", ",", "x0", ",", "DistList"}], "]"}]}]}], 
   "]"}]}]], "Input",
 InitializationCell->True],

Cell[BoxData[
 RowBox[{"On", "[", 
  RowBox[{"General", "::", "\"\<spell1\>\""}], "]"}]], "Input",
 InitializationCell->True],

Cell[BoxData[
 StyleBox[
  RowBox[{"(*", " ", 
   RowBox[{"description", " ", "of", " ", "the", " ", "processes"}], " ", 
   "*)"}],
  FontSize->18,
  FontColor->RGBColor[1, 0, 0]]], "Input"],

Cell[BoxData[
 RowBox[{
  RowBox[{"ProcessToDistribution", "[", 
   RowBox[{"NormalProcess", "[", 
    RowBox[{"mean_", ",", "sdev_"}], "]"}], "]"}], ":=", 
  RowBox[{"Function", "[", 
   RowBox[{"x", ",", 
    RowBox[{"NormalDistributionD", "[", 
     RowBox[{
      RowBox[{"mean", " ", "x"}], ",", 
      RowBox[{"sdev", " ", 
       RowBox[{"Sqrt", "[", 
        RowBox[{"Abs", "[", "x", "]"}], "]"}]}]}], "]"}]}], "]"}]}]], "Input",
 InitializationCell->True],

Cell[BoxData[
 RowBox[{
  RowBox[{"ProcessToDistribution", "[", 
   RowBox[{"MultiNormalProcess", "[", 
    RowBox[{"mean_", ",", "cov_", ",", "nbpc_"}], "]"}], "]"}], ":=", 
  RowBox[{"Function", "[", 
   RowBox[{"x", ",", 
    RowBox[{"MultinormalDistributionD", "[", 
     RowBox[{
      RowBox[{"mean", " ", "x"}], ",", 
      RowBox[{"cov", "  ", 
       RowBox[{"Abs", "[", "x", "]"}]}], ",", "nbpc"}], "]"}]}], 
   "]"}]}]], "Input",
 InitializationCell->True],

Cell[BoxData[
 RowBox[{
  RowBox[{"ProcessToDistribution", "[", 
   RowBox[{"LogNormalProcess", "[", 
    RowBox[{"logmean_", ",", "logsdev_"}], "]"}], "]"}], ":=", 
  RowBox[{"Function", "[", 
   RowBox[{
    RowBox[{"{", "x", "}"}], ",", 
    RowBox[{"LogNormalDistributionD", "[", 
     RowBox[{
      RowBox[{"logmean", " ", "x"}], ",", 
      RowBox[{"logsdev", " ", 
       RowBox[{"Sqrt", "[", 
        RowBox[{"Abs", "[", "x", "]"}], "]"}]}]}], "]"}]}], "]"}]}]], "Input",
 InitializationCell->True],

Cell[BoxData[
 RowBox[{
  RowBox[{"ProcessToDistribution", "[", 
   RowBox[{"MeanRevertingProcess", "[", 
    RowBox[{
    "longtermlimit_", ",", "revertingspeed_", ",", " ", "localsdev_"}], "]"}],
    "]"}], ":=", 
  RowBox[{"Function", "[", 
   RowBox[{
    RowBox[{"{", "x", "}"}], ",", 
    RowBox[{"LinearDriftNormalDistributionD", "[", 
     RowBox[{
      RowBox[{"-", 
       RowBox[{"(", 
        RowBox[{"1", "-", 
         RowBox[{"Exp", "[", 
          RowBox[{
           RowBox[{"-", "revertingspeed"}], " ", "x"}], "]"}]}], ")"}]}], ",", 
      RowBox[{"longtermlimit", " ", 
       RowBox[{"(", 
        RowBox[{"1", "-", 
         RowBox[{"Exp", "[", 
          RowBox[{
           RowBox[{"-", "revertingspeed"}], " ", "x"}], "]"}]}], ")"}]}], ",", 
      RowBox[{"localsdev", " ", 
       RowBox[{"Sqrt", "[", 
        RowBox[{
         RowBox[{"(", 
          RowBox[{"1", "-", 
           RowBox[{"Exp", "[", 
            RowBox[{
             RowBox[{"-", "2"}], "revertingspeed", " ", "x"}], "]"}]}], ")"}],
          "/", 
         RowBox[{"(", 
          RowBox[{"2", " ", "revertingspeed"}], ")"}]}], "]"}]}]}], "]"}]}], 
   "]"}]}]], "Input",
 InitializationCell->True],

Cell[BoxData[
 RowBox[{
  RowBox[{"ProcessToDistribution", "[", 
   RowBox[{"Schwartz2FactorsProcess", "[", 
    RowBox[{
    "kappaChi_", ",", "sigmaChi_", ",", "MuZeta_", ",", "SigmaZeta_", ",", 
     "rho_", ",", "deltaT_"}], "]"}], "]"}], ":=", "\[IndentingNewLine]", 
  RowBox[{"Function", "[", 
   RowBox[{
    RowBox[{"{", "x", "}"}], ",", 
    RowBox[{"Schwartz2FactorsDistributionD", "[", 
     RowBox[{
     "kappaChi", ",", "sigmaChi", ",", "MuZeta", ",", "SigmaZeta", ",", "rho",
       ",", "deltaT"}], "]"}]}], "]"}]}]], "Input",
 InitializationCell->True],

Cell[BoxData[
 StyleBox[
  RowBox[{"(*", " ", "Exemples", " ", "*)"}],
  FontSize->18,
  FontColor->RGBColor[1, 0, 0],
  Background->None]], "Input"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"Timing", "[", 
  RowBox[{
   RowBox[{"tree1", "=", 
    RowBox[{"GenerateTree", "[", 
     RowBox[{
      RowBox[{"OrthogonalCombineSpaces", "[", 
       RowBox[{"{", "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"FromDistributionTree", "[", 
          RowBox[{
           RowBox[{"{", "\"\<equity\>\"", "}"}], ",", 
           RowBox[{"{", 
            RowBox[{
             RowBox[{"{", 
              RowBox[{
               RowBox[{"StudentTDistributionD", "[", "1.1", "]"}], ",", "1", 
               ",", "3"}], "}"}], ",", 
             RowBox[{"{", 
              RowBox[{
               RowBox[{"StudentTDistributionD", "[", "1.1", "]"}], ",", "1", 
               ",", "2"}], "}"}], ",", 
             RowBox[{"{", 
              RowBox[{
               RowBox[{"StudentTDistributionD", "[", "1.1", "]"}], ",", "1", 
               ",", "2"}], "}"}]}], "}"}]}], "]"}], ",", 
         "\[IndentingNewLine]", 
         RowBox[{"FromDistributionTree", "[", 
          RowBox[{
           RowBox[{"{", "\"\<IR\>\"", "}"}], ",", 
           RowBox[{"{", 
            RowBox[{
             RowBox[{"{", 
              RowBox[{
               RowBox[{"StudentTDistributionD", "[", "1.1", "]"}], ",", "1", 
               ",", "4"}], "}"}], ",", 
             RowBox[{"{", 
              RowBox[{
               RowBox[{"StudentTDistributionD", "[", "1.1", "]"}], ",", "1", 
               ",", "5"}], "}"}], ",", 
             RowBox[{"{", 
              RowBox[{
               RowBox[{"StudentTDistributionD", "[", "1.1", "]"}], ",", "1", 
               ",", "2"}], "}"}]}], "}"}]}], "]"}]}], "\[IndentingNewLine]", 
        "}"}], "]"}], ",", "\[IndentingNewLine]", "100", ",", "0"}], "]"}]}], 
   ";", 
   RowBox[{
    RowBox[{"ToString", "[", 
     RowBox[{
      RowBox[{"Length", "[", "tree1", "]"}], "-", "1"}], "]"}], "<>", 
    "\"\< stages \>\"", " ", "<>", " ", 
    RowBox[{"ToString", "[", 
     RowBox[{"Length", "[", 
      RowBox[{"Flatten", "[", 
       RowBox[{"tree1", ",", "2"}], "]"}], "]"}], "]"}], "<>", 
    "\"\< nodes\>\""}]}], "]"}]], "Input"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{"0.851`", " ", "Second"}], ",", "\<\"3 stages 613 nodes\"\>"}], 
  "}"}]], "Output"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"Timing", "[", 
  RowBox[{"tree1", "=", 
   RowBox[{"MCGeneratePath", "[", 
    RowBox[{
     RowBox[{"FromDistributionTree", "[", 
      RowBox[{
       RowBox[{"{", "\"\<equity\>\"", "}"}], ",", 
       RowBox[{"{", "1000", "}"}], ",", 
       RowBox[{"{", "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{
           RowBox[{"StudentTDistributionD", "[", "1.1", "]"}], ",", "1", ",", 
           "3"}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{"StudentTDistributionD", "[", "1.1", "]"}], ",", "1", ",", 
           "2"}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{"StudentTDistributionD", "[", "1.1", "]"}], ",", "1", ",", 
           "2"}], "}"}]}], "\[IndentingNewLine]", "}"}]}], "]"}], ",", "0"}], 
    "]"}]}], "]"}]], "Input"],

Cell[CellGroupData[{

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"j=\"\>", "\[InvisibleSpace]", "3"}],
  SequenceForm["j=", 3],
  Editable->False]], "Print"],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"j=\"\>", "\[InvisibleSpace]", "1"}],
  SequenceForm["j=", 1],
  Editable->False]], "Print"],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"j=\"\>", "\[InvisibleSpace]", "1"}],
  SequenceForm["j=", 1],
  Editable->False]], "Print"]
}, Open  ]],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{"0.02999999999999936`", " ", "Second"}], ",", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"0", ",", "0", ",", 
       RowBox[{"{", "1000", "}"}], ",", "0"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"1", ",", "1", ",", 
       RowBox[{"{", "1001.6305562840216`", "}"}], ",", "0"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"2", ",", "2", ",", 
       RowBox[{"{", "1000.6674899623895`", "}"}], ",", "1"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"3", ",", "3", ",", 
       RowBox[{"{", "999.7044236407573`", "}"}], ",", "2"}], "}"}]}], "}"}]}],
   "}"}]], "Output"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"Timing", "[", 
  RowBox[{"tree1", "=", 
   RowBox[{"MCGeneratePath", "[", 
    RowBox[{
     RowBox[{"FromDistributionTree", "[", 
      RowBox[{
       RowBox[{"{", "\"\<equity\>\"", "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"1000", ",", "200", ",", "100"}], "}"}], ",", 
       RowBox[{"{", "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{
           RowBox[{"MultinormalDistributionD", "[", 
            RowBox[{
             RowBox[{"{", 
              RowBox[{"0.1", ",", "0.2", ",", "0.1"}], "}"}], ",", 
             RowBox[{"{", 
              RowBox[{
               RowBox[{"{", 
                RowBox[{"1", ",", "0.5", ",", "0.25"}], "}"}], ",", 
               RowBox[{"{", 
                RowBox[{"0.5", ",", "1", ",", "0.25"}], "}"}], ",", 
               RowBox[{"{", 
                RowBox[{"0.25", ",", "0.25", ",", "1"}], "}"}]}], "}"}], ",", 
             "2"}], "]"}], ",", "1", ",", "30"}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{"MultinormalDistributionD", "[", 
            RowBox[{
             RowBox[{"{", 
              RowBox[{"0.1", ",", "0.2", ",", "0.1"}], "}"}], ",", 
             RowBox[{"{", 
              RowBox[{
               RowBox[{"{", 
                RowBox[{"1", ",", "0.5", ",", "0.25"}], "}"}], ",", 
               RowBox[{"{", 
                RowBox[{"0.5", ",", "1", ",", "0.25"}], "}"}], ",", 
               RowBox[{"{", 
                RowBox[{"0.25", ",", "0.25", ",", "1"}], "}"}]}], "}"}], ",", 
             "2"}], "]"}], ",", "1", ",", "30"}], "}"}]}], 
        "\[IndentingNewLine]", "}"}]}], "]"}], ",", "0"}], "]"}]}], 
  "]"}]], "Input"],

Cell[CellGroupData[{

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"j=\"\>", "\[InvisibleSpace]", 
   RowBox[{"{", 
    RowBox[{"8", ",", "12"}], "}"}]}],
  SequenceForm["j=", {8, 12}],
  Editable->False]], "Print"],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"j=\"\>", "\[InvisibleSpace]", 
   RowBox[{"{", 
    RowBox[{"2", ",", "22"}], "}"}]}],
  SequenceForm["j=", {2, 22}],
  Editable->False]], "Print"]
}, Open  ]],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{"0.020000000000000462`", " ", "Second"}], ",", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"0", ",", "0", ",", 
       RowBox[{"{", 
        RowBox[{"1000", ",", "200", ",", "100"}], "}"}], ",", "0"}], "}"}], 
     ",", 
     RowBox[{"{", 
      RowBox[{"1", ",", "1", ",", 
       RowBox[{"{", 
        RowBox[{
        "999.6377032552186`", ",", "199.73770325521858`", ",", 
         "99.45955821315918`"}], "}"}], ",", "0"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"2", ",", "2", ",", 
       RowBox[{"{", 
        RowBox[{
        "998.2293584092445`", ",", "198.42935840924443`", ",", 
         "99.03853432677394`"}], "}"}], ",", "1"}], "}"}]}], "}"}]}], 
  "}"}]], "Output"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"Timing", "[", 
  RowBox[{"tree1", "=", 
   RowBox[{"GenerateTree", "[", 
    RowBox[{
     RowBox[{"FromDistributionTree", "[", 
      RowBox[{
       RowBox[{"{", "\"\<equity\>\"", "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"1000", ",", "200", ",", "100"}], "}"}], ",", 
       RowBox[{"{", "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{
           RowBox[{"MultinormalDistributionD", "[", 
            RowBox[{
             RowBox[{"{", 
              RowBox[{"0.1", ",", "0.2", ",", "0.1"}], "}"}], ",", 
             RowBox[{"{", 
              RowBox[{
               RowBox[{"{", 
                RowBox[{"1", ",", "0.5", ",", "0.25"}], "}"}], ",", 
               RowBox[{"{", 
                RowBox[{"0.5", ",", "1", ",", "0.25"}], "}"}], ",", 
               RowBox[{"{", 
                RowBox[{"0.25", ",", "0.25", ",", "1"}], "}"}]}], "}"}], ",", 
             "2"}], "]"}], ",", "1", ",", "3"}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{"MultinormalDistributionD", "[", 
            RowBox[{
             RowBox[{"{", 
              RowBox[{"0.1", ",", "0.2", ",", "0.1"}], "}"}], ",", 
             RowBox[{"{", 
              RowBox[{
               RowBox[{"{", 
                RowBox[{"1", ",", "0.5", ",", "0.25"}], "}"}], ",", 
               RowBox[{"{", 
                RowBox[{"0.5", ",", "1", ",", "0.25"}], "}"}], ",", 
               RowBox[{"{", 
                RowBox[{"0.25", ",", "0.25", ",", "1"}], "}"}]}], "}"}], ",", 
             "2"}], "]"}], ",", "1", ",", "3"}], "}"}]}], 
        "\[IndentingNewLine]", "}"}]}], "]"}], ",", "0"}], "]"}]}], 
  "]"}]], "Input"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{"0.6110000000000007`", " ", "Second"}], ",", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"{", 
       RowBox[{"{", 
        RowBox[{"0", ",", "0", ",", 
         RowBox[{"{", 
          RowBox[{"1000", ",", "200", ",", "100"}], "}"}], ",", "0"}], "}"}], 
       "}"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{"1", ",", "1", ",", 
          RowBox[{"{", 
           RowBox[{
           "999.5961168765796`", ",", "199.6961168765795`", ",", 
            "98.74649905346885`"}], "}"}], ",", "0"}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{"2", ",", "1", ",", 
          RowBox[{"{", 
           RowBox[{
           "999.3118778419023`", ",", "199.4118778419022`", ",", 
            "99.52305453770158`"}], "}"}], ",", "0"}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{"3", ",", "1", ",", 
          RowBox[{"{", 
           RowBox[{
           "999.0276388072249`", ",", "199.12763880722488`", ",", 
            "100.29961002193431`"}], "}"}], ",", "0"}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{"4", ",", "1", ",", 
          RowBox[{"{", 
           RowBox[{
           "1000.3842390346773`", ",", "200.4842390346773`", ",", 
            "99.32344451576726`"}], "}"}], ",", "0"}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{"5", ",", "1", ",", 
          RowBox[{"{", 
           RowBox[{"1000.1`", ",", "200.2`", ",", "100.1`"}], "}"}], ",", 
          "0"}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{"6", ",", "1", ",", 
          RowBox[{"{", 
           RowBox[{
           "999.8157609653227`", ",", "199.91576096532268`", ",", 
            "100.87655548423272`"}], "}"}], ",", "0"}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{"7", ",", "1", ",", 
          RowBox[{"{", 
           RowBox[{
           "1001.1723611927752`", ",", "201.2723611927751`", ",", 
            "99.90038997806568`"}], "}"}], ",", "0"}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{"8", ",", "1", ",", 
          RowBox[{"{", 
           RowBox[{
           "1000.8881221580978`", ",", "200.98812215809778`", ",", 
            "100.6769454622984`"}], "}"}], ",", "0"}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{"9", ",", "1", ",", 
          RowBox[{"{", 
           RowBox[{
           "1000.6038831234205`", ",", "200.70388312342047`", ",", 
            "101.45350094653114`"}], "}"}], ",", "0"}], "}"}]}], "}"}], "}"}],
      ",", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{"10", ",", "2", ",", 
           RowBox[{"{", 
            RowBox[{
            "999.1922337531591`", ",", "199.39223375315902`", ",", 
             "97.4929981069377`"}], "}"}], ",", "1"}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{"11", ",", "2", ",", 
           RowBox[{"{", 
            RowBox[{
            "998.9079947184819`", ",", "199.1079947184817`", ",", 
             "98.26955359117044`"}], "}"}], ",", "1"}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{"12", ",", "2", ",", 
           RowBox[{"{", 
            RowBox[{
            "998.6237556838045`", ",", "198.8237556838044`", ",", 
             "99.04610907540317`"}], "}"}], ",", "1"}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{"13", ",", "2", ",", 
           RowBox[{"{", 
            RowBox[{
            "999.9803559112569`", ",", "200.1803559112568`", ",", 
             "98.06994356923612`"}], "}"}], ",", "1"}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{"14", ",", "2", ",", 
           RowBox[{"{", 
            RowBox[{
            "999.6961168765796`", ",", "199.8961168765795`", ",", 
             "98.84649905346885`"}], "}"}], ",", "1"}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{"15", ",", "2", ",", 
           RowBox[{"{", 
            RowBox[{
            "999.4118778419023`", ",", "199.61187784190219`", ",", 
             "99.62305453770158`"}], "}"}], ",", "1"}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{"16", ",", "2", ",", 
           RowBox[{"{", 
            RowBox[{
            "1000.7684780693547`", ",", "200.9684780693546`", ",", 
             "98.64688903153453`"}], "}"}], ",", "1"}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{"17", ",", "2", ",", 
           RowBox[{"{", 
            RowBox[{
            "1000.4842390346773`", ",", "200.6842390346773`", ",", 
             "99.42344451576726`"}], "}"}], ",", "1"}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{"18", ",", "2", ",", 
           RowBox[{"{", 
            RowBox[{
            "1000.2`", ",", "200.39999999999998`", ",", 
             "100.19999999999999`"}], "}"}], ",", "1"}], "}"}]}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{"19", ",", "2", ",", 
           RowBox[{"{", 
            RowBox[{
            "998.9079947184819`", ",", "199.1079947184817`", ",", 
             "98.26955359117044`"}], "}"}], ",", "2"}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{"20", ",", "2", ",", 
           RowBox[{"{", 
            RowBox[{
            "998.6237556838046`", ",", "198.8237556838044`", ",", 
             "99.04610907540317`"}], "}"}], ",", "2"}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{"21", ",", "2", ",", 
           RowBox[{"{", 
            RowBox[{
            "998.3395166491272`", ",", "198.53951664912708`", ",", 
             "99.8226645596359`"}], "}"}], ",", "2"}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{"22", ",", "2", ",", 
           RowBox[{"{", 
            RowBox[{
            "999.6961168765796`", ",", "199.8961168765795`", ",", 
             "98.84649905346885`"}], "}"}], ",", "2"}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{"23", ",", "2", ",", 
           RowBox[{"{", 
            RowBox[{
            "999.4118778419023`", ",", "199.61187784190219`", ",", 
             "99.62305453770158`"}], "}"}], ",", "2"}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{"24", ",", "2", ",", 
           RowBox[{"{", 
            RowBox[{
            "999.127638807225`", ",", "199.32763880722487`", ",", 
             "100.39961002193431`"}], "}"}], ",", "2"}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{"25", ",", "2", ",", 
           RowBox[{"{", 
            RowBox[{
            "1000.4842390346774`", ",", "200.6842390346773`", ",", 
             "99.42344451576726`"}], "}"}], ",", "2"}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{"26", ",", "2", ",", 
           RowBox[{"{", 
            RowBox[{
            "1000.2`", ",", "200.39999999999998`", ",", 
             "100.19999999999999`"}], "}"}], ",", "2"}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{"27", ",", "2", ",", 
           RowBox[{"{", 
            RowBox[{
            "999.9157609653228`", ",", "200.11576096532266`", ",", 
             "100.97655548423272`"}], "}"}], ",", "2"}], "}"}]}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{"28", ",", "2", ",", 
           RowBox[{"{", 
            RowBox[{
            "998.6237556838045`", ",", "198.8237556838044`", ",", 
             "99.04610907540317`"}], "}"}], ",", "3"}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{"29", ",", "2", ",", 
           RowBox[{"{", 
            RowBox[{
            "998.3395166491272`", ",", "198.53951664912708`", ",", 
             "99.8226645596359`"}], "}"}], ",", "3"}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{"30", ",", "2", ",", 
           RowBox[{"{", 
            RowBox[{
            "998.0552776144498`", ",", "198.25527761444977`", ",", 
             "100.59922004386863`"}], "}"}], ",", "3"}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{"31", ",", "2", ",", 
           RowBox[{"{", 
            RowBox[{
            "999.4118778419022`", ",", "199.61187784190219`", ",", 
             "99.62305453770158`"}], "}"}], ",", "3"}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{"32", ",", "2", ",", 
           RowBox[{"{", 
            RowBox[{
            "999.1276388072249`", ",", "199.32763880722487`", ",", 
             "100.39961002193431`"}], "}"}], ",", "3"}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{"33", ",", "2", ",", 
           RowBox[{"{", 
            RowBox[{
            "998.8433997725476`", ",", "199.04339977254756`", ",", 
             "101.17616550616704`"}], "}"}], ",", "3"}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{"34", ",", "2", ",", 
           RowBox[{"{", 
            RowBox[{
            "1000.2`", ",", "200.39999999999998`", ",", 
             "100.19999999999999`"}], "}"}], ",", "3"}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{"35", ",", "2", ",", 
           RowBox[{"{", 
            RowBox[{
            "999.9157609653226`", ",", "200.11576096532266`", ",", 
             "100.97655548423272`"}], "}"}], ",", "3"}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{"36", ",", "2", ",", 
           RowBox[{"{", 
            RowBox[{
            "999.6315219306454`", ",", "199.83152193064535`", ",", 
             "101.75311096846545`"}], "}"}], ",", "3"}], "}"}]}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{"37", ",", "2", ",", 
           RowBox[{"{", 
            RowBox[{
            "999.9803559112569`", ",", "200.1803559112568`", ",", 
             "98.06994356923612`"}], "}"}], ",", "4"}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{"38", ",", "2", ",", 
           RowBox[{"{", 
            RowBox[{
            "999.6961168765796`", ",", "199.8961168765795`", ",", 
             "98.84649905346885`"}], "}"}], ",", "4"}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{"39", ",", "2", ",", 
           RowBox[{"{", 
            RowBox[{
            "999.4118778419022`", ",", "199.61187784190219`", ",", 
             "99.62305453770158`"}], "}"}], ",", "4"}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{"40", ",", "2", ",", 
           RowBox[{"{", 
            RowBox[{
            "1000.7684780693546`", ",", "200.9684780693546`", ",", 
             "98.64688903153453`"}], "}"}], ",", "4"}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{"41", ",", "2", ",", 
           RowBox[{"{", 
            RowBox[{
            "1000.4842390346773`", ",", "200.6842390346773`", ",", 
             "99.42344451576726`"}], "}"}], ",", "4"}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{"42", ",", "2", ",", 
           RowBox[{"{", 
            RowBox[{
            "1000.2`", ",", "200.39999999999998`", ",", 
             "100.19999999999999`"}], "}"}], ",", "4"}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{"43", ",", "2", ",", 
           RowBox[{"{", 
            RowBox[{
            "1001.5566002274525`", ",", "201.7566002274524`", ",", 
             "99.22383449383294`"}], "}"}], ",", "4"}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{"44", ",", "2", ",", 
           RowBox[{"{", 
            RowBox[{
            "1001.2723611927751`", ",", "201.47236119277508`", ",", 
             "100.00038997806567`"}], "}"}], ",", "4"}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{"45", ",", "2", ",", 
           RowBox[{"{", 
            RowBox[{
            "1000.9881221580978`", ",", "201.18812215809777`", ",", 
             "100.7769454622984`"}], "}"}], ",", "4"}], "}"}]}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{"46", ",", "2", ",", 
           RowBox[{"{", 
            RowBox[{
            "999.6961168765796`", ",", "199.8961168765795`", ",", 
             "98.84649905346885`"}], "}"}], ",", "5"}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{"47", ",", "2", ",", 
           RowBox[{"{", 
            RowBox[{
            "999.4118778419023`", ",", "199.61187784190219`", ",", 
             "99.62305453770158`"}], "}"}], ",", "5"}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{"48", ",", "2", ",", 
           RowBox[{"{", 
            RowBox[{
            "999.1276388072249`", ",", "199.32763880722487`", ",", 
             "100.39961002193431`"}], "}"}], ",", "5"}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{"49", ",", "2", ",", 
           RowBox[{"{", 
            RowBox[{
            "1000.4842390346773`", ",", "200.6842390346773`", ",", 
             "99.42344451576726`"}], "}"}], ",", "5"}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{"50", ",", "2", ",", 
           RowBox[{"{", 
            RowBox[{
            "1000.2`", ",", "200.39999999999998`", ",", 
             "100.19999999999999`"}], "}"}], ",", "5"}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{"51", ",", "2", ",", 
           RowBox[{"{", 
            RowBox[{
            "999.9157609653228`", ",", "200.11576096532266`", ",", 
             "100.97655548423272`"}], "}"}], ",", "5"}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{"52", ",", "2", ",", 
           RowBox[{"{", 
            RowBox[{
            "1001.2723611927752`", ",", "201.47236119277508`", ",", 
             "100.00038997806567`"}], "}"}], ",", "5"}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{"53", ",", "2", ",", 
           RowBox[{"{", 
            RowBox[{
            "1000.9881221580978`", ",", "201.18812215809777`", ",", 
             "100.7769454622984`"}], "}"}], ",", "5"}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{"54", ",", "2", ",", 
           RowBox[{"{", 
            RowBox[{
            "1000.7038831234205`", ",", "200.90388312342046`", ",", 
             "101.55350094653113`"}], "}"}], ",", "5"}], "}"}]}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{"55", ",", "2", ",", 
           RowBox[{"{", 
            RowBox[{
            "999.4118778419023`", ",", "199.61187784190219`", ",", 
             "99.62305453770158`"}], "}"}], ",", "6"}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{"56", ",", "2", ",", 
           RowBox[{"{", 
            RowBox[{
            "999.127638807225`", ",", "199.32763880722487`", ",", 
             "100.39961002193431`"}], "}"}], ",", "6"}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{"57", ",", "2", ",", 
           RowBox[{"{", 
            RowBox[{
            "998.8433997725476`", ",", "199.04339977254756`", ",", 
             "101.17616550616704`"}], "}"}], ",", "6"}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{"58", ",", "2", ",", 
           RowBox[{"{", 
            RowBox[{
            "1000.2`", ",", "200.39999999999998`", ",", 
             "100.19999999999999`"}], "}"}], ",", "6"}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{"59", ",", "2", ",", 
           RowBox[{"{", 
            RowBox[{
            "999.9157609653228`", ",", "200.11576096532266`", ",", 
             "100.97655548423272`"}], "}"}], ",", "6"}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{"60", ",", "2", ",", 
           RowBox[{"{", 
            RowBox[{
            "999.6315219306455`", ",", "199.83152193064535`", ",", 
             "101.75311096846545`"}], "}"}], ",", "6"}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{"61", ",", "2", ",", 
           RowBox[{"{", 
            RowBox[{
            "1000.9881221580979`", ",", "201.18812215809777`", ",", 
             "100.7769454622984`"}], "}"}], ",", "6"}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{"62", ",", "2", ",", 
           RowBox[{"{", 
            RowBox[{
            "1000.7038831234205`", ",", "200.90388312342046`", ",", 
             "101.55350094653113`"}], "}"}], ",", "6"}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{"63", ",", "2", ",", 
           RowBox[{"{", 
            RowBox[{
            "1000.4196440887432`", ",", "200.61964408874314`", ",", 
             "102.33005643076386`"}], "}"}], ",", "6"}], "}"}]}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{"64", ",", "2", ",", 
           RowBox[{"{", 
            RowBox[{
            "1000.7684780693547`", ",", "200.9684780693546`", ",", 
             "98.64688903153453`"}], "}"}], ",", "7"}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{"65", ",", "2", ",", 
           RowBox[{"{", 
            RowBox[{
            "1000.4842390346774`", ",", "200.6842390346773`", ",", 
             "99.42344451576726`"}], "}"}], ",", "7"}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{"66", ",", "2", ",", 
           RowBox[{"{", 
            RowBox[{
            "1000.2`", ",", "200.39999999999998`", ",", 
             "100.19999999999999`"}], "}"}], ",", "7"}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{"67", ",", "2", ",", 
           RowBox[{"{", 
            RowBox[{
            "1001.5566002274525`", ",", "201.7566002274524`", ",", 
             "99.22383449383294`"}], "}"}], ",", "7"}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{"68", ",", "2", ",", 
           RowBox[{"{", 
            RowBox[{
            "1001.2723611927752`", ",", "201.47236119277508`", ",", 
             "100.00038997806567`"}], "}"}], ",", "7"}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{"69", ",", "2", ",", 
           RowBox[{"{", 
            RowBox[{
            "1000.9881221580979`", ",", "201.18812215809777`", ",", 
             "100.7769454622984`"}], "}"}], ",", "7"}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{"70", ",", "2", ",", 
           RowBox[{"{", 
            RowBox[{
            "1002.3447223855503`", ",", "202.5447223855502`", ",", 
             "99.80077995613135`"}], "}"}], ",", "7"}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{"71", ",", "2", ",", 
           RowBox[{"{", 
            RowBox[{
            "1002.0604833508729`", ",", "202.26048335087287`", ",", 
             "100.57733544036408`"}], "}"}], ",", "7"}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{"72", ",", "2", ",", 
           RowBox[{"{", 
            RowBox[{
            "1001.7762443161956`", ",", "201.97624431619556`", ",", 
             "101.35389092459681`"}], "}"}], ",", "7"}], "}"}]}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{"73", ",", "2", ",", 
           RowBox[{"{", 
            RowBox[{
            "1000.4842390346773`", ",", "200.6842390346773`", ",", 
             "99.42344451576726`"}], "}"}], ",", "8"}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{"74", ",", "2", ",", 
           RowBox[{"{", 
            RowBox[{
            "1000.2`", ",", "200.39999999999998`", ",", 
             "100.19999999999999`"}], "}"}], ",", "8"}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{"75", ",", "2", ",", 
           RowBox[{"{", 
            RowBox[{
            "999.9157609653226`", ",", "200.11576096532266`", ",", 
             "100.97655548423272`"}], "}"}], ",", "8"}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{"76", ",", "2", ",", 
           RowBox[{"{", 
            RowBox[{
            "1001.2723611927751`", ",", "201.47236119277508`", ",", 
             "100.00038997806567`"}], "}"}], ",", "8"}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{"77", ",", "2", ",", 
           RowBox[{"{", 
            RowBox[{
            "1000.9881221580978`", ",", "201.18812215809777`", ",", 
             "100.7769454622984`"}], "}"}], ",", "8"}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{"78", ",", "2", ",", 
           RowBox[{"{", 
            RowBox[{
            "1000.7038831234205`", ",", "200.90388312342046`", ",", 
             "101.55350094653113`"}], "}"}], ",", "8"}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{"79", ",", "2", ",", 
           RowBox[{"{", 
            RowBox[{
            "1002.0604833508729`", ",", "202.26048335087287`", ",", 
             "100.57733544036408`"}], "}"}], ",", "8"}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{"80", ",", "2", ",", 
           RowBox[{"{", 
            RowBox[{
            "1001.7762443161955`", ",", "201.97624431619556`", ",", 
             "101.35389092459681`"}], "}"}], ",", "8"}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{"81", ",", "2", ",", 
           RowBox[{"{", 
            RowBox[{
            "1001.4920052815182`", ",", "201.69200528151825`", ",", 
             "102.13044640882954`"}], "}"}], ",", "8"}], "}"}]}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{"82", ",", "2", ",", 
           RowBox[{"{", 
            RowBox[{
            "1000.2`", ",", "200.39999999999998`", ",", 
             "100.19999999999999`"}], "}"}], ",", "9"}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{"83", ",", "2", ",", 
           RowBox[{"{", 
            RowBox[{
            "999.9157609653228`", ",", "200.11576096532266`", ",", 
             "100.97655548423272`"}], "}"}], ",", "9"}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{"84", ",", "2", ",", 
           RowBox[{"{", 
            RowBox[{
            "999.6315219306454`", ",", "199.83152193064535`", ",", 
             "101.75311096846545`"}], "}"}], ",", "9"}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{"85", ",", "2", ",", 
           RowBox[{"{", 
            RowBox[{
            "1000.9881221580978`", ",", "201.18812215809777`", ",", 
             "100.7769454622984`"}], "}"}], ",", "9"}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{"86", ",", "2", ",", 
           RowBox[{"{", 
            RowBox[{
            "1000.7038831234205`", ",", "200.90388312342046`", ",", 
             "101.55350094653113`"}], "}"}], ",", "9"}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{"87", ",", "2", ",", 
           RowBox[{"{", 
            RowBox[{
            "1000.4196440887432`", ",", "200.61964408874314`", ",", 
             "102.33005643076386`"}], "}"}], ",", "9"}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{"88", ",", "2", ",", 
           RowBox[{"{", 
            RowBox[{
            "1001.7762443161956`", ",", "201.97624431619556`", ",", 
             "101.35389092459681`"}], "}"}], ",", "9"}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{"89", ",", "2", ",", 
           RowBox[{"{", 
            RowBox[{
            "1001.4920052815182`", ",", "201.69200528151825`", ",", 
             "102.13044640882954`"}], "}"}], ",", "9"}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{"90", ",", "2", ",", 
           RowBox[{"{", 
            RowBox[{
            "1001.207766246841`", ",", "201.40776624684094`", ",", 
             "102.90700189306227`"}], "}"}], ",", "9"}], "}"}]}], "}"}]}], 
      "}"}]}], "}"}]}], "}"}]], "Output"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"Timing", "[", 
  RowBox[{"tree1", "=", 
   RowBox[{"GenerateTree", "[", 
    RowBox[{
     RowBox[{"FromDistributionTree", "[", 
      RowBox[{
       RowBox[{"{", "\"\<equity\>\"", "}"}], ",", 
       RowBox[{"{", "1000", "}"}], ",", 
       RowBox[{"{", "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{
           RowBox[{"StudentTDistributionD", "[", "1.1", "]"}], ",", "1", ",", 
           "3"}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{"StudentTDistributionD", "[", "1.1", "]"}], ",", "1", ",", 
           "2"}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{"StudentTDistributionD", "[", "1.1", "]"}], ",", "1", ",", 
           "2"}], "}"}]}], "\[IndentingNewLine]", "}"}]}], "]"}], ",", "0"}], 
    "]"}]}], "]"}]], "Input"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{"0.19099999999999984`", " ", "Second"}], ",", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"{", 
       RowBox[{"{", 
        RowBox[{"0", ",", "0", ",", 
         RowBox[{"{", "1000", "}"}], ",", "0"}], "}"}], "}"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{"1", ",", "1", ",", 
          RowBox[{"{", "998.3694437159784`", "}"}], ",", "0"}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{"2", ",", "1", ",", 
          RowBox[{"{", "1000", "}"}], ",", "0"}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{"3", ",", "1", ",", 
          RowBox[{"{", "1001.6305562840216`", "}"}], ",", "0"}], "}"}]}], 
       "}"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{"4", ",", "2", ",", 
           RowBox[{"{", "997.4063773943462`", "}"}], ",", "1"}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{"5", ",", "2", ",", 
           RowBox[{"{", "999.3325100376105`", "}"}], ",", "1"}], "}"}]}], 
        "}"}], ",", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{"6", ",", "2", ",", 
           RowBox[{"{", "999.0369336783679`", "}"}], ",", "2"}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{"7", ",", "2", ",", 
           RowBox[{"{", "1000.9630663216321`", "}"}], ",", "2"}], "}"}]}], 
        "}"}], ",", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{"8", ",", "2", ",", 
           RowBox[{"{", "1000.6674899623895`", "}"}], ",", "3"}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{"9", ",", "2", ",", 
           RowBox[{"{", "1002.5936226056538`", "}"}], ",", "3"}], "}"}]}], 
        "}"}]}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{"10", ",", "3", ",", 
           RowBox[{"{", "996.4433110727141`", "}"}], ",", "4"}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{"11", ",", "3", ",", 
           RowBox[{"{", "998.3694437159784`", "}"}], ",", "4"}], "}"}]}], 
        "}"}], ",", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{"12", ",", "3", ",", 
           RowBox[{"{", "998.3694437159784`", "}"}], ",", "5"}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{"13", ",", "3", ",", 
           RowBox[{"{", "1000.2955763592427`", "}"}], ",", "5"}], "}"}]}], 
        "}"}], ",", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{"14", ",", "3", ",", 
           RowBox[{"{", "998.0738673567357`", "}"}], ",", "6"}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{"15", ",", "3", ",", 
           RowBox[{"{", "1000.`", "}"}], ",", "6"}], "}"}]}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{"16", ",", "3", ",", 
           RowBox[{"{", "1000.`", "}"}], ",", "7"}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{"17", ",", "3", ",", 
           RowBox[{"{", "1001.9261326432643`", "}"}], ",", "7"}], "}"}]}], 
        "}"}], ",", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{"18", ",", "3", ",", 
           RowBox[{"{", "999.7044236407573`", "}"}], ",", "8"}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{"19", ",", "3", ",", 
           RowBox[{"{", "1001.6305562840216`", "}"}], ",", "8"}], "}"}]}], 
        "}"}], ",", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{"20", ",", "3", ",", 
           RowBox[{"{", "1001.6305562840216`", "}"}], ",", "9"}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{"21", ",", "3", ",", 
           RowBox[{"{", "1003.5566889272859`", "}"}], ",", "9"}], "}"}]}], 
        "}"}]}], "}"}]}], "}"}]}], "}"}]], "Output"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"Timing", "[", 
  RowBox[{"tree1", "=", 
   RowBox[{"MCGeneratePath", "[", 
    RowBox[{
     RowBox[{"OrthogonalCombineSpaces", "[", 
      RowBox[{"{", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"FromDistributionTree", "[", 
         RowBox[{
          RowBox[{"{", "\"\<equity\>\"", "}"}], ",", 
          RowBox[{"{", "100", "}"}], ",", 
          RowBox[{"{", 
           RowBox[{
            RowBox[{"{", 
             RowBox[{
              RowBox[{"StudentTDistributionD", "[", "1.1", "]"}], ",", "1", 
              ",", "3"}], "}"}], ",", 
            RowBox[{"{", 
             RowBox[{
              RowBox[{"StudentTDistributionD", "[", "1.1", "]"}], ",", "1", 
              ",", "3"}], "}"}]}], "}"}]}], "]"}], ",", "\[IndentingNewLine]", 
        RowBox[{"FromDistributionTree", "[", 
         RowBox[{
          RowBox[{"{", "\"\<IR\>\"", "}"}], ",", 
          RowBox[{"{", "200", "}"}], ",", 
          RowBox[{"{", 
           RowBox[{
            RowBox[{"{", 
             RowBox[{
              RowBox[{"StudentTDistributionD", "[", "1.1", "]"}], ",", "1", 
              ",", "2"}], "}"}], ",", 
            RowBox[{"{", 
             RowBox[{
              RowBox[{"StudentTDistributionD", "[", "1.1", "]"}], ",", "1", 
              ",", "2"}], "}"}]}], "}"}]}], "]"}]}], "\[IndentingNewLine]", 
       "}"}], "]"}], ",", "0"}], "]"}]}], "]"}]], "Input"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{"0.03999999999999915`", " ", "Second"}], ",", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"0", ",", "0", ",", 
       RowBox[{"{", 
        RowBox[{"100", ",", "200"}], "}"}], ",", "0"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"1", ",", "1", ",", 
       RowBox[{"{", 
        RowBox[{"101.63055628402161`", ",", "199.03693367836783`"}], "}"}], 
       ",", "0"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"2", ",", "2", ",", 
       RowBox[{"{", 
        RowBox[{"100.`", ",", "198.07386735673566`"}], "}"}], ",", "1"}], 
      "}"}]}], "}"}]}], "}"}]], "Output"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"Timing", "[", 
  RowBox[{
   RowBox[{"tree1", "=", 
    RowBox[{"GenerateTree", "[", 
     RowBox[{
      RowBox[{"OrthogonalCombineSpaces", "[", 
       RowBox[{"{", "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"FromDistributionTree", "[", 
          RowBox[{
           RowBox[{"{", "\"\<equity\>\"", "}"}], ",", 
           RowBox[{"{", "100", "}"}], ",", 
           RowBox[{"{", 
            RowBox[{
             RowBox[{"{", 
              RowBox[{
               RowBox[{"StudentTDistributionD", "[", "1.1", "]"}], ",", "1", 
               ",", "3"}], "}"}], ",", 
             RowBox[{"{", 
              RowBox[{
               RowBox[{"StudentTDistributionD", "[", "1.1", "]"}], ",", "1", 
               ",", "3"}], "}"}]}], "}"}]}], "]"}], ",", 
         "\[IndentingNewLine]", 
         RowBox[{"FromDistributionTree", "[", 
          RowBox[{
           RowBox[{"{", "\"\<IR\>\"", "}"}], ",", 
           RowBox[{"{", "200", "}"}], ",", 
           RowBox[{"{", 
            RowBox[{
             RowBox[{"{", 
              RowBox[{
               RowBox[{"StudentTDistributionD", "[", "1.1", "]"}], ",", "1", 
               ",", "2"}], "}"}], ",", 
             RowBox[{"{", 
              RowBox[{
               RowBox[{"StudentTDistributionD", "[", "1.1", "]"}], ",", "1", 
               ",", "2"}], "}"}]}], "}"}]}], "]"}]}], "\[IndentingNewLine]", 
        "}"}], "]"}], ",", "0"}], "]"}]}], ";", 
   RowBox[{"Print", "[", 
    RowBox[{
     RowBox[{"ToString", "[", 
      RowBox[{
       RowBox[{"Length", "[", "tree1", "]"}], "-", "1"}], "]"}], "<>", 
     "\"\< stages \>\"", " ", "<>", " ", 
     RowBox[{"ToString", "[", 
      RowBox[{"Length", "[", 
       RowBox[{"Flatten", "[", 
        RowBox[{"tree1", ",", "2"}], "]"}], "]"}], "]"}], "<>", 
     "\"\< nodes\>\""}], "]"}], ";", 
   RowBox[{"Print", "[", "tree1", "]"}]}], "]"}]], "Input"],

Cell[CellGroupData[{

Cell[BoxData["\<\"2 stages 43 nodes\"\>"], "Print"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{"{", 
    RowBox[{"{", 
     RowBox[{"{", 
      RowBox[{"0", ",", "0", ",", 
       RowBox[{"{", 
        RowBox[{"100", ",", "200"}], "}"}], ",", "0"}], "}"}], "}"}], "}"}], 
   ",", 
   RowBox[{"{", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"1", ",", "1", ",", 
        RowBox[{"{", 
         RowBox[{"98.36944371597839`", ",", "199.03693367836783`"}], "}"}], 
        ",", "0"}], "}"}], ",", 
      RowBox[{"{", 
       RowBox[{"2", ",", "1", ",", 
        RowBox[{"{", 
         RowBox[{"98.36944371597839`", ",", "200.96306632163217`"}], "}"}], 
        ",", "0"}], "}"}], ",", 
      RowBox[{"{", 
       RowBox[{"3", ",", "1", ",", 
        RowBox[{"{", 
         RowBox[{"100", ",", "199.03693367836783`"}], "}"}], ",", "0"}], 
       "}"}], ",", 
      RowBox[{"{", 
       RowBox[{"4", ",", "1", ",", 
        RowBox[{"{", 
         RowBox[{"100", ",", "200.96306632163217`"}], "}"}], ",", "0"}], 
       "}"}], ",", 
      RowBox[{"{", 
       RowBox[{"5", ",", "1", ",", 
        RowBox[{"{", 
         RowBox[{"101.63055628402161`", ",", "199.03693367836783`"}], "}"}], 
        ",", "0"}], "}"}], ",", 
      RowBox[{"{", 
       RowBox[{"6", ",", "1", ",", 
        RowBox[{"{", 
         RowBox[{"101.63055628402161`", ",", "200.96306632163217`"}], "}"}], 
        ",", "0"}], "}"}]}], "}"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"7", ",", "2", ",", 
         RowBox[{"{", 
          RowBox[{"96.73888743195678`", ",", "198.07386735673566`"}], "}"}], 
         ",", "1"}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"8", ",", "2", ",", 
         RowBox[{"{", 
          RowBox[{"96.73888743195678`", ",", "200.`"}], "}"}], ",", "1"}], 
        "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"9", ",", "2", ",", 
         RowBox[{"{", 
          RowBox[{"98.36944371597839`", ",", "198.07386735673566`"}], "}"}], 
         ",", "1"}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"10", ",", "2", ",", 
         RowBox[{"{", 
          RowBox[{"98.36944371597839`", ",", "200.`"}], "}"}], ",", "1"}], 
        "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"11", ",", "2", ",", 
         RowBox[{"{", 
          RowBox[{"100.`", ",", "198.07386735673566`"}], "}"}], ",", "1"}], 
        "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"12", ",", "2", ",", 
         RowBox[{"{", 
          RowBox[{"100.`", ",", "200.`"}], "}"}], ",", "1"}], "}"}]}], "}"}], 
     ",", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"13", ",", "2", ",", 
         RowBox[{"{", 
          RowBox[{"96.73888743195678`", ",", "200.`"}], "}"}], ",", "2"}], 
        "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"14", ",", "2", ",", 
         RowBox[{"{", 
          RowBox[{"96.73888743195678`", ",", "201.92613264326434`"}], "}"}], 
         ",", "2"}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"15", ",", "2", ",", 
         RowBox[{"{", 
          RowBox[{"98.36944371597839`", ",", "200.`"}], "}"}], ",", "2"}], 
        "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"16", ",", "2", ",", 
         RowBox[{"{", 
          RowBox[{"98.36944371597839`", ",", "201.92613264326434`"}], "}"}], 
         ",", "2"}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"17", ",", "2", ",", 
         RowBox[{"{", 
          RowBox[{"100.`", ",", "200.`"}], "}"}], ",", "2"}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"18", ",", "2", ",", 
         RowBox[{"{", 
          RowBox[{"100.`", ",", "201.92613264326434`"}], "}"}], ",", "2"}], 
        "}"}]}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"19", ",", "2", ",", 
         RowBox[{"{", 
          RowBox[{"98.36944371597839`", ",", "198.07386735673566`"}], "}"}], 
         ",", "3"}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"20", ",", "2", ",", 
         RowBox[{"{", 
          RowBox[{"98.36944371597839`", ",", "200.`"}], "}"}], ",", "3"}], 
        "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"21", ",", "2", ",", 
         RowBox[{"{", 
          RowBox[{"100", ",", "198.07386735673566`"}], "}"}], ",", "3"}], 
        "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"22", ",", "2", ",", 
         RowBox[{"{", 
          RowBox[{"100", ",", "200.`"}], "}"}], ",", "3"}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"23", ",", "2", ",", 
         RowBox[{"{", 
          RowBox[{"101.63055628402161`", ",", "198.07386735673566`"}], "}"}], 
         ",", "3"}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"24", ",", "2", ",", 
         RowBox[{"{", 
          RowBox[{"101.63055628402161`", ",", "200.`"}], "}"}], ",", "3"}], 
        "}"}]}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"25", ",", "2", ",", 
         RowBox[{"{", 
          RowBox[{"98.36944371597839`", ",", "200.`"}], "}"}], ",", "4"}], 
        "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"26", ",", "2", ",", 
         RowBox[{"{", 
          RowBox[{"98.36944371597839`", ",", "201.92613264326434`"}], "}"}], 
         ",", "4"}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"27", ",", "2", ",", 
         RowBox[{"{", 
          RowBox[{"100", ",", "200.`"}], "}"}], ",", "4"}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"28", ",", "2", ",", 
         RowBox[{"{", 
          RowBox[{"100", ",", "201.92613264326434`"}], "}"}], ",", "4"}], 
        "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"29", ",", "2", ",", 
         RowBox[{"{", 
          RowBox[{"101.63055628402161`", ",", "200.`"}], "}"}], ",", "4"}], 
        "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"30", ",", "2", ",", 
         RowBox[{"{", 
          RowBox[{"101.63055628402161`", ",", "201.92613264326434`"}], "}"}], 
         ",", "4"}], "}"}]}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"31", ",", "2", ",", 
         RowBox[{"{", 
          RowBox[{"100.`", ",", "198.07386735673566`"}], "}"}], ",", "5"}], 
        "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"32", ",", "2", ",", 
         RowBox[{"{", 
          RowBox[{"100.`", ",", "200.`"}], "}"}], ",", "5"}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"33", ",", "2", ",", 
         RowBox[{"{", 
          RowBox[{"101.63055628402161`", ",", "198.07386735673566`"}], "}"}], 
         ",", "5"}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"34", ",", "2", ",", 
         RowBox[{"{", 
          RowBox[{"101.63055628402161`", ",", "200.`"}], "}"}], ",", "5"}], 
        "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"35", ",", "2", ",", 
         RowBox[{"{", 
          RowBox[{"103.26111256804322`", ",", "198.07386735673566`"}], "}"}], 
         ",", "5"}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"36", ",", "2", ",", 
         RowBox[{"{", 
          RowBox[{"103.26111256804322`", ",", "200.`"}], "}"}], ",", "5"}], 
        "}"}]}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"37", ",", "2", ",", 
         RowBox[{"{", 
          RowBox[{"100.`", ",", "200.`"}], "}"}], ",", "6"}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"38", ",", "2", ",", 
         RowBox[{"{", 
          RowBox[{"100.`", ",", "201.92613264326434`"}], "}"}], ",", "6"}], 
        "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"39", ",", "2", ",", 
         RowBox[{"{", 
          RowBox[{"101.63055628402161`", ",", "200.`"}], "}"}], ",", "6"}], 
        "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"40", ",", "2", ",", 
         RowBox[{"{", 
          RowBox[{"101.63055628402161`", ",", "201.92613264326434`"}], "}"}], 
         ",", "6"}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"41", ",", "2", ",", 
         RowBox[{"{", 
          RowBox[{"103.26111256804322`", ",", "200.`"}], "}"}], ",", "6"}], 
        "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"42", ",", "2", ",", 
         RowBox[{"{", 
          RowBox[{"103.26111256804322`", ",", "201.92613264326434`"}], "}"}], 
         ",", "6"}], "}"}]}], "}"}]}], "}"}]}], "}"}]], "Print"]
}, Open  ]],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{"0.2110000000000003`", " ", "Second"}], ",", "Null"}], 
  "}"}]], "Output"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"Timing", "[", 
  RowBox[{
   RowBox[{"tree1", "=", 
    RowBox[{"GenerateTree", "[", 
     RowBox[{
      RowBox[{"OrthogonalCombineSpaces", "[", 
       RowBox[{"{", "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"FromDistributionTree", "[", 
          RowBox[{
           RowBox[{"{", "\"\<equity\>\"", "}"}], ",", 
           RowBox[{"{", "100", "}"}], ",", 
           RowBox[{"{", 
            RowBox[{
             RowBox[{"{", 
              RowBox[{
               RowBox[{"StudentTDistributionD", "[", "1.1", "]"}], ",", "1", 
               ",", "3"}], "}"}], ",", 
             RowBox[{"{", 
              RowBox[{
               RowBox[{"StudentTDistributionD", "[", "1.1", "]"}], ",", "1", 
               ",", "3"}], "}"}]}], "}"}]}], "]"}], ",", 
         "\[IndentingNewLine]", 
         RowBox[{"FromDistributionTree", "[", 
          RowBox[{
           RowBox[{"{", "\"\<IR\>\"", "}"}], ",", 
           RowBox[{"{", "200", "}"}], ",", 
           RowBox[{"{", 
            RowBox[{
             RowBox[{"{", 
              RowBox[{
               RowBox[{"StudentTDistributionD", "[", "1.1", "]"}], ",", "1", 
               ",", "2"}], "}"}], ",", 
             RowBox[{"{", 
              RowBox[{
               RowBox[{"StudentTDistributionD", "[", "1.1", "]"}], ",", "1", 
               ",", "2"}], "}"}]}], "}"}]}], "]"}], ",", 
         "\[IndentingNewLine]", 
         RowBox[{"FromDistributionTree", "[", 
          RowBox[{
           RowBox[{"{", "\"\<CreditSpread\>\"", "}"}], ",", 
           RowBox[{"{", "1", "}"}], ",", 
           RowBox[{"{", 
            RowBox[{
             RowBox[{"{", 
              RowBox[{
               RowBox[{"StudentTDistributionD", "[", "1.1", "]"}], ",", "1", 
               ",", "2"}], "}"}], ",", 
             RowBox[{"{", 
              RowBox[{
               RowBox[{"StudentTDistributionD", "[", "1.1", "]"}], ",", "1", 
               ",", "2"}], "}"}]}], "}"}]}], "]"}]}], "\[IndentingNewLine]", 
        "}"}], "]"}], ",", "0"}], "]"}]}], ";", 
   RowBox[{"Print", "[", 
    RowBox[{
     RowBox[{"ToString", "[", 
      RowBox[{
       RowBox[{"Length", "[", "tree1", "]"}], "-", "1"}], "]"}], "<>", 
     "\"\< stages \>\"", " ", "<>", " ", 
     RowBox[{"ToString", "[", 
      RowBox[{"Length", "[", 
       RowBox[{"Flatten", "[", 
        RowBox[{"tree1", ",", "2"}], "]"}], "]"}], "]"}], "<>", 
     "\"\< nodes\>\""}], "]"}], ";", 
   RowBox[{"Print", "[", "tree1", "]"}]}], "]"}]], "Input"],

Cell[BoxData["\<\"2 stages 157 nodes\"\>"], "Print"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{"0.48099999999999987`", " ", "Second"}], ",", "Null"}], 
  "}"}]], "Output"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"Timing", "[", 
  RowBox[{"tree1", "=", 
   RowBox[{"MCGeneratePath", "[", 
    RowBox[{
     RowBox[{"NormalRankCombineSpaces", "[", 
      RowBox[{
       RowBox[{"{", "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"FromDistributionTree", "[", 
          RowBox[{
           RowBox[{"{", "\"\<equity\>\"", "}"}], ",", 
           RowBox[{"{", "100", "}"}], ",", 
           RowBox[{"{", 
            RowBox[{
             RowBox[{"{", 
              RowBox[{
               RowBox[{"StudentTDistributionD", "[", "1.1", "]"}], ",", "1", 
               ",", "3"}], "}"}], ",", 
             RowBox[{"{", 
              RowBox[{
               RowBox[{"StudentTDistributionD", "[", "1.1", "]"}], ",", "1", 
               ",", "3"}], "}"}]}], "}"}]}], "]"}], ",", 
         "\[IndentingNewLine]", 
         RowBox[{"FromDistributionTree", "[", 
          RowBox[{
           RowBox[{"{", "\"\<IR\>\"", "}"}], ",", 
           RowBox[{"{", "200", "}"}], ",", 
           RowBox[{"{", 
            RowBox[{
             RowBox[{"{", 
              RowBox[{
               RowBox[{"StudentTDistributionD", "[", "1.1", "]"}], ",", "1", 
               ",", "2"}], "}"}], ",", 
             RowBox[{"{", 
              RowBox[{
               RowBox[{"StudentTDistributionD", "[", "1.1", "]"}], ",", "1", 
               ",", "2"}], "}"}]}], "}"}]}], "]"}], ",", 
         "\[IndentingNewLine]", 
         RowBox[{"FromDistributionTree", "[", 
          RowBox[{
           RowBox[{"{", "\"\<CreditSpread\>\"", "}"}], ",", 
           RowBox[{"{", "100", "}"}], ",", 
           RowBox[{"{", 
            RowBox[{
             RowBox[{"{", 
              RowBox[{
               RowBox[{"StudentTDistributionD", "[", "1.1", "]"}], ",", "1", 
               ",", "2"}], "}"}], ",", 
             RowBox[{"{", 
              RowBox[{
               RowBox[{"StudentTDistributionD", "[", "1.1", "]"}], ",", "1", 
               ",", "2"}], "}"}]}], "}"}]}], "]"}]}], "\[IndentingNewLine]", 
        "}"}], ",", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{"1", ",", "0.5", ",", "0.25"}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{"0.5", ",", "1", ",", "0.25"}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{"0.25", ",", "0.25", ",", "1"}], "}"}]}], "}"}]}], "]"}], 
     ",", "\[IndentingNewLine]", "0"}], "]"}]}], "]"}]], "Input"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{"0.1599999999999966`", " ", "Second"}], ",", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"0", ",", "0", ",", 
       RowBox[{"{", 
        RowBox[{"100", ",", "200", ",", "100"}], "}"}], ",", "0"}], "}"}], 
     ",", 
     RowBox[{"{", 
      RowBox[{"1", ",", "1", ",", 
       RowBox[{"{", 
        RowBox[{
        "102.17540049849244`", ",", "200.64665965337105`", ",", 
         "99.08956070401538`"}], "}"}], ",", "0"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"2", ",", "2", ",", 
       RowBox[{"{", 
        RowBox[{
        "97.69652401962344`", ",", "199.98691902709024`", ",", 
         "98.12649438238321`"}], "}"}], ",", "1"}], "}"}]}], "}"}]}], 
  "}"}]], "Output"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"Timing", "[", 
  RowBox[{
   RowBox[{"tree1", "=", 
    RowBox[{"GenerateTree", "[", 
     RowBox[{
      RowBox[{"NormalRankCombineSpaces", "[", 
       RowBox[{
        RowBox[{"{", "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{"FromDistributionTree", "[", 
           RowBox[{
            RowBox[{"{", "\"\<equity\>\"", "}"}], ",", 
            RowBox[{"{", "100", "}"}], ",", 
            RowBox[{"{", 
             RowBox[{
              RowBox[{"{", 
               RowBox[{
                RowBox[{"StudentTDistributionD", "[", "1.1", "]"}], ",", "1", 
                ",", "3"}], "}"}], ",", 
              RowBox[{"{", 
               RowBox[{
                RowBox[{"StudentTDistributionD", "[", "1.1", "]"}], ",", "1", 
                ",", "3"}], "}"}]}], "}"}]}], "]"}], ",", 
          "\[IndentingNewLine]", 
          RowBox[{"FromDistributionTree", "[", 
           RowBox[{
            RowBox[{"{", "\"\<IR\>\"", "}"}], ",", 
            RowBox[{"{", "200", "}"}], ",", 
            RowBox[{"{", 
             RowBox[{
              RowBox[{"{", 
               RowBox[{
                RowBox[{"StudentTDistributionD", "[", "1.1", "]"}], ",", "1", 
                ",", "2"}], "}"}], ",", 
              RowBox[{"{", 
               RowBox[{
                RowBox[{"StudentTDistributionD", "[", "1.1", "]"}], ",", "1", 
                ",", "2"}], "}"}]}], "}"}]}], "]"}], ",", 
          "\[IndentingNewLine]", 
          RowBox[{"FromDistributionTree", "[", 
           RowBox[{
            RowBox[{"{", "\"\<CreditSpread\>\"", "}"}], ",", 
            RowBox[{"{", "100", "}"}], ",", 
            RowBox[{"{", 
             RowBox[{
              RowBox[{"{", 
               RowBox[{
                RowBox[{"StudentTDistributionD", "[", "1.1", "]"}], ",", "1", 
                ",", "2"}], "}"}], ",", 
              RowBox[{"{", 
               RowBox[{
                RowBox[{"StudentTDistributionD", "[", "1.1", "]"}], ",", "1", 
                ",", "2"}], "}"}]}], "}"}]}], "]"}]}], "\[IndentingNewLine]", 
         "}"}], ",", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{"{", 
           RowBox[{"1", ",", "0.5", ",", "0.25"}], "}"}], ",", 
          RowBox[{"{", 
           RowBox[{"0.5", ",", "1", ",", "0.25"}], "}"}], ",", 
          RowBox[{"{", 
           RowBox[{"0.25", ",", "0.25", ",", "1"}], "}"}]}], "}"}]}], "]"}], 
      ",", "\[IndentingNewLine]", "0"}], "]"}]}], ";", 
   RowBox[{"Print", "[", 
    RowBox[{
     RowBox[{"ToString", "[", 
      RowBox[{
       RowBox[{"Length", "[", "tree1", "]"}], "-", "1"}], "]"}], "<>", 
     "\"\< stages \>\"", " ", "<>", " ", 
     RowBox[{"ToString", "[", 
      RowBox[{"Length", "[", 
       RowBox[{"Flatten", "[", 
        RowBox[{"tree1", ",", "2"}], "]"}], "]"}], "]"}], "<>", 
     "\"\< nodes\>\""}], "]"}], ";", 
   RowBox[{"Print", "[", "tree1", "]"}]}], "]"}]], "Input"],

Cell[BoxData["\<\"2 stages 157 nodes\"\>"], "Print"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{"7.891`", " ", "Second"}], ",", "Null"}], "}"}]], "Output"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"x", "=", 
  RowBox[{"CompileProcess", "[", 
   RowBox[{"FromProcessTree", "[", 
    RowBox[{
     RowBox[{"{", "\"\<Equity\>\"", "}"}], ",", 
     RowBox[{"NormalProcess", "[", 
      RowBox[{"1", ",", "2"}], "]"}], ",", 
     RowBox[{"{", 
      RowBox[{"1", ",", "1", ",", "1", ",", "1", ",", "1"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"2", ",", "2", ",", "2", ",", "2", ",", "2"}], "}"}], ",", 
     RowBox[{"{", "100", "}"}]}], "]"}], "]"}]}]], "Input"],

Cell[BoxData[
 RowBox[{"FromDistributionTree", "[", 
  RowBox[{
   RowBox[{"{", "\<\"Equity\"\>", "}"}], ",", 
   RowBox[{"{", "100", "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
       RowBox[{"NormalDistributionD", "[", 
        RowBox[{"1", ",", "2"}], "]"}], ",", "1", ",", "2"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"NormalDistributionD", "[", 
        RowBox[{"1", ",", "2"}], "]"}], ",", "1", ",", "2"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"NormalDistributionD", "[", 
        RowBox[{"1", ",", "2"}], "]"}], ",", "1", ",", "2"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"NormalDistributionD", "[", 
        RowBox[{"1", ",", "2"}], "]"}], ",", "1", ",", "2"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"NormalDistributionD", "[", 
        RowBox[{"1", ",", "2"}], "]"}], ",", "1", ",", "2"}], "}"}]}], 
    "}"}]}], "]"}]], "Output"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"N", "[", 
  RowBox[{"GenerateTree", "[", 
   RowBox[{"x", ",", "0"}], "]"}], "]"}]], "Input"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{"{", 
    RowBox[{"{", 
     RowBox[{"{", 
      RowBox[{"0.`", ",", "0.`", ",", 
       RowBox[{"{", "100.`", "}"}], ",", "0.`"}], "}"}], "}"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"1.`", ",", "1.`", ",", 
        RowBox[{"{", "99.65102049960784`", "}"}], ",", "0.`"}], "}"}], ",", 
      RowBox[{"{", 
       RowBox[{"2.`", ",", "1.`", ",", 
        RowBox[{"{", "102.34897950039216`", "}"}], ",", "0.`"}], "}"}]}], 
     "}"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"3.`", ",", "2.`", ",", 
         RowBox[{"{", "99.30204099921568`", "}"}], ",", "1.`"}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"4.`", ",", "2.`", ",", 
         RowBox[{"{", "102.`", "}"}], ",", "1.`"}], "}"}]}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"5.`", ",", "2.`", ",", 
         RowBox[{"{", "102.`", "}"}], ",", "2.`"}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"6.`", ",", "2.`", ",", 
         RowBox[{"{", "104.69795900078432`", "}"}], ",", "2.`"}], "}"}]}], 
      "}"}]}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"7.`", ",", "3.`", ",", 
         RowBox[{"{", "98.95306149882352`", "}"}], ",", "3.`"}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"8.`", ",", "3.`", ",", 
         RowBox[{"{", "101.65102049960784`", "}"}], ",", "3.`"}], "}"}]}], 
      "}"}], ",", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"9.`", ",", "3.`", ",", 
         RowBox[{"{", "101.65102049960784`", "}"}], ",", "4.`"}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"10.`", ",", "3.`", ",", 
         RowBox[{"{", "104.34897950039216`", "}"}], ",", "4.`"}], "}"}]}], 
      "}"}], ",", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"11.`", ",", "3.`", ",", 
         RowBox[{"{", "101.65102049960784`", "}"}], ",", "5.`"}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"12.`", ",", "3.`", ",", 
         RowBox[{"{", "104.34897950039216`", "}"}], ",", "5.`"}], "}"}]}], 
      "}"}], ",", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"13.`", ",", "3.`", ",", 
         RowBox[{"{", "104.34897950039216`", "}"}], ",", "6.`"}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"14.`", ",", "3.`", ",", 
         RowBox[{"{", "107.04693850117648`", "}"}], ",", "6.`"}], "}"}]}], 
      "}"}]}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"15.`", ",", "4.`", ",", 
         RowBox[{"{", "98.60408199843134`", "}"}], ",", "7.`"}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"16.`", ",", "4.`", ",", 
         RowBox[{"{", "101.30204099921568`", "}"}], ",", "7.`"}], "}"}]}], 
      "}"}], ",", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"17.`", ",", "4.`", ",", 
         RowBox[{"{", "101.30204099921568`", "}"}], ",", "8.`"}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"18.`", ",", "4.`", ",", 
         RowBox[{"{", "104.`", "}"}], ",", "8.`"}], "}"}]}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"19.`", ",", "4.`", ",", 
         RowBox[{"{", "101.30204099921568`", "}"}], ",", "9.`"}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"20.`", ",", "4.`", ",", 
         RowBox[{"{", "104.`", "}"}], ",", "9.`"}], "}"}]}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"21.`", ",", "4.`", ",", 
         RowBox[{"{", "104.`", "}"}], ",", "10.`"}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"22.`", ",", "4.`", ",", 
         RowBox[{"{", "106.69795900078432`", "}"}], ",", "10.`"}], "}"}]}], 
      "}"}], ",", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"23.`", ",", "4.`", ",", 
         RowBox[{"{", "101.30204099921568`", "}"}], ",", "11.`"}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"24.`", ",", "4.`", ",", 
         RowBox[{"{", "104.`", "}"}], ",", "11.`"}], "}"}]}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"25.`", ",", "4.`", ",", 
         RowBox[{"{", "104.`", "}"}], ",", "12.`"}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"26.`", ",", "4.`", ",", 
         RowBox[{"{", "106.69795900078432`", "}"}], ",", "12.`"}], "}"}]}], 
      "}"}], ",", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"27.`", ",", "4.`", ",", 
         RowBox[{"{", "104.`", "}"}], ",", "13.`"}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"28.`", ",", "4.`", ",", 
         RowBox[{"{", "106.69795900078432`", "}"}], ",", "13.`"}], "}"}]}], 
      "}"}], ",", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"29.`", ",", "4.`", ",", 
         RowBox[{"{", "106.69795900078432`", "}"}], ",", "14.`"}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"30.`", ",", "4.`", ",", 
         RowBox[{"{", "109.39591800156866`", "}"}], ",", "14.`"}], "}"}]}], 
      "}"}]}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"31.`", ",", "5.`", ",", 
         RowBox[{"{", "98.25510249803918`", "}"}], ",", "15.`"}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"32.`", ",", "5.`", ",", 
         RowBox[{"{", "100.9530614988235`", "}"}], ",", "15.`"}], "}"}]}], 
      "}"}], ",", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"33.`", ",", "5.`", ",", 
         RowBox[{"{", "100.9530614988235`", "}"}], ",", "16.`"}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"34.`", ",", "5.`", ",", 
         RowBox[{"{", "103.65102049960784`", "}"}], ",", "16.`"}], "}"}]}], 
      "}"}], ",", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"35.`", ",", "5.`", ",", 
         RowBox[{"{", "100.9530614988235`", "}"}], ",", "17.`"}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"36.`", ",", "5.`", ",", 
         RowBox[{"{", "103.65102049960784`", "}"}], ",", "17.`"}], "}"}]}], 
      "}"}], ",", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"37.`", ",", "5.`", ",", 
         RowBox[{"{", "103.65102049960784`", "}"}], ",", "18.`"}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"38.`", ",", "5.`", ",", 
         RowBox[{"{", "106.34897950039216`", "}"}], ",", "18.`"}], "}"}]}], 
      "}"}], ",", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"39.`", ",", "5.`", ",", 
         RowBox[{"{", "100.9530614988235`", "}"}], ",", "19.`"}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"40.`", ",", "5.`", ",", 
         RowBox[{"{", "103.65102049960784`", "}"}], ",", "19.`"}], "}"}]}], 
      "}"}], ",", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"41.`", ",", "5.`", ",", 
         RowBox[{"{", "103.65102049960784`", "}"}], ",", "20.`"}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"42.`", ",", "5.`", ",", 
         RowBox[{"{", "106.34897950039216`", "}"}], ",", "20.`"}], "}"}]}], 
      "}"}], ",", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"43.`", ",", "5.`", ",", 
         RowBox[{"{", "103.65102049960784`", "}"}], ",", "21.`"}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"44.`", ",", "5.`", ",", 
         RowBox[{"{", "106.34897950039216`", "}"}], ",", "21.`"}], "}"}]}], 
      "}"}], ",", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"45.`", ",", "5.`", ",", 
         RowBox[{"{", "106.34897950039216`", "}"}], ",", "22.`"}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"46.`", ",", "5.`", ",", 
         RowBox[{"{", "109.0469385011765`", "}"}], ",", "22.`"}], "}"}]}], 
      "}"}], ",", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"47.`", ",", "5.`", ",", 
         RowBox[{"{", "100.9530614988235`", "}"}], ",", "23.`"}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"48.`", ",", "5.`", ",", 
         RowBox[{"{", "103.65102049960784`", "}"}], ",", "23.`"}], "}"}]}], 
      "}"}], ",", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"49.`", ",", "5.`", ",", 
         RowBox[{"{", "103.65102049960784`", "}"}], ",", "24.`"}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"50.`", ",", "5.`", ",", 
         RowBox[{"{", "106.34897950039216`", "}"}], ",", "24.`"}], "}"}]}], 
      "}"}], ",", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"51.`", ",", "5.`", ",", 
         RowBox[{"{", "103.65102049960784`", "}"}], ",", "25.`"}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"52.`", ",", "5.`", ",", 
         RowBox[{"{", "106.34897950039216`", "}"}], ",", "25.`"}], "}"}]}], 
      "}"}], ",", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"53.`", ",", "5.`", ",", 
         RowBox[{"{", "106.34897950039216`", "}"}], ",", "26.`"}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"54.`", ",", "5.`", ",", 
         RowBox[{"{", "109.0469385011765`", "}"}], ",", "26.`"}], "}"}]}], 
      "}"}], ",", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"55.`", ",", "5.`", ",", 
         RowBox[{"{", "103.65102049960784`", "}"}], ",", "27.`"}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"56.`", ",", "5.`", ",", 
         RowBox[{"{", "106.34897950039216`", "}"}], ",", "27.`"}], "}"}]}], 
      "}"}], ",", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"57.`", ",", "5.`", ",", 
         RowBox[{"{", "106.34897950039216`", "}"}], ",", "28.`"}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"58.`", ",", "5.`", ",", 
         RowBox[{"{", "109.0469385011765`", "}"}], ",", "28.`"}], "}"}]}], 
      "}"}], ",", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"59.`", ",", "5.`", ",", 
         RowBox[{"{", "106.34897950039216`", "}"}], ",", "29.`"}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"60.`", ",", "5.`", ",", 
         RowBox[{"{", "109.0469385011765`", "}"}], ",", "29.`"}], "}"}]}], 
      "}"}], ",", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"61.`", ",", "5.`", ",", 
         RowBox[{"{", "109.0469385011765`", "}"}], ",", "30.`"}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"62.`", ",", "5.`", ",", 
         RowBox[{"{", "111.74489750196082`", "}"}], ",", "30.`"}], "}"}]}], 
      "}"}]}], "}"}]}], "}"}]], "Output"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"x", "=", 
  RowBox[{"CompileProcess", "[", 
   RowBox[{"FromProcessTree", "[", 
    RowBox[{
     RowBox[{"{", "\"\<Equity\>\"", "}"}], ",", 
     RowBox[{"LogNormalProcess", "[", 
      RowBox[{"1", ",", "2"}], "]"}], ",", 
     RowBox[{"{", 
      RowBox[{"1", ",", "1", ",", "1", ",", "1", ",", "1"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"2", ",", "2", ",", "2", ",", "2", ",", "2"}], "}"}], ",", 
     RowBox[{"{", "100", "}"}]}], "]"}], "]"}]}]], "Input"],

Cell[BoxData[
 RowBox[{"FromDistributionTree", "[", 
  RowBox[{
   RowBox[{"{", "\<\"Equity\"\>", "}"}], ",", 
   RowBox[{"{", "100", "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
       RowBox[{"LogNormalDistributionD", "[", 
        RowBox[{"1", ",", "2"}], "]"}], ",", "1", ",", "2"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"LogNormalDistributionD", "[", 
        RowBox[{"1", ",", "2"}], "]"}], ",", "1", ",", "2"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"LogNormalDistributionD", "[", 
        RowBox[{"1", ",", "2"}], "]"}], ",", "1", ",", "2"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"LogNormalDistributionD", "[", 
        RowBox[{"1", ",", "2"}], "]"}], ",", "1", ",", "2"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"LogNormalDistributionD", "[", 
        RowBox[{"1", ",", "2"}], "]"}], ",", "1", ",", "2"}], "}"}]}], 
    "}"}]}], "]"}]], "Output"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"N", "[", 
  RowBox[{"GenerateTree", "[", 
   RowBox[{"x", ",", "0"}], "]"}], "]"}]], "Input"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{"{", 
    RowBox[{"{", 
     RowBox[{"{", 
      RowBox[{"0.`", ",", "0.`", ",", 
       RowBox[{"{", "100.`", "}"}], ",", "0.`"}], "}"}], "}"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"1.`", ",", "1.`", ",", 
        RowBox[{"{", "100.70540759070072`", "}"}], ",", "0.`"}], "}"}], ",", 
      RowBox[{"{", 
       RowBox[{"2.`", ",", "1.`", ",", 
        RowBox[{"{", "110.47487466301685`", "}"}], ",", "0.`"}], "}"}]}], 
     "}"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"3.`", ",", "2.`", ",", 
         RowBox[{"{", "101.41081518140142`", "}"}], ",", "1.`"}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"4.`", ",", "2.`", ",", 
         RowBox[{"{", "111.18028225371756`", "}"}], ",", "1.`"}], "}"}]}], 
      "}"}], ",", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"5.`", ",", "2.`", ",", 
         RowBox[{"{", "111.18028225371756`", "}"}], ",", "2.`"}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"6.`", ",", "2.`", ",", 
         RowBox[{"{", "120.94974932603371`", "}"}], ",", "2.`"}], "}"}]}], 
      "}"}]}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"7.`", ",", "3.`", ",", 
         RowBox[{"{", "102.11622277210213`", "}"}], ",", "3.`"}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"8.`", ",", "3.`", ",", 
         RowBox[{"{", "111.88568984441827`", "}"}], ",", "3.`"}], "}"}]}], 
      "}"}], ",", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"9.`", ",", "3.`", ",", 
         RowBox[{"{", "111.88568984441827`", "}"}], ",", "4.`"}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"10.`", ",", "3.`", ",", 
         RowBox[{"{", "121.65515691673443`", "}"}], ",", "4.`"}], "}"}]}], 
      "}"}], ",", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"11.`", ",", "3.`", ",", 
         RowBox[{"{", "111.88568984441827`", "}"}], ",", "5.`"}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"12.`", ",", "3.`", ",", 
         RowBox[{"{", "121.65515691673443`", "}"}], ",", "5.`"}], "}"}]}], 
      "}"}], ",", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"13.`", ",", "3.`", ",", 
         RowBox[{"{", "121.65515691673443`", "}"}], ",", "6.`"}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"14.`", ",", "3.`", ",", 
         RowBox[{"{", "131.42462398905056`", "}"}], ",", "6.`"}], "}"}]}], 
      "}"}]}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"15.`", ",", "4.`", ",", 
         RowBox[{"{", "102.82163036280285`", "}"}], ",", "7.`"}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"16.`", ",", "4.`", ",", 
         RowBox[{"{", "112.59109743511898`", "}"}], ",", "7.`"}], "}"}]}], 
      "}"}], ",", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"17.`", ",", "4.`", ",", 
         RowBox[{"{", "112.59109743511898`", "}"}], ",", "8.`"}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"18.`", ",", "4.`", ",", 
         RowBox[{"{", "122.36056450743513`", "}"}], ",", "8.`"}], "}"}]}], 
      "}"}], ",", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"19.`", ",", "4.`", ",", 
         RowBox[{"{", "112.59109743511898`", "}"}], ",", "9.`"}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"20.`", ",", "4.`", ",", 
         RowBox[{"{", "122.36056450743513`", "}"}], ",", "9.`"}], "}"}]}], 
      "}"}], ",", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"21.`", ",", "4.`", ",", 
         RowBox[{"{", "122.36056450743513`", "}"}], ",", "10.`"}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"22.`", ",", "4.`", ",", 
         RowBox[{"{", "132.1300315797513`", "}"}], ",", "10.`"}], "}"}]}], 
      "}"}], ",", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"23.`", ",", "4.`", ",", 
         RowBox[{"{", "112.59109743511898`", "}"}], ",", "11.`"}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"24.`", ",", "4.`", ",", 
         RowBox[{"{", "122.36056450743513`", "}"}], ",", "11.`"}], "}"}]}], 
      "}"}], ",", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"25.`", ",", "4.`", ",", 
         RowBox[{"{", "122.36056450743513`", "}"}], ",", "12.`"}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"26.`", ",", "4.`", ",", 
         RowBox[{"{", "132.1300315797513`", "}"}], ",", "12.`"}], "}"}]}], 
      "}"}], ",", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"27.`", ",", "4.`", ",", 
         RowBox[{"{", "122.36056450743513`", "}"}], ",", "13.`"}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"28.`", ",", "4.`", ",", 
         RowBox[{"{", "132.1300315797513`", "}"}], ",", "13.`"}], "}"}]}], 
      "}"}], ",", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"29.`", ",", "4.`", ",", 
         RowBox[{"{", "132.1300315797513`", "}"}], ",", "14.`"}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"30.`", ",", "4.`", ",", 
         RowBox[{"{", "141.89949865206742`", "}"}], ",", "14.`"}], "}"}]}], 
      "}"}]}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"31.`", ",", "5.`", ",", 
         RowBox[{"{", "103.52703795350355`", "}"}], ",", "15.`"}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"32.`", ",", "5.`", ",", 
         RowBox[{"{", "113.2965050258197`", "}"}], ",", "15.`"}], "}"}]}], 
      "}"}], ",", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"33.`", ",", "5.`", ",", 
         RowBox[{"{", "113.2965050258197`", "}"}], ",", "16.`"}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"34.`", ",", "5.`", ",", 
         RowBox[{"{", "123.06597209813584`", "}"}], ",", "16.`"}], "}"}]}], 
      "}"}], ",", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"35.`", ",", "5.`", ",", 
         RowBox[{"{", "113.2965050258197`", "}"}], ",", "17.`"}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"36.`", ",", "5.`", ",", 
         RowBox[{"{", "123.06597209813584`", "}"}], ",", "17.`"}], "}"}]}], 
      "}"}], ",", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"37.`", ",", "5.`", ",", 
         RowBox[{"{", "123.06597209813584`", "}"}], ",", "18.`"}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"38.`", ",", "5.`", ",", 
         RowBox[{"{", "132.835439170452`", "}"}], ",", "18.`"}], "}"}]}], 
      "}"}], ",", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"39.`", ",", "5.`", ",", 
         RowBox[{"{", "113.2965050258197`", "}"}], ",", "19.`"}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"40.`", ",", "5.`", ",", 
         RowBox[{"{", "123.06597209813584`", "}"}], ",", "19.`"}], "}"}]}], 
      "}"}], ",", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"41.`", ",", "5.`", ",", 
         RowBox[{"{", "123.06597209813584`", "}"}], ",", "20.`"}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"42.`", ",", "5.`", ",", 
         RowBox[{"{", "132.835439170452`", "}"}], ",", "20.`"}], "}"}]}], 
      "}"}], ",", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"43.`", ",", "5.`", ",", 
         RowBox[{"{", "123.06597209813584`", "}"}], ",", "21.`"}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"44.`", ",", "5.`", ",", 
         RowBox[{"{", "132.835439170452`", "}"}], ",", "21.`"}], "}"}]}], 
      "}"}], ",", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"45.`", ",", "5.`", ",", 
         RowBox[{"{", "132.835439170452`", "}"}], ",", "22.`"}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"46.`", ",", "5.`", ",", 
         RowBox[{"{", "142.60490624276812`", "}"}], ",", "22.`"}], "}"}]}], 
      "}"}], ",", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"47.`", ",", "5.`", ",", 
         RowBox[{"{", "113.2965050258197`", "}"}], ",", "23.`"}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"48.`", ",", "5.`", ",", 
         RowBox[{"{", "123.06597209813584`", "}"}], ",", "23.`"}], "}"}]}], 
      "}"}], ",", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"49.`", ",", "5.`", ",", 
         RowBox[{"{", "123.06597209813584`", "}"}], ",", "24.`"}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"50.`", ",", "5.`", ",", 
         RowBox[{"{", "132.835439170452`", "}"}], ",", "24.`"}], "}"}]}], 
      "}"}], ",", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"51.`", ",", "5.`", ",", 
         RowBox[{"{", "123.06597209813584`", "}"}], ",", "25.`"}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"52.`", ",", "5.`", ",", 
         RowBox[{"{", "132.835439170452`", "}"}], ",", "25.`"}], "}"}]}], 
      "}"}], ",", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"53.`", ",", "5.`", ",", 
         RowBox[{"{", "132.835439170452`", "}"}], ",", "26.`"}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"54.`", ",", "5.`", ",", 
         RowBox[{"{", "142.60490624276812`", "}"}], ",", "26.`"}], "}"}]}], 
      "}"}], ",", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"55.`", ",", "5.`", ",", 
         RowBox[{"{", "123.06597209813584`", "}"}], ",", "27.`"}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"56.`", ",", "5.`", ",", 
         RowBox[{"{", "132.835439170452`", "}"}], ",", "27.`"}], "}"}]}], 
      "}"}], ",", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"57.`", ",", "5.`", ",", 
         RowBox[{"{", "132.835439170452`", "}"}], ",", "28.`"}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"58.`", ",", "5.`", ",", 
         RowBox[{"{", "142.60490624276812`", "}"}], ",", "28.`"}], "}"}]}], 
      "}"}], ",", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"59.`", ",", "5.`", ",", 
         RowBox[{"{", "132.835439170452`", "}"}], ",", "29.`"}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"60.`", ",", "5.`", ",", 
         RowBox[{"{", "142.60490624276812`", "}"}], ",", "29.`"}], "}"}]}], 
      "}"}], ",", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"61.`", ",", "5.`", ",", 
         RowBox[{"{", "142.60490624276812`", "}"}], ",", "30.`"}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"62.`", ",", "5.`", ",", 
         RowBox[{"{", "152.37437331508426`", "}"}], ",", "30.`"}], "}"}]}], 
      "}"}]}], "}"}]}], "}"}]], "Output"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"x", "=", 
  RowBox[{"CompileProcess", "[", 
   RowBox[{"FromProcessTree", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"\"\<Equity\>\"", ",", "\"\<IR\>\"", ",", "\"\<Spread\>\""}], 
      "}"}], ",", 
     RowBox[{"MultiNormalProcess", "[", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"0.1", ",", "0.2", ",", "0.1"}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{"1", ",", "0.5", ",", "0.25"}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{"0.5", ",", "1", ",", "0.25"}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{"0.25", ",", "0.25", ",", "1"}], "}"}]}], "}"}], ",", "2"}],
       "]"}], ",", 
     RowBox[{"{", 
      RowBox[{"1", ",", "1", ",", "1", ",", "1", ",", "1"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"2", ",", "2", ",", "2", ",", "2", ",", "2"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"100", ",", "100", ",", "100"}], "}"}]}], "]"}], 
   "]"}]}]], "Input"],

Cell[BoxData[
 RowBox[{"FromDistributionTree", "[", 
  RowBox[{
   RowBox[{"{", 
    RowBox[{"\<\"Equity\"\>", ",", "\<\"IR\"\>", ",", "\<\"Spread\"\>"}], 
    "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"100", ",", "100", ",", "100"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
       RowBox[{"MultinormalDistributionD", "[", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{"0.1`", ",", "0.2`", ",", "0.1`"}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{"{", 
            RowBox[{"1", ",", "0.5`", ",", "0.25`"}], "}"}], ",", 
           RowBox[{"{", 
            RowBox[{"0.5`", ",", "1", ",", "0.25`"}], "}"}], ",", 
           RowBox[{"{", 
            RowBox[{"0.25`", ",", "0.25`", ",", "1"}], "}"}]}], "}"}], ",", 
         "2"}], "]"}], ",", "1", ",", "2"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"MultinormalDistributionD", "[", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{"0.1`", ",", "0.2`", ",", "0.1`"}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{"{", 
            RowBox[{"1", ",", "0.5`", ",", "0.25`"}], "}"}], ",", 
           RowBox[{"{", 
            RowBox[{"0.5`", ",", "1", ",", "0.25`"}], "}"}], ",", 
           RowBox[{"{", 
            RowBox[{"0.25`", ",", "0.25`", ",", "1"}], "}"}]}], "}"}], ",", 
         "2"}], "]"}], ",", "1", ",", "2"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"MultinormalDistributionD", "[", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{"0.1`", ",", "0.2`", ",", "0.1`"}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{"{", 
            RowBox[{"1", ",", "0.5`", ",", "0.25`"}], "}"}], ",", 
           RowBox[{"{", 
            RowBox[{"0.5`", ",", "1", ",", "0.25`"}], "}"}], ",", 
           RowBox[{"{", 
            RowBox[{"0.25`", ",", "0.25`", ",", "1"}], "}"}]}], "}"}], ",", 
         "2"}], "]"}], ",", "1", ",", "2"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"MultinormalDistributionD", "[", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{"0.1`", ",", "0.2`", ",", "0.1`"}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{"{", 
            RowBox[{"1", ",", "0.5`", ",", "0.25`"}], "}"}], ",", 
           RowBox[{"{", 
            RowBox[{"0.5`", ",", "1", ",", "0.25`"}], "}"}], ",", 
           RowBox[{"{", 
            RowBox[{"0.25`", ",", "0.25`", ",", "1"}], "}"}]}], "}"}], ",", 
         "2"}], "]"}], ",", "1", ",", "2"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"MultinormalDistributionD", "[", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{"0.1`", ",", "0.2`", ",", "0.1`"}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{"{", 
            RowBox[{"1", ",", "0.5`", ",", "0.25`"}], "}"}], ",", 
           RowBox[{"{", 
            RowBox[{"0.5`", ",", "1", ",", "0.25`"}], "}"}], ",", 
           RowBox[{"{", 
            RowBox[{"0.25`", ",", "0.25`", ",", "1"}], "}"}]}], "}"}], ",", 
         "2"}], "]"}], ",", "1", ",", "2"}], "}"}]}], "}"}]}], 
  "]"}]], "Output"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"Timing", "[", 
  RowBox[{
   RowBox[{"tree1", "=", 
    RowBox[{"N", "[", 
     RowBox[{"GenerateTree", "[", 
      RowBox[{"x", ",", "0"}], "]"}], "]"}]}], ";", 
   RowBox[{"Print", "[", 
    RowBox[{
     RowBox[{"ToString", "[", 
      RowBox[{
       RowBox[{"Length", "[", "tree1", "]"}], "-", "1"}], "]"}], "<>", 
     "\"\< stages \>\"", " ", "<>", " ", 
     RowBox[{"ToString", "[", 
      RowBox[{"Length", "[", 
       RowBox[{"Flatten", "[", 
        RowBox[{"tree1", ",", "2"}], "]"}], "]"}], "]"}], "<>", 
     "\"\< nodes\>\""}], "]"}]}], "]"}]], "Input"],

Cell[BoxData["\<\"5 stages 1365 nodes\"\>"], "Print"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{"12.317000000000002`", " ", "Second"}], ",", "Null"}], 
  "}"}]], "Output"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"x", "=", 
  RowBox[{"CompileProcess", "[", 
   RowBox[{"FromProcessTree", "[", 
    RowBox[{
     RowBox[{"{", "\"\<Equity\>\"", "}"}], ",", 
     RowBox[{"MeanRevertingProcess", "[", 
      RowBox[{"120", ",", "1.", ",", "2"}], "]"}], ",", 
     RowBox[{"{", 
      RowBox[{"1", ",", "1", ",", "1", ",", "1", ",", "1"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"2", ",", "2", ",", "2", ",", "2", ",", "2"}], "}"}], ",", 
     RowBox[{"{", "100", "}"}]}], "]"}], "]"}]}]], "Input"],

Cell[BoxData[
 RowBox[{"FromDistributionTree", "[", 
  RowBox[{
   RowBox[{"{", "\<\"Equity\"\>", "}"}], ",", 
   RowBox[{"{", "100", "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
       RowBox[{"LinearDriftNormalDistributionD", "[", 
        RowBox[{
         RowBox[{"-", "0.6321205588285577`"}], ",", "75.85446705942692`", ",",
          "1.3150397079657992`"}], "]"}], ",", "1", ",", "2"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"LinearDriftNormalDistributionD", "[", 
        RowBox[{
         RowBox[{"-", "0.6321205588285577`"}], ",", "75.85446705942692`", ",",
          "1.3150397079657992`"}], "]"}], ",", "1", ",", "2"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"LinearDriftNormalDistributionD", "[", 
        RowBox[{
         RowBox[{"-", "0.6321205588285577`"}], ",", "75.85446705942692`", ",",
          "1.3150397079657992`"}], "]"}], ",", "1", ",", "2"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"LinearDriftNormalDistributionD", "[", 
        RowBox[{
         RowBox[{"-", "0.6321205588285577`"}], ",", "75.85446705942692`", ",",
          "1.3150397079657992`"}], "]"}], ",", "1", ",", "2"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"LinearDriftNormalDistributionD", "[", 
        RowBox[{
         RowBox[{"-", "0.6321205588285577`"}], ",", "75.85446705942692`", ",",
          "1.3150397079657992`"}], "]"}], ",", "1", ",", "2"}], "}"}]}], 
    "}"}]}], "]"}]], "Output"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"N", "[", 
  RowBox[{"GenerateTree", "[", 
   RowBox[{"x", ",", "0"}], "]"}], "]"}]], "Input"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{"{", 
    RowBox[{"{", 
     RowBox[{"{", 
      RowBox[{"0.`", ",", "0.`", ",", 
       RowBox[{"{", "100.`", "}"}], ",", "0.`"}], "}"}], "}"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"1.`", ",", "1.`", ",", 
        RowBox[{"{", "111.75543037244738`", "}"}], ",", "0.`"}], "}"}], ",", 
      RowBox[{"{", 
       RowBox[{"2.`", ",", "1.`", ",", 
        RowBox[{"{", "113.52939198069494`", "}"}], ",", "0.`"}], "}"}]}], 
     "}"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"3.`", ",", "2.`", ",", 
         RowBox[{"{", "116.08001152859312`", "}"}], ",", "1.`"}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"4.`", ",", "2.`", ",", 
         RowBox[{"{", "117.85397313684068`", "}"}], ",", "1.`"}], "}"}]}], 
      "}"}], ",", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"5.`", ",", "2.`", ",", 
         RowBox[{"{", "116.73261553369483`", "}"}], ",", "2.`"}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"6.`", ",", "2.`", ",", 
         RowBox[{"{", "118.50657714194239`", "}"}], ",", "2.`"}], "}"}]}], 
      "}"}]}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"7.`", ",", "3.`", ",", 
         RowBox[{"{", "117.67093602761656`", "}"}], ",", "3.`"}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"8.`", ",", "3.`", ",", 
         RowBox[{"{", "119.44489763586412`", "}"}], ",", "3.`"}], "}"}]}], 
      "}"}], ",", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"9.`", ",", "3.`", ",", 
         RowBox[{"{", "118.32354003271827`", "}"}], ",", "4.`"}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"10.`", ",", "3.`", ",", 
         RowBox[{"{", "120.09750164096583`", "}"}], ",", "4.`"}], "}"}]}], 
      "}"}], ",", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"11.`", ",", "3.`", ",", 
         RowBox[{"{", "117.91101562431963`", "}"}], ",", "5.`"}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"12.`", ",", "3.`", ",", 
         RowBox[{"{", "119.68497723256719`", "}"}], ",", "5.`"}], "}"}]}], 
      "}"}], ",", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"13.`", ",", "3.`", ",", 
         RowBox[{"{", "118.56361962942132`", "}"}], ",", "6.`"}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"14.`", ",", "3.`", ",", 
         RowBox[{"{", "120.33758123766889`", "}"}], ",", "6.`"}], "}"}]}], 
      "}"}]}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"15.`", ",", "4.`", ",", 
         RowBox[{"{", "118.25620444326327`", "}"}], ",", "7.`"}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"16.`", ",", "4.`", ",", 
         RowBox[{"{", "120.03016605151083`", "}"}], ",", "7.`"}], "}"}]}], 
      "}"}], ",", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"17.`", ",", "4.`", ",", 
         RowBox[{"{", "118.90880844836497`", "}"}], ",", "8.`"}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"18.`", ",", "4.`", ",", 
         RowBox[{"{", "120.68277005661253`", "}"}], ",", "8.`"}], "}"}]}], 
      "}"}], ",", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"19.`", ",", "4.`", ",", 
         RowBox[{"{", "118.49628403996633`", "}"}], ",", "9.`"}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"20.`", ",", "4.`", ",", 
         RowBox[{"{", "120.27024564821389`", "}"}], ",", "9.`"}], "}"}]}], 
      "}"}], ",", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"21.`", ",", "4.`", ",", 
         RowBox[{"{", "119.14888804506803`", "}"}], ",", "10.`"}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"22.`", ",", "4.`", ",", 
         RowBox[{"{", "120.9228496533156`", "}"}], ",", "10.`"}], "}"}]}], 
      "}"}], ",", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"23.`", ",", "4.`", ",", 
         RowBox[{"{", "118.34452479113506`", "}"}], ",", "11.`"}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"24.`", ",", "4.`", ",", 
         RowBox[{"{", "120.11848639938262`", "}"}], ",", "11.`"}], "}"}]}], 
      "}"}], ",", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"25.`", ",", "4.`", ",", 
         RowBox[{"{", "118.99712879623677`", "}"}], ",", "12.`"}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"26.`", ",", "4.`", ",", 
         RowBox[{"{", "120.77109040448433`", "}"}], ",", "12.`"}], "}"}]}], 
      "}"}], ",", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"27.`", ",", "4.`", ",", 
         RowBox[{"{", "118.58460438783811`", "}"}], ",", "13.`"}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"28.`", ",", "4.`", ",", 
         RowBox[{"{", "120.35856599608567`", "}"}], ",", "13.`"}], "}"}]}], 
      "}"}], ",", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"29.`", ",", "4.`", ",", 
         RowBox[{"{", "119.23720839293982`", "}"}], ",", "14.`"}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"30.`", ",", "4.`", ",", 
         RowBox[{"{", "121.01117000118738`", "}"}], ",", "14.`"}], "}"}]}], 
      "}"}]}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"31.`", ",", "5.`", ",", 
         RowBox[{"{", "118.47151266094667`", "}"}], ",", "15.`"}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"32.`", ",", "5.`", ",", 
         RowBox[{"{", "120.24547426919423`", "}"}], ",", "15.`"}], "}"}]}], 
      "}"}], ",", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"33.`", ",", "5.`", ",", 
         RowBox[{"{", "119.12411666604838`", "}"}], ",", "16.`"}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"34.`", ",", "5.`", ",", 
         RowBox[{"{", "120.89807827429594`", "}"}], ",", "16.`"}], "}"}]}], 
      "}"}], ",", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"35.`", ",", "5.`", ",", 
         RowBox[{"{", "118.71159225764973`", "}"}], ",", "17.`"}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"36.`", ",", "5.`", ",", 
         RowBox[{"{", "120.48555386589729`", "}"}], ",", "17.`"}], "}"}]}], 
      "}"}], ",", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"37.`", ",", "5.`", ",", 
         RowBox[{"{", "119.36419626275143`", "}"}], ",", "18.`"}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"38.`", ",", "5.`", ",", 
         RowBox[{"{", "121.138157870999`", "}"}], ",", "18.`"}], "}"}]}], 
      "}"}], ",", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"39.`", ",", "5.`", ",", 
         RowBox[{"{", "118.55983300881846`", "}"}], ",", "19.`"}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"40.`", ",", "5.`", ",", 
         RowBox[{"{", "120.33379461706602`", "}"}], ",", "19.`"}], "}"}]}], 
      "}"}], ",", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"41.`", ",", "5.`", ",", 
         RowBox[{"{", "119.21243701392017`", "}"}], ",", "20.`"}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"42.`", ",", "5.`", ",", 
         RowBox[{"{", "120.98639862216773`", "}"}], ",", "20.`"}], "}"}]}], 
      "}"}], ",", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"43.`", ",", "5.`", ",", 
         RowBox[{"{", "118.79991260552151`", "}"}], ",", "21.`"}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"44.`", ",", "5.`", ",", 
         RowBox[{"{", "120.57387421376907`", "}"}], ",", "21.`"}], "}"}]}], 
      "}"}], ",", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"45.`", ",", "5.`", ",", 
         RowBox[{"{", "119.45251661062322`", "}"}], ",", "22.`"}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"46.`", ",", "5.`", ",", 
         RowBox[{"{", "121.22647821887078`", "}"}], ",", "22.`"}], "}"}]}], 
      "}"}], ",", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"47.`", ",", "5.`", ",", 
         RowBox[{"{", "118.50400390116582`", "}"}], ",", "23.`"}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"48.`", ",", "5.`", ",", 
         RowBox[{"{", "120.27796550941338`", "}"}], ",", "23.`"}], "}"}]}], 
      "}"}], ",", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"49.`", ",", "5.`", ",", 
         RowBox[{"{", "119.15660790626752`", "}"}], ",", "24.`"}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"50.`", ",", "5.`", ",", 
         RowBox[{"{", "120.93056951451508`", "}"}], ",", "24.`"}], "}"}]}], 
      "}"}], ",", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"51.`", ",", "5.`", ",", 
         RowBox[{"{", "118.74408349786887`", "}"}], ",", "25.`"}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"52.`", ",", "5.`", ",", 
         RowBox[{"{", "120.51804510611643`", "}"}], ",", "25.`"}], "}"}]}], 
      "}"}], ",", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"53.`", ",", "5.`", ",", 
         RowBox[{"{", "119.39668750297058`", "}"}], ",", "26.`"}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"54.`", ",", "5.`", ",", 
         RowBox[{"{", "121.17064911121814`", "}"}], ",", "26.`"}], "}"}]}], 
      "}"}], ",", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"55.`", ",", "5.`", ",", 
         RowBox[{"{", "118.5923242490376`", "}"}], ",", "27.`"}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"56.`", ",", "5.`", ",", 
         RowBox[{"{", "120.36628585728516`", "}"}], ",", "27.`"}], "}"}]}], 
      "}"}], ",", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"57.`", ",", "5.`", ",", 
         RowBox[{"{", "119.2449282541393`", "}"}], ",", "28.`"}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"58.`", ",", "5.`", ",", 
         RowBox[{"{", "121.01888986238686`", "}"}], ",", "28.`"}], "}"}]}], 
      "}"}], ",", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"59.`", ",", "5.`", ",", 
         RowBox[{"{", "118.83240384574066`", "}"}], ",", "29.`"}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"60.`", ",", "5.`", ",", 
         RowBox[{"{", "120.60636545398822`", "}"}], ",", "29.`"}], "}"}]}], 
      "}"}], ",", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"61.`", ",", "5.`", ",", 
         RowBox[{"{", "119.48500785084236`", "}"}], ",", "30.`"}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"62.`", ",", "5.`", ",", 
         RowBox[{"{", "121.25896945908993`", "}"}], ",", "30.`"}], "}"}]}], 
      "}"}]}], "}"}]}], "}"}]], "Output"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"Timing", "[", 
  RowBox[{
   RowBox[{"tree1", "=", 
    RowBox[{"GenerateTree", "[", 
     RowBox[{
      RowBox[{"NormalRankCombineSpaces", "[", 
       RowBox[{
        RowBox[{"{", "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{"FromDistributionTree", "[", 
           RowBox[{
            RowBox[{"{", "\"\<equity\>\"", "}"}], ",", 
            RowBox[{"{", "100", "}"}], ",", 
            RowBox[{"{", 
             RowBox[{
              RowBox[{"{", 
               RowBox[{
                RowBox[{"StudentTDistributionD", "[", "1.1", "]"}], ",", "1", 
                ",", "3"}], "}"}], ",", 
              RowBox[{"{", 
               RowBox[{
                RowBox[{"StudentTDistributionD", "[", "1.1", "]"}], ",", "1", 
                ",", "3"}], "}"}]}], "}"}]}], "]"}], ",", 
          "\[IndentingNewLine]", 
          RowBox[{"FromDistributionTree", "[", 
           RowBox[{
            RowBox[{"{", "\"\<IR\>\"", "}"}], ",", 
            RowBox[{"{", "200", "}"}], ",", 
            RowBox[{"{", 
             RowBox[{
              RowBox[{"{", 
               RowBox[{
                RowBox[{"StudentTDistributionD", "[", "1.1", "]"}], ",", "1", 
                ",", "2"}], "}"}], ",", 
              RowBox[{"{", 
               RowBox[{
                RowBox[{"StudentTDistributionD", "[", "1.1", "]"}], ",", "1", 
                ",", "2"}], "}"}]}], "}"}]}], "]"}]}], "\[IndentingNewLine]", 
         "}"}], ",", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{"{", 
           RowBox[{"1", ",", "0.5"}], "}"}], ",", 
          RowBox[{"{", 
           RowBox[{"0.5", ",", "1"}], "}"}]}], "}"}]}], "]"}], ",", 
      "\[IndentingNewLine]", "0"}], "]"}]}], ";", 
   RowBox[{"Print", "[", 
    RowBox[{
     RowBox[{"ToString", "[", 
      RowBox[{
       RowBox[{"Length", "[", "tree1", "]"}], "-", "1"}], "]"}], "<>", 
     "\"\< stages \>\"", " ", "<>", " ", 
     RowBox[{"ToString", "[", 
      RowBox[{"Length", "[", 
       RowBox[{"Flatten", "[", 
        RowBox[{"tree1", ",", "2"}], "]"}], "]"}], "]"}], "<>", 
     "\"\< nodes\>\""}], "]"}], ";", 
   RowBox[{"Print", "[", "tree1", "]"}]}], "]"}]], "Input"],

Cell[CellGroupData[{

Cell[BoxData["\<\"1 stages 2 nodes\"\>"], "Print"],

Cell[BoxData[
 RowBox[{"GenerateTree", "[", 
  RowBox[{
   RowBox[{"NormalRankCombineSpaces", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
       RowBox[{"FromDistributionTree", "[", 
        RowBox[{
         RowBox[{"{", "\<\"equity\"\>", "}"}], ",", 
         RowBox[{"{", "100", "}"}], ",", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{"{", 
            RowBox[{
             RowBox[{"StudentTDistributionD", "[", "1.1`", "]"}], ",", "1", 
             ",", "3"}], "}"}], ",", 
           RowBox[{"{", 
            RowBox[{
             RowBox[{"StudentTDistributionD", "[", "1.1`", "]"}], ",", "1", 
             ",", "3"}], "}"}]}], "}"}]}], "]"}], ",", 
       RowBox[{"FromDistributionTree", "[", 
        RowBox[{
         RowBox[{"{", "\<\"IR\"\>", "}"}], ",", 
         RowBox[{"{", "200", "}"}], ",", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{"{", 
            RowBox[{
             RowBox[{"StudentTDistributionD", "[", "1.1`", "]"}], ",", "1", 
             ",", "2"}], "}"}], ",", 
           RowBox[{"{", 
            RowBox[{
             RowBox[{"StudentTDistributionD", "[", "1.1`", "]"}], ",", "1", 
             ",", "2"}], "}"}]}], "}"}]}], "]"}]}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"1", ",", "0.5`"}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"0.5`", ",", "1"}], "}"}]}], "}"}]}], "]"}], ",", "0"}], 
  "]"}]], "Print"]
}, Open  ]],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{"0.`", " ", "Second"}], ",", "Null"}], "}"}]], "Output"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"ftree1", "=", 
  RowBox[{"NormalRankCombineSpaces", "[", 
   RowBox[{
    RowBox[{"{", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"FromDistributionTree", "[", 
       RowBox[{
        RowBox[{"{", "\"\<equity\>\"", "}"}], ",", 
        RowBox[{"{", "100", "}"}], ",", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{"{", 
           RowBox[{
            RowBox[{"StudentTDistributionD", "[", "1.1", "]"}], ",", "1", ",",
             "3"}], "}"}], ",", 
          RowBox[{"{", 
           RowBox[{
            RowBox[{"StudentTDistributionD", "[", "1.1", "]"}], ",", "1", ",",
             "3"}], "}"}]}], "}"}]}], "]"}], ",", "\[IndentingNewLine]", 
      RowBox[{"FromDistributionTree", "[", 
       RowBox[{
        RowBox[{"{", "\"\<IR\>\"", "}"}], ",", 
        RowBox[{"{", "200", "}"}], ",", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{"{", 
           RowBox[{
            RowBox[{"StudentTDistributionD", "[", "1.1", "]"}], ",", "1", ",",
             "2"}], "}"}], ",", 
          RowBox[{"{", 
           RowBox[{
            RowBox[{"StudentTDistributionD", "[", "1.1", "]"}], ",", "1", ",",
             "2"}], "}"}]}], "}"}]}], "]"}]}], "\[IndentingNewLine]", "}"}], 
    ",", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"1", ",", "0.5"}], "}"}], ",", 
      RowBox[{"{", 
       RowBox[{"0.5", ",", "1"}], "}"}]}], "}"}]}], "]"}]}]], "Input"],

Cell[BoxData[
 RowBox[{"NormalRankCombineSpaces", "[", 
  RowBox[{
   RowBox[{"{", 
    RowBox[{
     RowBox[{"FromDistributionTree", "[", 
      RowBox[{
       RowBox[{"{", "\<\"equity\"\>", "}"}], ",", 
       RowBox[{"{", "100", "}"}], ",", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{
           RowBox[{"StudentTDistributionD", "[", "1.1`", "]"}], ",", "1", ",",
            "3"}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{"StudentTDistributionD", "[", "1.1`", "]"}], ",", "1", ",",
            "3"}], "}"}]}], "}"}]}], "]"}], ",", 
     RowBox[{"FromDistributionTree", "[", 
      RowBox[{
       RowBox[{"{", "\<\"IR\"\>", "}"}], ",", 
       RowBox[{"{", "200", "}"}], ",", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{
           RowBox[{"StudentTDistributionD", "[", "1.1`", "]"}], ",", "1", ",",
            "2"}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{"StudentTDistributionD", "[", "1.1`", "]"}], ",", "1", ",",
            "2"}], "}"}]}], "}"}]}], "]"}]}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"1", ",", "0.5`"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"0.5`", ",", "1"}], "}"}]}], "}"}]}], "]"}]], "Output"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"GenerateTree", "[", 
  RowBox[{"ftree1", ",", "0"}], "]"}]], "Input"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{"{", 
    RowBox[{"{", 
     RowBox[{"{", 
      RowBox[{"0", ",", "0", ",", 
       RowBox[{"{", 
        RowBox[{"100", ",", "200"}], "}"}], ",", "0"}], "}"}], "}"}], "}"}], 
   ",", 
   RowBox[{"{", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"1", ",", "1", ",", 
        RowBox[{"{", 
         RowBox[{"97.08881306812697`", ",", "199.19696970609363`"}], "}"}], 
        ",", "0"}], "}"}], ",", 
      RowBox[{"{", 
       RowBox[{"2", ",", "1", ",", 
        RowBox[{"{", 
         RowBox[{"99.1174292862463`", ",", "200.80303029390637`"}], "}"}], 
        ",", "0"}], "}"}], ",", 
      RowBox[{"{", 
       RowBox[{"3", ",", "1", ",", 
        RowBox[{"{", 
         RowBox[{"99.56949070968335`", ",", "199.19696970609363`"}], "}"}], 
        ",", "0"}], "}"}], ",", 
      RowBox[{"{", 
       RowBox[{"4", ",", "1", ",", 
        RowBox[{"{", 
         RowBox[{"100.43050929031665`", ",", "200.80303029390637`"}], "}"}], 
        ",", "0"}], "}"}], ",", 
      RowBox[{"{", 
       RowBox[{"5", ",", "1", ",", 
        RowBox[{"{", 
         RowBox[{"100.8825707137537`", ",", "199.19696970609363`"}], "}"}], 
        ",", "0"}], "}"}], ",", 
      RowBox[{"{", 
       RowBox[{"6", ",", "1", ",", 
        RowBox[{"{", 
         RowBox[{"102.91118693187303`", ",", "200.80303029390637`"}], "}"}], 
        ",", "0"}], "}"}]}], "}"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"7", ",", "2", ",", 
         RowBox[{"{", 
          RowBox[{"95.45825678410536`", ",", "198.23390338446146`"}], "}"}], 
         ",", "1"}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"8", ",", "2", ",", 
         RowBox[{"{", 
          RowBox[{"97.4868730022247`", ",", "199.8399639722742`"}], "}"}], 
         ",", "1"}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"9", ",", "2", ",", 
         RowBox[{"{", 
          RowBox[{"97.93893442566174`", ",", "198.23390338446146`"}], "}"}], 
         ",", "1"}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"10", ",", "2", ",", 
         RowBox[{"{", 
          RowBox[{"98.79995300629504`", ",", "199.8399639722742`"}], "}"}], 
         ",", "1"}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"11", ",", "2", ",", 
         RowBox[{"{", 
          RowBox[{"99.25201442973209`", ",", "198.23390338446146`"}], "}"}], 
         ",", "1"}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"12", ",", "2", ",", 
         RowBox[{"{", 
          RowBox[{"101.28063064785142`", ",", "199.8399639722742`"}], "}"}], 
         ",", "1"}], "}"}]}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"13", ",", "2", ",", 
         RowBox[{"{", 
          RowBox[{"95.45825678410536`", ",", "200.1600360277258`"}], "}"}], 
         ",", "2"}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"14", ",", "2", ",", 
         RowBox[{"{", 
          RowBox[{"97.4868730022247`", ",", "201.76609661553854`"}], "}"}], 
         ",", "2"}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"15", ",", "2", ",", 
         RowBox[{"{", 
          RowBox[{"97.93893442566174`", ",", "200.1600360277258`"}], "}"}], 
         ",", "2"}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"16", ",", "2", ",", 
         RowBox[{"{", 
          RowBox[{"98.79995300629504`", ",", "201.76609661553854`"}], "}"}], 
         ",", "2"}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"17", ",", "2", ",", 
         RowBox[{"{", 
          RowBox[{"99.25201442973209`", ",", "200.1600360277258`"}], "}"}], 
         ",", "2"}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"18", ",", "2", ",", 
         RowBox[{"{", 
          RowBox[{"101.28063064785142`", ",", "201.76609661553854`"}], "}"}], 
         ",", "2"}], "}"}]}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"19", ",", "2", ",", 
         RowBox[{"{", 
          RowBox[{"97.08881306812697`", ",", "198.23390338446146`"}], "}"}], 
         ",", "3"}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"20", ",", "2", ",", 
         RowBox[{"{", 
          RowBox[{"99.1174292862463`", ",", "199.8399639722742`"}], "}"}], 
         ",", "3"}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"21", ",", "2", ",", 
         RowBox[{"{", 
          RowBox[{"99.56949070968335`", ",", "198.23390338446146`"}], "}"}], 
         ",", "3"}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"22", ",", "2", ",", 
         RowBox[{"{", 
          RowBox[{"100.43050929031665`", ",", "199.8399639722742`"}], "}"}], 
         ",", "3"}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"23", ",", "2", ",", 
         RowBox[{"{", 
          RowBox[{"100.8825707137537`", ",", "198.23390338446146`"}], "}"}], 
         ",", "3"}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"24", ",", "2", ",", 
         RowBox[{"{", 
          RowBox[{"102.91118693187303`", ",", "199.8399639722742`"}], "}"}], 
         ",", "3"}], "}"}]}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"25", ",", "2", ",", 
         RowBox[{"{", 
          RowBox[{"97.08881306812697`", ",", "200.1600360277258`"}], "}"}], 
         ",", "4"}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"26", ",", "2", ",", 
         RowBox[{"{", 
          RowBox[{"99.1174292862463`", ",", "201.76609661553854`"}], "}"}], 
         ",", "4"}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"27", ",", "2", ",", 
         RowBox[{"{", 
          RowBox[{"99.56949070968335`", ",", "200.1600360277258`"}], "}"}], 
         ",", "4"}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"28", ",", "2", ",", 
         RowBox[{"{", 
          RowBox[{"100.43050929031665`", ",", "201.76609661553854`"}], "}"}], 
         ",", "4"}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"29", ",", "2", ",", 
         RowBox[{"{", 
          RowBox[{"100.8825707137537`", ",", "200.1600360277258`"}], "}"}], 
         ",", "4"}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"30", ",", "2", ",", 
         RowBox[{"{", 
          RowBox[{"102.91118693187303`", ",", "201.76609661553854`"}], "}"}], 
         ",", "4"}], "}"}]}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"31", ",", "2", ",", 
         RowBox[{"{", 
          RowBox[{"98.71936935214858`", ",", "198.23390338446146`"}], "}"}], 
         ",", "5"}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"32", ",", "2", ",", 
         RowBox[{"{", 
          RowBox[{"100.74798557026791`", ",", "199.8399639722742`"}], "}"}], 
         ",", "5"}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"33", ",", "2", ",", 
         RowBox[{"{", 
          RowBox[{"101.20004699370496`", ",", "198.23390338446146`"}], "}"}], 
         ",", "5"}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"34", ",", "2", ",", 
         RowBox[{"{", 
          RowBox[{"102.06106557433826`", ",", "199.8399639722742`"}], "}"}], 
         ",", "5"}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"35", ",", "2", ",", 
         RowBox[{"{", 
          RowBox[{"102.5131269977753`", ",", "198.23390338446146`"}], "}"}], 
         ",", "5"}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"36", ",", "2", ",", 
         RowBox[{"{", 
          RowBox[{"104.54174321589464`", ",", "199.8399639722742`"}], "}"}], 
         ",", "5"}], "}"}]}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"37", ",", "2", ",", 
         RowBox[{"{", 
          RowBox[{"98.71936935214858`", ",", "200.1600360277258`"}], "}"}], 
         ",", "6"}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"38", ",", "2", ",", 
         RowBox[{"{", 
          RowBox[{"100.74798557026791`", ",", "201.76609661553854`"}], "}"}], 
         ",", "6"}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"39", ",", "2", ",", 
         RowBox[{"{", 
          RowBox[{"101.20004699370496`", ",", "200.1600360277258`"}], "}"}], 
         ",", "6"}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"40", ",", "2", ",", 
         RowBox[{"{", 
          RowBox[{"102.06106557433826`", ",", "201.76609661553854`"}], "}"}], 
         ",", "6"}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"41", ",", "2", ",", 
         RowBox[{"{", 
          RowBox[{"102.5131269977753`", ",", "200.1600360277258`"}], "}"}], 
         ",", "6"}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"42", ",", "2", ",", 
         RowBox[{"{", 
          RowBox[{"104.54174321589464`", ",", "201.76609661553854`"}], "}"}], 
         ",", "6"}], "}"}]}], "}"}]}], "}"}]}], "}"}]], "Output"]
}, Open  ]],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", " ", 
   RowBox[{
    RowBox[{
    "The", " ", "result", " ", "is", " ", "a", " ", "list", " ", "of", " ", 
     "timeslices", " ", "that", " ", "is", " ", "a", " ", "list", " ", "of", 
     " ", "list", " ", "of", " ", "nodes"}], ",", " ", 
    RowBox[{
    "every", " ", "list", " ", "of", " ", "nodes", " ", "associated", " ", 
     "with", " ", "a", " ", "specific", " ", "date", " ", "in", " ", "the", 
     " ", "future"}]}], " ", "*)"}], " "}]], "Input"],

Cell[BoxData[
 RowBox[{"(*", " ", 
  RowBox[{"Structure", " ", "of", " ", "the", " ", 
   RowBox[{"nodelist", " ", ":", " ", 
    RowBox[{"{", 
     RowBox[{"nodeindex", ",", " ", "date", ",", " ", 
      RowBox[{"value", "=", 
       RowBox[{"{", 
        RowBox[{"x1", ",", "...", ",", "xn"}], "}"}]}], ",", " ", 
      "nodeindexorigin"}], "}"}]}]}], " ", "*)"}]], "Input"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"Timing", "[", 
  RowBox[{
   RowBox[{"tree1", "=", 
    RowBox[{"GenerateTree", "[", 
     RowBox[{
      RowBox[{"FromDistributionTree", "[", 
       RowBox[{
        RowBox[{"{", "\"\<equity\>\"", "}"}], ",", 
        RowBox[{"{", "250", "}"}], ",", 
        RowBox[{"{", "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{"{", 
           RowBox[{
            RowBox[{"StudentTDistributionD", "[", "1.1", "]"}], ",", "1", ",",
             "3"}], "}"}], ",", 
          RowBox[{"{", 
           RowBox[{
            RowBox[{"StudentTDistributionD", "[", "1.1", "]"}], ",", "1", ",",
             "2"}], "}"}], ",", "\[IndentingNewLine]", 
          RowBox[{"{", 
           RowBox[{
            RowBox[{"StudentTDistributionD", "[", "1.1", "]"}], ",", "1", ",",
             "3"}], "}"}], ",", 
          RowBox[{"{", 
           RowBox[{
            RowBox[{"StudentTDistributionD", "[", "1.1", "]"}], ",", "1", ",",
             "2"}], "}"}]}], "\[IndentingNewLine]", "}"}]}], "]"}], ",", 
      "0"}], "]"}]}], ";", 
   RowBox[{"Print", "[", "tree1", "]"}], ";", "\[IndentingNewLine]", "\t", 
   RowBox[{
    RowBox[{"ToString", "[", 
     RowBox[{
      RowBox[{"Length", "[", "tree1", "]"}], "-", "1"}], "]"}], "<>", 
    "\"\< stages \>\"", " ", "<>", " ", 
    RowBox[{"ToString", "[", 
     RowBox[{"Length", "[", 
      RowBox[{"Flatten", "[", 
       RowBox[{"tree1", ",", "2"}], "]"}], "]"}], "]"}], "<>", 
    "\"\< nodes\>\""}]}], "]"}]], "Input"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{"{", 
    RowBox[{"{", 
     RowBox[{"{", 
      RowBox[{"0", ",", "0", ",", 
       RowBox[{"{", "250", "}"}], ",", "0"}], "}"}], "}"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"1", ",", "1", ",", 
        RowBox[{"{", "248.36944371597838`", "}"}], ",", "0"}], "}"}], ",", 
      RowBox[{"{", 
       RowBox[{"2", ",", "1", ",", 
        RowBox[{"{", "250", "}"}], ",", "0"}], "}"}], ",", 
      RowBox[{"{", 
       RowBox[{"3", ",", "1", ",", 
        RowBox[{"{", "251.63055628402162`", "}"}], ",", "0"}], "}"}]}], "}"}],
     "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"4", ",", "2", ",", 
         RowBox[{"{", "247.4063773943462`", "}"}], ",", "1"}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"5", ",", "2", ",", 
         RowBox[{"{", "249.33251003761055`", "}"}], ",", "1"}], "}"}]}], 
      "}"}], ",", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"6", ",", "2", ",", 
         RowBox[{"{", "249.03693367836783`", "}"}], ",", "2"}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"7", ",", "2", ",", 
         RowBox[{"{", "250.96306632163217`", "}"}], ",", "2"}], "}"}]}], 
      "}"}], ",", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"8", ",", "2", ",", 
         RowBox[{"{", "250.66748996238945`", "}"}], ",", "3"}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"9", ",", "2", ",", 
         RowBox[{"{", "252.5936226056538`", "}"}], ",", "3"}], "}"}]}], 
      "}"}]}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"10", ",", "3", ",", 
         RowBox[{"{", "245.77582111032459`", "}"}], ",", "4"}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"11", ",", "3", ",", 
         RowBox[{"{", "247.4063773943462`", "}"}], ",", "4"}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"12", ",", "3", ",", 
         RowBox[{"{", "249.03693367836783`", "}"}], ",", "4"}], "}"}]}], 
      "}"}], ",", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"13", ",", "3", ",", 
         RowBox[{"{", "247.70195375358892`", "}"}], ",", "5"}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"14", ",", "3", ",", 
         RowBox[{"{", "249.33251003761055`", "}"}], ",", "5"}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"15", ",", "3", ",", 
         RowBox[{"{", "250.96306632163217`", "}"}], ",", "5"}], "}"}]}], 
      "}"}], ",", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"16", ",", "3", ",", 
         RowBox[{"{", "247.4063773943462`", "}"}], ",", "6"}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"17", ",", "3", ",", 
         RowBox[{"{", "249.03693367836783`", "}"}], ",", "6"}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"18", ",", "3", ",", 
         RowBox[{"{", "250.66748996238945`", "}"}], ",", "6"}], "}"}]}], 
      "}"}], ",", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"19", ",", "3", ",", 
         RowBox[{"{", "249.33251003761055`", "}"}], ",", "7"}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"20", ",", "3", ",", 
         RowBox[{"{", "250.96306632163217`", "}"}], ",", "7"}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"21", ",", "3", ",", 
         RowBox[{"{", "252.5936226056538`", "}"}], ",", "7"}], "}"}]}], "}"}],
      ",", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"22", ",", "3", ",", 
         RowBox[{"{", "249.03693367836783`", "}"}], ",", "8"}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"23", ",", "3", ",", 
         RowBox[{"{", "250.66748996238945`", "}"}], ",", "8"}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"24", ",", "3", ",", 
         RowBox[{"{", "252.29804624641108`", "}"}], ",", "8"}], "}"}]}], 
      "}"}], ",", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"25", ",", "3", ",", 
         RowBox[{"{", "250.96306632163217`", "}"}], ",", "9"}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"26", ",", "3", ",", 
         RowBox[{"{", "252.5936226056538`", "}"}], ",", "9"}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"27", ",", "3", ",", 
         RowBox[{"{", "254.22417888967541`", "}"}], ",", "9"}], "}"}]}], 
      "}"}]}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"28", ",", "4", ",", 
         RowBox[{"{", "244.81275478869242`", "}"}], ",", "10"}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"29", ",", "4", ",", 
         RowBox[{"{", "246.73888743195675`", "}"}], ",", "10"}], "}"}]}], 
      "}"}], ",", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"30", ",", "4", ",", 
         RowBox[{"{", "246.44331107271404`", "}"}], ",", "11"}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"31", ",", "4", ",", 
         RowBox[{"{", "248.36944371597838`", "}"}], ",", "11"}], "}"}]}], 
      "}"}], ",", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"32", ",", "4", ",", 
         RowBox[{"{", "248.07386735673566`", "}"}], ",", "12"}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"33", ",", "4", ",", 
         RowBox[{"{", "250.`", "}"}], ",", "12"}], "}"}]}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"34", ",", "4", ",", 
         RowBox[{"{", "246.73888743195675`", "}"}], ",", "13"}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"35", ",", "4", ",", 
         RowBox[{"{", "248.6650200752211`", "}"}], ",", "13"}], "}"}]}], 
      "}"}], ",", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"36", ",", "4", ",", 
         RowBox[{"{", "248.36944371597838`", "}"}], ",", "14"}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"37", ",", "4", ",", 
         RowBox[{"{", "250.29557635924272`", "}"}], ",", "14"}], "}"}]}], 
      "}"}], ",", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"38", ",", "4", ",", 
         RowBox[{"{", "250.`", "}"}], ",", "15"}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"39", ",", "4", ",", 
         RowBox[{"{", "251.92613264326434`", "}"}], ",", "15"}], "}"}]}], 
      "}"}], ",", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"40", ",", "4", ",", 
         RowBox[{"{", "246.44331107271404`", "}"}], ",", "16"}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"41", ",", "4", ",", 
         RowBox[{"{", "248.36944371597838`", "}"}], ",", "16"}], "}"}]}], 
      "}"}], ",", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"42", ",", "4", ",", 
         RowBox[{"{", "248.07386735673566`", "}"}], ",", "17"}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"43", ",", "4", ",", 
         RowBox[{"{", "250.`", "}"}], ",", "17"}], "}"}]}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"44", ",", "4", ",", 
         RowBox[{"{", "249.70442364075728`", "}"}], ",", "18"}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"45", ",", "4", ",", 
         RowBox[{"{", "251.63055628402162`", "}"}], ",", "18"}], "}"}]}], 
      "}"}], ",", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"46", ",", "4", ",", 
         RowBox[{"{", "248.36944371597838`", "}"}], ",", "19"}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"47", ",", "4", ",", 
         RowBox[{"{", "250.29557635924272`", "}"}], ",", "19"}], "}"}]}], 
      "}"}], ",", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"48", ",", "4", ",", 
         RowBox[{"{", "250.`", "}"}], ",", "20"}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"49", ",", "4", ",", 
         RowBox[{"{", "251.92613264326434`", "}"}], ",", "20"}], "}"}]}], 
      "}"}], ",", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"50", ",", "4", ",", 
         RowBox[{"{", "251.63055628402162`", "}"}], ",", "21"}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"51", ",", "4", ",", 
         RowBox[{"{", "253.55668892728596`", "}"}], ",", "21"}], "}"}]}], 
      "}"}], ",", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"52", ",", "4", ",", 
         RowBox[{"{", "248.07386735673566`", "}"}], ",", "22"}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"53", ",", "4", ",", 
         RowBox[{"{", "250.`", "}"}], ",", "22"}], "}"}]}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"54", ",", "4", ",", 
         RowBox[{"{", "249.70442364075728`", "}"}], ",", "23"}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"55", ",", "4", ",", 
         RowBox[{"{", "251.63055628402162`", "}"}], ",", "23"}], "}"}]}], 
      "}"}], ",", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"56", ",", "4", ",", 
         RowBox[{"{", "251.3349799247789`", "}"}], ",", "24"}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"57", ",", "4", ",", 
         RowBox[{"{", "253.26111256804325`", "}"}], ",", "24"}], "}"}]}], 
      "}"}], ",", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"58", ",", "4", ",", 
         RowBox[{"{", "250.`", "}"}], ",", "25"}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"59", ",", "4", ",", 
         RowBox[{"{", "251.92613264326434`", "}"}], ",", "25"}], "}"}]}], 
      "}"}], ",", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"60", ",", "4", ",", 
         RowBox[{"{", "251.63055628402162`", "}"}], ",", "26"}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"61", ",", "4", ",", 
         RowBox[{"{", "253.55668892728596`", "}"}], ",", "26"}], "}"}]}], 
      "}"}], ",", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"62", ",", "4", ",", 
         RowBox[{"{", "253.26111256804325`", "}"}], ",", "27"}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"63", ",", "4", ",", 
         RowBox[{"{", "255.18724521130758`", "}"}], ",", "27"}], "}"}]}], 
      "}"}]}], "}"}]}], "}"}]], "Print"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{"0.5709999999999997`", " ", "Second"}], 
   ",", "\<\"4 stages 64 nodes\"\>"}], "}"}]], "Output"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"Timing", "[", 
  RowBox[{
   RowBox[{"tree1", "=", 
    RowBox[{"GenerateTree", "[", 
     RowBox[{
      RowBox[{"FromDistributionTree", "[", 
       RowBox[{
        RowBox[{"{", "\"\<equity\>\"", "}"}], ",", 
        RowBox[{"{", "100", "}"}], ",", 
        RowBox[{"{", "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{"{", 
           RowBox[{
            RowBox[{"StudentTDistributionD", "[", "1.1", "]"}], ",", "1", ",",
             "3"}], "}"}], ",", 
          RowBox[{"{", 
           RowBox[{
            RowBox[{"StudentTDistributionD", "[", "1.1", "]"}], ",", "1", ",",
             "2"}], "}"}], ",", "\[IndentingNewLine]", 
          RowBox[{"{", 
           RowBox[{
            RowBox[{"StudentTDistributionD", "[", "1.1", "]"}], ",", "1", ",",
             "3"}], "}"}], ",", 
          RowBox[{"{", 
           RowBox[{
            RowBox[{"StudentTDistributionD", "[", "1.1", "]"}], ",", "1", ",",
             "2"}], "}"}], ",", "\[IndentingNewLine]", 
          RowBox[{"{", 
           RowBox[{
            RowBox[{"StudentTDistributionD", "[", "1.1", "]"}], ",", "1", ",",
             "2"}], "}"}], ",", 
          RowBox[{"{", 
           RowBox[{
            RowBox[{"StudentTDistributionD", "[", "1.1", "]"}], ",", "1", ",",
             "2"}], "}"}], ",", "\[IndentingNewLine]", 
          RowBox[{"{", 
           RowBox[{
            RowBox[{"StudentTDistributionD", "[", "1.1", "]"}], ",", "1", ",",
             "2"}], "}"}], ",", 
          RowBox[{"{", 
           RowBox[{
            RowBox[{"StudentTDistributionD", "[", "1.1", "]"}], ",", "1", ",",
             "2"}], "}"}], ",", "\[IndentingNewLine]", 
          RowBox[{"{", 
           RowBox[{
            RowBox[{"StudentTDistributionD", "[", "1.1", "]"}], ",", "1", ",",
             "2"}], "}"}], ",", 
          RowBox[{"{", 
           RowBox[{
            RowBox[{"StudentTDistributionD", "[", "1.1", "]"}], ",", "1", ",",
             "3"}], "}"}]}], "\[IndentingNewLine]", "}"}]}], "]"}], ",", 
      "0"}], "]"}]}], ";", "\[IndentingNewLine]", "\t", 
   RowBox[{
    RowBox[{"ToString", "[", 
     RowBox[{
      RowBox[{"Length", "[", "tree1", "]"}], "-", "1"}], "]"}], "<>", 
    "\"\< stages \>\"", " ", "<>", " ", 
    RowBox[{"ToString", "[", 
     RowBox[{"Length", "[", 
      RowBox[{"Flatten", "[", 
       RowBox[{"tree1", ",", "2"}], "]"}], "]"}], "]"}], "<>", 
    "\"\< nodes\>\""}]}], "]"}]], "Input"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{"51.995000000000005`", " ", "Second"}], 
   ",", "\<\"10 stages 5752 nodes\"\>"}], "}"}]], "Output"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"x", "=", 
  RowBox[{"FromDistributionTree", "[", 
   RowBox[{
    RowBox[{"{", "\"\<equity\>\"", "}"}], ",", 
    RowBox[{"{", "250", "}"}], ",", 
    RowBox[{"{", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{
        RowBox[{"StudentTDistributionD", "[", "1.1", "]"}], ",", "1", ",", 
        "3"}], "}"}], ",", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"StudentTDistributionD", "[", "1.1", "]"}], ",", "1", ",", 
        "2"}], "}"}], ",", "\[IndentingNewLine]", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"StudentTDistributionD", "[", "1.1", "]"}], ",", "1", ",", 
        "3"}], "}"}], ",", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"StudentTDistributionD", "[", "1.1", "]"}], ",", "1", ",", 
        "2"}], "}"}]}], "\[IndentingNewLine]", "}"}]}], "]"}]}]], "Input"],

Cell[BoxData[
 RowBox[{"FromDistributionTree", "[", 
  RowBox[{
   RowBox[{"{", "\<\"equity\"\>", "}"}], ",", 
   RowBox[{"{", "250", "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
       RowBox[{"StudentTDistributionD", "[", "1.1`", "]"}], ",", "1", ",", 
       "3"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"StudentTDistributionD", "[", "1.1`", "]"}], ",", "1", ",", 
       "2"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"StudentTDistributionD", "[", "1.1`", "]"}], ",", "1", ",", 
       "3"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"StudentTDistributionD", "[", "1.1`", "]"}], ",", "1", ",", 
       "2"}], "}"}]}], "}"}]}], "]"}]], "Output"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"GenerateTree", "[", 
  RowBox[{"x", ",", "0"}], "]"}]], "Input"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{"{", 
    RowBox[{"{", 
     RowBox[{"{", 
      RowBox[{"0", ",", "0", ",", 
       RowBox[{"{", "250", "}"}], ",", "0"}], "}"}], "}"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"1", ",", "1", ",", 
        RowBox[{"{", "248.36944371597838`", "}"}], ",", "0"}], "}"}], ",", 
      RowBox[{"{", 
       RowBox[{"2", ",", "1", ",", 
        RowBox[{"{", "250", "}"}], ",", "0"}], "}"}], ",", 
      RowBox[{"{", 
       RowBox[{"3", ",", "1", ",", 
        RowBox[{"{", "251.63055628402162`", "}"}], ",", "0"}], "}"}]}], "}"}],
     "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"4", ",", "2", ",", 
         RowBox[{"{", "247.4063773943462`", "}"}], ",", "1"}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"5", ",", "2", ",", 
         RowBox[{"{", "249.33251003761055`", "}"}], ",", "1"}], "}"}]}], 
      "}"}], ",", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"6", ",", "2", ",", 
         RowBox[{"{", "249.03693367836783`", "}"}], ",", "2"}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"7", ",", "2", ",", 
         RowBox[{"{", "250.96306632163217`", "}"}], ",", "2"}], "}"}]}], 
      "}"}], ",", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"8", ",", "2", ",", 
         RowBox[{"{", "250.66748996238945`", "}"}], ",", "3"}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"9", ",", "2", ",", 
         RowBox[{"{", "252.5936226056538`", "}"}], ",", "3"}], "}"}]}], 
      "}"}]}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"10", ",", "3", ",", 
         RowBox[{"{", "245.77582111032459`", "}"}], ",", "4"}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"11", ",", "3", ",", 
         RowBox[{"{", "247.4063773943462`", "}"}], ",", "4"}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"12", ",", "3", ",", 
         RowBox[{"{", "249.03693367836783`", "}"}], ",", "4"}], "}"}]}], 
      "}"}], ",", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"13", ",", "3", ",", 
         RowBox[{"{", "247.70195375358892`", "}"}], ",", "5"}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"14", ",", "3", ",", 
         RowBox[{"{", "249.33251003761055`", "}"}], ",", "5"}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"15", ",", "3", ",", 
         RowBox[{"{", "250.96306632163217`", "}"}], ",", "5"}], "}"}]}], 
      "}"}], ",", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"16", ",", "3", ",", 
         RowBox[{"{", "247.4063773943462`", "}"}], ",", "6"}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"17", ",", "3", ",", 
         RowBox[{"{", "249.03693367836783`", "}"}], ",", "6"}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"18", ",", "3", ",", 
         RowBox[{"{", "250.66748996238945`", "}"}], ",", "6"}], "}"}]}], 
      "}"}], ",", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"19", ",", "3", ",", 
         RowBox[{"{", "249.33251003761055`", "}"}], ",", "7"}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"20", ",", "3", ",", 
         RowBox[{"{", "250.96306632163217`", "}"}], ",", "7"}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"21", ",", "3", ",", 
         RowBox[{"{", "252.5936226056538`", "}"}], ",", "7"}], "}"}]}], "}"}],
      ",", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"22", ",", "3", ",", 
         RowBox[{"{", "249.03693367836783`", "}"}], ",", "8"}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"23", ",", "3", ",", 
         RowBox[{"{", "250.66748996238945`", "}"}], ",", "8"}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"24", ",", "3", ",", 
         RowBox[{"{", "252.29804624641108`", "}"}], ",", "8"}], "}"}]}], 
      "}"}], ",", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"25", ",", "3", ",", 
         RowBox[{"{", "250.96306632163217`", "}"}], ",", "9"}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"26", ",", "3", ",", 
         RowBox[{"{", "252.5936226056538`", "}"}], ",", "9"}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"27", ",", "3", ",", 
         RowBox[{"{", "254.22417888967541`", "}"}], ",", "9"}], "}"}]}], 
      "}"}]}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"28", ",", "4", ",", 
         RowBox[{"{", "244.81275478869242`", "}"}], ",", "10"}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"29", ",", "4", ",", 
         RowBox[{"{", "246.73888743195675`", "}"}], ",", "10"}], "}"}]}], 
      "}"}], ",", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"30", ",", "4", ",", 
         RowBox[{"{", "246.44331107271404`", "}"}], ",", "11"}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"31", ",", "4", ",", 
         RowBox[{"{", "248.36944371597838`", "}"}], ",", "11"}], "}"}]}], 
      "}"}], ",", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"32", ",", "4", ",", 
         RowBox[{"{", "248.07386735673566`", "}"}], ",", "12"}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"33", ",", "4", ",", 
         RowBox[{"{", "250.`", "}"}], ",", "12"}], "}"}]}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"34", ",", "4", ",", 
         RowBox[{"{", "246.73888743195675`", "}"}], ",", "13"}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"35", ",", "4", ",", 
         RowBox[{"{", "248.6650200752211`", "}"}], ",", "13"}], "}"}]}], 
      "}"}], ",", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"36", ",", "4", ",", 
         RowBox[{"{", "248.36944371597838`", "}"}], ",", "14"}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"37", ",", "4", ",", 
         RowBox[{"{", "250.29557635924272`", "}"}], ",", "14"}], "}"}]}], 
      "}"}], ",", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"38", ",", "4", ",", 
         RowBox[{"{", "250.`", "}"}], ",", "15"}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"39", ",", "4", ",", 
         RowBox[{"{", "251.92613264326434`", "}"}], ",", "15"}], "}"}]}], 
      "}"}], ",", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"40", ",", "4", ",", 
         RowBox[{"{", "246.44331107271404`", "}"}], ",", "16"}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"41", ",", "4", ",", 
         RowBox[{"{", "248.36944371597838`", "}"}], ",", "16"}], "}"}]}], 
      "}"}], ",", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"42", ",", "4", ",", 
         RowBox[{"{", "248.07386735673566`", "}"}], ",", "17"}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"43", ",", "4", ",", 
         RowBox[{"{", "250.`", "}"}], ",", "17"}], "}"}]}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"44", ",", "4", ",", 
         RowBox[{"{", "249.70442364075728`", "}"}], ",", "18"}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"45", ",", "4", ",", 
         RowBox[{"{", "251.63055628402162`", "}"}], ",", "18"}], "}"}]}], 
      "}"}], ",", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"46", ",", "4", ",", 
         RowBox[{"{", "248.36944371597838`", "}"}], ",", "19"}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"47", ",", "4", ",", 
         RowBox[{"{", "250.29557635924272`", "}"}], ",", "19"}], "}"}]}], 
      "}"}], ",", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"48", ",", "4", ",", 
         RowBox[{"{", "250.`", "}"}], ",", "20"}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"49", ",", "4", ",", 
         RowBox[{"{", "251.92613264326434`", "}"}], ",", "20"}], "}"}]}], 
      "}"}], ",", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"50", ",", "4", ",", 
         RowBox[{"{", "251.63055628402162`", "}"}], ",", "21"}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"51", ",", "4", ",", 
         RowBox[{"{", "253.55668892728596`", "}"}], ",", "21"}], "}"}]}], 
      "}"}], ",", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"52", ",", "4", ",", 
         RowBox[{"{", "248.07386735673566`", "}"}], ",", "22"}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"53", ",", "4", ",", 
         RowBox[{"{", "250.`", "}"}], ",", "22"}], "}"}]}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"54", ",", "4", ",", 
         RowBox[{"{", "249.70442364075728`", "}"}], ",", "23"}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"55", ",", "4", ",", 
         RowBox[{"{", "251.63055628402162`", "}"}], ",", "23"}], "}"}]}], 
      "}"}], ",", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"56", ",", "4", ",", 
         RowBox[{"{", "251.3349799247789`", "}"}], ",", "24"}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"57", ",", "4", ",", 
         RowBox[{"{", "253.26111256804325`", "}"}], ",", "24"}], "}"}]}], 
      "}"}], ",", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"58", ",", "4", ",", 
         RowBox[{"{", "250.`", "}"}], ",", "25"}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"59", ",", "4", ",", 
         RowBox[{"{", "251.92613264326434`", "}"}], ",", "25"}], "}"}]}], 
      "}"}], ",", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"60", ",", "4", ",", 
         RowBox[{"{", "251.63055628402162`", "}"}], ",", "26"}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"61", ",", "4", ",", 
         RowBox[{"{", "253.55668892728596`", "}"}], ",", "26"}], "}"}]}], 
      "}"}], ",", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"62", ",", "4", ",", 
         RowBox[{"{", "253.26111256804325`", "}"}], ",", "27"}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"63", ",", "4", ",", 
         RowBox[{"{", "255.18724521130758`", "}"}], ",", "27"}], "}"}]}], 
      "}"}]}], "}"}]}], "}"}]], "Output"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"x", "=", 
  RowBox[{"NormalRankCombineSpaces", "[", 
   RowBox[{
    RowBox[{"{", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"FromDistributionTree", "[", 
       RowBox[{
        RowBox[{"{", "\"\<equity\>\"", "}"}], ",", 
        RowBox[{"{", "100", "}"}], ",", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{"{", 
           RowBox[{
            RowBox[{"StudentTDistributionD", "[", "1.1", "]"}], ",", "1", ",",
             "3"}], "}"}], ",", 
          RowBox[{"{", 
           RowBox[{
            RowBox[{"StudentTDistributionD", "[", "1.1", "]"}], ",", "1", ",",
             "3"}], "}"}]}], "}"}]}], "]"}], ",", "\[IndentingNewLine]", 
      RowBox[{"FromDistributionTree", "[", 
       RowBox[{
        RowBox[{"{", "\"\<IR\>\"", "}"}], ",", 
        RowBox[{"{", "200", "}"}], ",", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{"{", 
           RowBox[{
            RowBox[{"StudentTDistributionD", "[", "1.1", "]"}], ",", "1", ",",
             "2"}], "}"}], ",", 
          RowBox[{"{", 
           RowBox[{
            RowBox[{"StudentTDistributionD", "[", "1.1", "]"}], ",", "1", ",",
             "2"}], "}"}]}], "}"}]}], "]"}]}], "\[IndentingNewLine]", "}"}], 
    ",", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"1", ",", "0.5"}], "}"}], ",", 
      RowBox[{"{", 
       RowBox[{"0.5", ",", "1"}], "}"}]}], "}"}]}], "]"}]}]], "Input"],

Cell[BoxData[
 RowBox[{"NormalRankCombineSpaces", "[", 
  RowBox[{
   RowBox[{"{", 
    RowBox[{
     RowBox[{"FromDistributionTree", "[", 
      RowBox[{
       RowBox[{"{", "\<\"equity\"\>", "}"}], ",", 
       RowBox[{"{", "100", "}"}], ",", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{
           RowBox[{"StudentTDistributionD", "[", "1.1`", "]"}], ",", "1", ",",
            "3"}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{"StudentTDistributionD", "[", "1.1`", "]"}], ",", "1", ",",
            "3"}], "}"}]}], "}"}]}], "]"}], ",", 
     RowBox[{"FromDistributionTree", "[", 
      RowBox[{
       RowBox[{"{", "\<\"IR\"\>", "}"}], ",", 
       RowBox[{"{", "200", "}"}], ",", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{
           RowBox[{"StudentTDistributionD", "[", "1.1`", "]"}], ",", "1", ",",
            "2"}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{"StudentTDistributionD", "[", "1.1`", "]"}], ",", "1", ",",
            "2"}], "}"}]}], "}"}]}], "]"}]}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"1", ",", "0.5`"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"0.5`", ",", "1"}], "}"}]}], "}"}]}], "]"}]], "Output"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"GenerateTree", "[", 
  RowBox[{"x", ",", "0"}], "]"}]], "Input"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{"{", 
    RowBox[{"{", 
     RowBox[{"{", 
      RowBox[{"0", ",", "0", ",", 
       RowBox[{"{", 
        RowBox[{"100", ",", "200"}], "}"}], ",", "0"}], "}"}], "}"}], "}"}], 
   ",", 
   RowBox[{"{", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"1", ",", "1", ",", 
        RowBox[{"{", 
         RowBox[{"97.08881306812697`", ",", "199.19696970609363`"}], "}"}], 
        ",", "0"}], "}"}], ",", 
      RowBox[{"{", 
       RowBox[{"2", ",", "1", ",", 
        RowBox[{"{", 
         RowBox[{"99.1174292862463`", ",", "200.80303029390637`"}], "}"}], 
        ",", "0"}], "}"}], ",", 
      RowBox[{"{", 
       RowBox[{"3", ",", "1", ",", 
        RowBox[{"{", 
         RowBox[{"99.56949070968335`", ",", "199.19696970609363`"}], "}"}], 
        ",", "0"}], "}"}], ",", 
      RowBox[{"{", 
       RowBox[{"4", ",", "1", ",", 
        RowBox[{"{", 
         RowBox[{"100.43050929031665`", ",", "200.80303029390637`"}], "}"}], 
        ",", "0"}], "}"}], ",", 
      RowBox[{"{", 
       RowBox[{"5", ",", "1", ",", 
        RowBox[{"{", 
         RowBox[{"100.8825707137537`", ",", "199.19696970609363`"}], "}"}], 
        ",", "0"}], "}"}], ",", 
      RowBox[{"{", 
       RowBox[{"6", ",", "1", ",", 
        RowBox[{"{", 
         RowBox[{"102.91118693187303`", ",", "200.80303029390637`"}], "}"}], 
        ",", "0"}], "}"}]}], "}"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"7", ",", "2", ",", 
         RowBox[{"{", 
          RowBox[{"95.45825678410536`", ",", "198.23390338446146`"}], "}"}], 
         ",", "1"}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"8", ",", "2", ",", 
         RowBox[{"{", 
          RowBox[{"97.4868730022247`", ",", "199.8399639722742`"}], "}"}], 
         ",", "1"}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"9", ",", "2", ",", 
         RowBox[{"{", 
          RowBox[{"97.93893442566174`", ",", "198.23390338446146`"}], "}"}], 
         ",", "1"}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"10", ",", "2", ",", 
         RowBox[{"{", 
          RowBox[{"98.79995300629504`", ",", "199.8399639722742`"}], "}"}], 
         ",", "1"}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"11", ",", "2", ",", 
         RowBox[{"{", 
          RowBox[{"99.25201442973209`", ",", "198.23390338446146`"}], "}"}], 
         ",", "1"}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"12", ",", "2", ",", 
         RowBox[{"{", 
          RowBox[{"101.28063064785142`", ",", "199.8399639722742`"}], "}"}], 
         ",", "1"}], "}"}]}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"13", ",", "2", ",", 
         RowBox[{"{", 
          RowBox[{"95.45825678410536`", ",", "200.1600360277258`"}], "}"}], 
         ",", "2"}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"14", ",", "2", ",", 
         RowBox[{"{", 
          RowBox[{"97.4868730022247`", ",", "201.76609661553854`"}], "}"}], 
         ",", "2"}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"15", ",", "2", ",", 
         RowBox[{"{", 
          RowBox[{"97.93893442566174`", ",", "200.1600360277258`"}], "}"}], 
         ",", "2"}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"16", ",", "2", ",", 
         RowBox[{"{", 
          RowBox[{"98.79995300629504`", ",", "201.76609661553854`"}], "}"}], 
         ",", "2"}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"17", ",", "2", ",", 
         RowBox[{"{", 
          RowBox[{"99.25201442973209`", ",", "200.1600360277258`"}], "}"}], 
         ",", "2"}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"18", ",", "2", ",", 
         RowBox[{"{", 
          RowBox[{"101.28063064785142`", ",", "201.76609661553854`"}], "}"}], 
         ",", "2"}], "}"}]}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"19", ",", "2", ",", 
         RowBox[{"{", 
          RowBox[{"97.08881306812697`", ",", "198.23390338446146`"}], "}"}], 
         ",", "3"}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"20", ",", "2", ",", 
         RowBox[{"{", 
          RowBox[{"99.1174292862463`", ",", "199.8399639722742`"}], "}"}], 
         ",", "3"}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"21", ",", "2", ",", 
         RowBox[{"{", 
          RowBox[{"99.56949070968335`", ",", "198.23390338446146`"}], "}"}], 
         ",", "3"}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"22", ",", "2", ",", 
         RowBox[{"{", 
          RowBox[{"100.43050929031665`", ",", "199.8399639722742`"}], "}"}], 
         ",", "3"}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"23", ",", "2", ",", 
         RowBox[{"{", 
          RowBox[{"100.8825707137537`", ",", "198.23390338446146`"}], "}"}], 
         ",", "3"}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"24", ",", "2", ",", 
         RowBox[{"{", 
          RowBox[{"102.91118693187303`", ",", "199.8399639722742`"}], "}"}], 
         ",", "3"}], "}"}]}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"25", ",", "2", ",", 
         RowBox[{"{", 
          RowBox[{"97.08881306812697`", ",", "200.1600360277258`"}], "}"}], 
         ",", "4"}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"26", ",", "2", ",", 
         RowBox[{"{", 
          RowBox[{"99.1174292862463`", ",", "201.76609661553854`"}], "}"}], 
         ",", "4"}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"27", ",", "2", ",", 
         RowBox[{"{", 
          RowBox[{"99.56949070968335`", ",", "200.1600360277258`"}], "}"}], 
         ",", "4"}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"28", ",", "2", ",", 
         RowBox[{"{", 
          RowBox[{"100.43050929031665`", ",", "201.76609661553854`"}], "}"}], 
         ",", "4"}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"29", ",", "2", ",", 
         RowBox[{"{", 
          RowBox[{"100.8825707137537`", ",", "200.1600360277258`"}], "}"}], 
         ",", "4"}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"30", ",", "2", ",", 
         RowBox[{"{", 
          RowBox[{"102.91118693187303`", ",", "201.76609661553854`"}], "}"}], 
         ",", "4"}], "}"}]}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"31", ",", "2", ",", 
         RowBox[{"{", 
          RowBox[{"98.71936935214858`", ",", "198.23390338446146`"}], "}"}], 
         ",", "5"}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"32", ",", "2", ",", 
         RowBox[{"{", 
          RowBox[{"100.74798557026791`", ",", "199.8399639722742`"}], "}"}], 
         ",", "5"}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"33", ",", "2", ",", 
         RowBox[{"{", 
          RowBox[{"101.20004699370496`", ",", "198.23390338446146`"}], "}"}], 
         ",", "5"}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"34", ",", "2", ",", 
         RowBox[{"{", 
          RowBox[{"102.06106557433826`", ",", "199.8399639722742`"}], "}"}], 
         ",", "5"}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"35", ",", "2", ",", 
         RowBox[{"{", 
          RowBox[{"102.5131269977753`", ",", "198.23390338446146`"}], "}"}], 
         ",", "5"}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"36", ",", "2", ",", 
         RowBox[{"{", 
          RowBox[{"104.54174321589464`", ",", "199.8399639722742`"}], "}"}], 
         ",", "5"}], "}"}]}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"37", ",", "2", ",", 
         RowBox[{"{", 
          RowBox[{"98.71936935214858`", ",", "200.1600360277258`"}], "}"}], 
         ",", "6"}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"38", ",", "2", ",", 
         RowBox[{"{", 
          RowBox[{"100.74798557026791`", ",", "201.76609661553854`"}], "}"}], 
         ",", "6"}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"39", ",", "2", ",", 
         RowBox[{"{", 
          RowBox[{"101.20004699370496`", ",", "200.1600360277258`"}], "}"}], 
         ",", "6"}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"40", ",", "2", ",", 
         RowBox[{"{", 
          RowBox[{"102.06106557433826`", ",", "201.76609661553854`"}], "}"}], 
         ",", "6"}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"41", ",", "2", ",", 
         RowBox[{"{", 
          RowBox[{"102.5131269977753`", ",", "200.1600360277258`"}], "}"}], 
         ",", "6"}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"42", ",", "2", ",", 
         RowBox[{"{", 
          RowBox[{"104.54174321589464`", ",", "201.76609661553854`"}], "}"}], 
         ",", "6"}], "}"}]}], "}"}]}], "}"}]}], "}"}]], "Output"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"TimeSeries", "[", 
  RowBox[{
   RowBox[{"ARMAModel", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"1", ",", "2", ",", "3"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"2", ",", "1", ",", 
       RowBox[{"-", "3"}]}], "}"}], ",", "1."}], "]"}], ",", "10"}], 
  "]"}]], "Input"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{"-", "6.241145114871693`"}], ",", 
   RowBox[{"-", "7.174078701203304`"}], ",", 
   RowBox[{"-", "21.11716862202806`"}], ",", 
   RowBox[{"-", "54.99251532293746`"}], ",", 
   RowBox[{"-", "115.9126149476856`"}], ",", 
   RowBox[{"-", "286.76857583100934`"}], ",", 
   RowBox[{"-", "688.9900859503578`"}], ",", 
   RowBox[{"-", "1613.3647085432706`"}], ",", 
   RowBox[{"-", "3844.1944845447274`"}], ",", 
   RowBox[{"-", "9136.398628283623`"}]}], "}"}]], "Output"]
}, Open  ]],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", " ", 
   RowBox[{"paramters", "=", 
    RowBox[{"[", 
     RowBox[{
     "speedDeviation", ",", "sigmaDeviation", ",", "MuLongTerm", ",", 
      "SigmaLongTerm", ",", "rho", ",", "deltaT"}], "]"}]}], " ", "*)"}], 
  "\[IndentingNewLine]", 
  RowBox[{"GenerateTree", "[", 
   RowBox[{
    RowBox[{"FromDistributionTree", "[", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"\"\<Factor1\>\"", ",", "\"\<Factor2\>\""}], "}"}], ",", 
      RowBox[{"{", 
       RowBox[{"10", ",", "100"}], "}"}], ",", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{
          RowBox[{"Schwartz2FactorsDistributionD", "[", 
           RowBox[{
           "0.5", ",", "5", ",", "0.1", ",", "30", ",", "0.", ",", "1."}], 
           "]"}], ",", "1", ",", "3"}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{"Schwartz2FactorsDistributionD", "[", 
           RowBox[{
           "0.5", ",", "5", ",", "0.1", ",", "30", ",", "0.", ",", "1."}], 
           "]"}], ",", "1", ",", "3"}], "}"}]}], "}"}]}], "]"}], ",", "0"}], 
   "]"}]}]], "Input"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"tree2", "=", 
  RowBox[{"CompileProcess", "[", 
   RowBox[{"FromProcessTree", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"\"\<Equity\>\"", ",", "\"\<Spread\>\""}], "}"}], ",", 
     RowBox[{"Schwartz2FactorsProcess", "[", 
      RowBox[{"0.5", ",", "5", ",", "0.1", ",", "30", ",", "0.", ",", "1."}], 
      "]"}], ",", 
     RowBox[{"{", 
      RowBox[{"1", ",", "1", ",", "1"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"2", ",", "2", ",", "2"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"2.", ",", "100"}], "}"}]}], "]"}], "]"}]}]], "Input"],

Cell[BoxData[
 RowBox[{"FromDistributionTree", "[", 
  RowBox[{
   RowBox[{"{", 
    RowBox[{"\<\"Equity\"\>", ",", "\<\"Spread\"\>"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"2.`", ",", "100"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
       RowBox[{"Schwartz2FactorsDistributionD", "[", 
        RowBox[{
        "0.5`", ",", "5", ",", "0.1`", ",", "30", ",", "0.`", ",", "1.`"}], 
        "]"}], ",", "1", ",", "2"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"Schwartz2FactorsDistributionD", "[", 
        RowBox[{
        "0.5`", ",", "5", ",", "0.1`", ",", "30", ",", "0.`", ",", "1.`"}], 
        "]"}], ",", "1", ",", "2"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"Schwartz2FactorsDistributionD", "[", 
        RowBox[{
        "0.5`", ",", "5", ",", "0.1`", ",", "30", ",", "0.`", ",", "1.`"}], 
        "]"}], ",", "1", ",", "2"}], "}"}]}], "}"}]}], "]"}]], "Output"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"GenerateTree", "[", 
  RowBox[{"tree2", ",", "0"}], "]"}]], "Input"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{"{", 
    RowBox[{"{", 
     RowBox[{"{", 
      RowBox[{"0", ",", "0", ",", 
       RowBox[{"{", 
        RowBox[{"2.`", ",", "100"}], "}"}], ",", "0"}], "}"}], "}"}], "}"}], 
   ",", 
   RowBox[{"{", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"1", ",", "1", ",", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{"-", "1.4682381137498561`"}], ",", "79.86530749411754`"}], 
         "}"}], ",", "0"}], "}"}], ",", 
      RowBox[{"{", 
       RowBox[{"2", ",", "1", ",", 
        RowBox[{"{", 
         RowBox[{"3.89436075260039`", ",", "79.86530749411754`"}], "}"}], ",",
         "0"}], "}"}], ",", 
      RowBox[{"{", 
       RowBox[{"3", ",", "1", ",", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{"-", "1.4682381137498561`"}], ",", "120.33469250588244`"}], 
         "}"}], ",", "0"}], "}"}], ",", 
      RowBox[{"{", 
       RowBox[{"4", ",", "1", ",", 
        RowBox[{"{", 
         RowBox[{"3.89436075260039`", ",", "120.33469250588244`"}], "}"}], 
        ",", "0"}], "}"}]}], "}"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"5", ",", "2", ",", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{"-", "3.5718308649230557`"}], ",", "59.73061498823509`"}], 
          "}"}], ",", "1"}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"6", ",", "2", ",", 
         RowBox[{"{", 
          RowBox[{"1.7907680014271903`", ",", "59.73061498823509`"}], "}"}], 
         ",", "1"}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"7", ",", "2", ",", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{"-", "3.5718308649230557`"}], ",", "100.19999999999999`"}],
           "}"}], ",", "1"}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"8", ",", "2", ",", 
         RowBox[{"{", 
          RowBox[{"1.7907680014271903`", ",", "100.19999999999999`"}], "}"}], 
         ",", "1"}], "}"}]}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"9", ",", "2", ",", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{"-", "0.31925023674142095`"}], ",", "59.73061498823509`"}],
           "}"}], ",", "2"}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"10", ",", "2", ",", 
         RowBox[{"{", 
          RowBox[{"5.0433486296088255`", ",", "59.73061498823509`"}], "}"}], 
         ",", "2"}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"11", ",", "2", ",", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{"-", "0.31925023674142095`"}], ",", 
           "100.19999999999999`"}], "}"}], ",", "2"}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"12", ",", "2", ",", 
         RowBox[{"{", 
          RowBox[{"5.0433486296088255`", ",", "100.19999999999999`"}], "}"}], 
         ",", "2"}], "}"}]}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"13", ",", "2", ",", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{"-", "3.5718308649230557`"}], ",", "100.19999999999999`"}],
           "}"}], ",", "3"}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"14", ",", "2", ",", 
         RowBox[{"{", 
          RowBox[{"1.7907680014271903`", ",", "100.19999999999999`"}], "}"}], 
         ",", "3"}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"15", ",", "2", ",", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{"-", "3.5718308649230557`"}], ",", "140.6693850117649`"}], 
          "}"}], ",", "3"}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"16", ",", "2", ",", 
         RowBox[{"{", 
          RowBox[{"1.7907680014271903`", ",", "140.6693850117649`"}], "}"}], 
         ",", "3"}], "}"}]}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"17", ",", "2", ",", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{"-", "0.31925023674142095`"}], ",", 
           "100.19999999999999`"}], "}"}], ",", "4"}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"18", ",", "2", ",", 
         RowBox[{"{", 
          RowBox[{"5.0433486296088255`", ",", "100.19999999999999`"}], "}"}], 
         ",", "4"}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"19", ",", "2", ",", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{"-", "0.31925023674142095`"}], ",", "140.6693850117649`"}],
           "}"}], ",", "4"}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"20", ",", "2", ",", 
         RowBox[{"{", 
          RowBox[{"5.0433486296088255`", ",", "140.6693850117649`"}], "}"}], 
         ",", "4"}], "}"}]}], "}"}]}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"21", ",", "3", ",", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{"-", "4.84772436405885`"}], ",", "39.59592248235264`"}], 
          "}"}], ",", "5"}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"22", ",", "3", ",", 
         RowBox[{"{", 
          RowBox[{"0.5148745022913959`", ",", "39.59592248235264`"}], "}"}], 
         ",", "5"}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"23", ",", "3", ",", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{"-", "4.84772436405885`"}], ",", "80.06530749411755`"}], 
          "}"}], ",", "5"}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"24", ",", "3", ",", 
         RowBox[{"{", 
          RowBox[{"0.5148745022913959`", ",", "80.06530749411755`"}], "}"}], 
         ",", "5"}], "}"}]}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"25", ",", "3", ",", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{"-", "1.5951437358772151`"}], ",", "39.59592248235264`"}], 
          "}"}], ",", "6"}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"26", ",", "3", ",", 
         RowBox[{"{", 
          RowBox[{"3.7674551304730306`", ",", "39.59592248235264`"}], "}"}], 
         ",", "6"}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"27", ",", "3", ",", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{"-", "1.5951437358772151`"}], ",", "80.06530749411755`"}], 
          "}"}], ",", "6"}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"28", ",", "3", ",", 
         RowBox[{"{", 
          RowBox[{"3.7674551304730306`", ",", "80.06530749411755`"}], "}"}], 
         ",", "6"}], "}"}]}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"29", ",", "3", ",", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{"-", "4.84772436405885`"}], ",", "80.06530749411753`"}], 
          "}"}], ",", "7"}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"30", ",", "3", ",", 
         RowBox[{"{", 
          RowBox[{"0.5148745022913959`", ",", "80.06530749411753`"}], "}"}], 
         ",", "7"}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"31", ",", "3", ",", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{"-", "4.84772436405885`"}], ",", "120.53469250588243`"}], 
          "}"}], ",", "7"}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"32", ",", "3", ",", 
         RowBox[{"{", 
          RowBox[{"0.5148745022913959`", ",", "120.53469250588243`"}], "}"}], 
         ",", "7"}], "}"}]}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"33", ",", "3", ",", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{"-", "1.5951437358772151`"}], ",", "80.06530749411753`"}], 
          "}"}], ",", "8"}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"34", ",", "3", ",", 
         RowBox[{"{", 
          RowBox[{"3.7674551304730306`", ",", "80.06530749411753`"}], "}"}], 
         ",", "8"}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"35", ",", "3", ",", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{"-", "1.5951437358772151`"}], ",", "120.53469250588243`"}],
           "}"}], ",", "8"}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"36", ",", "3", ",", 
         RowBox[{"{", 
          RowBox[{"3.7674551304730306`", ",", "120.53469250588243`"}], "}"}], 
         ",", "8"}], "}"}]}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"37", ",", "3", ",", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{"-", "2.8749344898793114`"}], ",", "39.59592248235264`"}], 
          "}"}], ",", "9"}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"38", ",", "3", ",", 
         RowBox[{"{", 
          RowBox[{"2.4876643764709345`", ",", "39.59592248235264`"}], "}"}], 
         ",", "9"}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"39", ",", "3", ",", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{"-", "2.8749344898793114`"}], ",", "80.06530749411755`"}], 
          "}"}], ",", "9"}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"40", ",", "3", ",", 
         RowBox[{"{", 
          RowBox[{"2.4876643764709345`", ",", "80.06530749411755`"}], "}"}], 
         ",", "9"}], "}"}]}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"41", ",", "3", ",", 
         RowBox[{"{", 
          RowBox[{"0.37764613830232374`", ",", "39.59592248235264`"}], "}"}], 
         ",", "10"}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"42", ",", "3", ",", 
         RowBox[{"{", 
          RowBox[{"5.74024500465257`", ",", "39.59592248235264`"}], "}"}], 
         ",", "10"}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"43", ",", "3", ",", 
         RowBox[{"{", 
          RowBox[{"0.37764613830232374`", ",", "80.06530749411755`"}], "}"}], 
         ",", "10"}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"44", ",", "3", ",", 
         RowBox[{"{", 
          RowBox[{"5.74024500465257`", ",", "80.06530749411755`"}], "}"}], 
         ",", "10"}], "}"}]}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"45", ",", "3", ",", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{"-", "2.8749344898793114`"}], ",", "80.06530749411753`"}], 
          "}"}], ",", "11"}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"46", ",", "3", ",", 
         RowBox[{"{", 
          RowBox[{"2.4876643764709345`", ",", "80.06530749411753`"}], "}"}], 
         ",", "11"}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"47", ",", "3", ",", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{"-", "2.8749344898793114`"}], ",", "120.53469250588243`"}],
           "}"}], ",", "11"}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"48", ",", "3", ",", 
         RowBox[{"{", 
          RowBox[{"2.4876643764709345`", ",", "120.53469250588243`"}], "}"}], 
         ",", "11"}], "}"}]}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"49", ",", "3", ",", 
         RowBox[{"{", 
          RowBox[{"0.37764613830232374`", ",", "80.06530749411753`"}], "}"}], 
         ",", "12"}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"50", ",", "3", ",", 
         RowBox[{"{", 
          RowBox[{"5.74024500465257`", ",", "80.06530749411753`"}], "}"}], 
         ",", "12"}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"51", ",", "3", ",", 
         RowBox[{"{", 
          RowBox[{"0.37764613830232374`", ",", "120.53469250588243`"}], "}"}],
          ",", "12"}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"52", ",", "3", ",", 
         RowBox[{"{", 
          RowBox[{"5.74024500465257`", ",", "120.53469250588243`"}], "}"}], 
         ",", "12"}], "}"}]}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"53", ",", "3", ",", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{"-", "4.84772436405885`"}], ",", "80.06530749411753`"}], 
          "}"}], ",", "13"}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"54", ",", "3", ",", 
         RowBox[{"{", 
          RowBox[{"0.5148745022913959`", ",", "80.06530749411753`"}], "}"}], 
         ",", "13"}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"55", ",", "3", ",", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{"-", "4.84772436405885`"}], ",", "120.53469250588243`"}], 
          "}"}], ",", "13"}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"56", ",", "3", ",", 
         RowBox[{"{", 
          RowBox[{"0.5148745022913959`", ",", "120.53469250588243`"}], "}"}], 
         ",", "13"}], "}"}]}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"57", ",", "3", ",", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{"-", "1.5951437358772151`"}], ",", "80.06530749411753`"}], 
          "}"}], ",", "14"}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"58", ",", "3", ",", 
         RowBox[{"{", 
          RowBox[{"3.7674551304730306`", ",", "80.06530749411753`"}], "}"}], 
         ",", "14"}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"59", ",", "3", ",", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{"-", "1.5951437358772151`"}], ",", "120.53469250588243`"}],
           "}"}], ",", "14"}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"60", ",", "3", ",", 
         RowBox[{"{", 
          RowBox[{"3.7674551304730306`", ",", "120.53469250588243`"}], "}"}], 
         ",", "14"}], "}"}]}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"61", ",", "3", ",", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{"-", "4.84772436405885`"}], ",", "120.53469250588243`"}], 
          "}"}], ",", "15"}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"62", ",", "3", ",", 
         RowBox[{"{", 
          RowBox[{"0.5148745022913959`", ",", "120.53469250588243`"}], "}"}], 
         ",", "15"}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"63", ",", "3", ",", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{"-", "4.84772436405885`"}], ",", "161.00407751764732`"}], 
          "}"}], ",", "15"}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"64", ",", "3", ",", 
         RowBox[{"{", 
          RowBox[{"0.5148745022913959`", ",", "161.00407751764732`"}], "}"}], 
         ",", "15"}], "}"}]}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"65", ",", "3", ",", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{"-", "1.5951437358772151`"}], ",", "120.53469250588243`"}],
           "}"}], ",", "16"}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"66", ",", "3", ",", 
         RowBox[{"{", 
          RowBox[{"3.7674551304730306`", ",", "120.53469250588243`"}], "}"}], 
         ",", "16"}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"67", ",", "3", ",", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{"-", "1.5951437358772151`"}], ",", "161.00407751764732`"}],
           "}"}], ",", "16"}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"68", ",", "3", ",", 
         RowBox[{"{", 
          RowBox[{"3.7674551304730306`", ",", "161.00407751764732`"}], "}"}], 
         ",", "16"}], "}"}]}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"69", ",", "3", ",", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{"-", "2.8749344898793114`"}], ",", "80.06530749411753`"}], 
          "}"}], ",", "17"}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"70", ",", "3", ",", 
         RowBox[{"{", 
          RowBox[{"2.4876643764709345`", ",", "80.06530749411753`"}], "}"}], 
         ",", "17"}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"71", ",", "3", ",", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{"-", "2.8749344898793114`"}], ",", "120.53469250588243`"}],
           "}"}], ",", "17"}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"72", ",", "3", ",", 
         RowBox[{"{", 
          RowBox[{"2.4876643764709345`", ",", "120.53469250588243`"}], "}"}], 
         ",", "17"}], "}"}]}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"73", ",", "3", ",", 
         RowBox[{"{", 
          RowBox[{"0.37764613830232374`", ",", "80.06530749411753`"}], "}"}], 
         ",", "18"}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"74", ",", "3", ",", 
         RowBox[{"{", 
          RowBox[{"5.74024500465257`", ",", "80.06530749411753`"}], "}"}], 
         ",", "18"}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"75", ",", "3", ",", 
         RowBox[{"{", 
          RowBox[{"0.37764613830232374`", ",", "120.53469250588243`"}], "}"}],
          ",", "18"}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"76", ",", "3", ",", 
         RowBox[{"{", 
          RowBox[{"5.74024500465257`", ",", "120.53469250588243`"}], "}"}], 
         ",", "18"}], "}"}]}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"77", ",", "3", ",", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{"-", "2.8749344898793114`"}], ",", "120.53469250588243`"}],
           "}"}], ",", "19"}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"78", ",", "3", ",", 
         RowBox[{"{", 
          RowBox[{"2.4876643764709345`", ",", "120.53469250588243`"}], "}"}], 
         ",", "19"}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"79", ",", "3", ",", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{"-", "2.8749344898793114`"}], ",", "161.00407751764732`"}],
           "}"}], ",", "19"}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"80", ",", "3", ",", 
         RowBox[{"{", 
          RowBox[{"2.4876643764709345`", ",", "161.00407751764732`"}], "}"}], 
         ",", "19"}], "}"}]}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"81", ",", "3", ",", 
         RowBox[{"{", 
          RowBox[{"0.37764613830232374`", ",", "120.53469250588243`"}], "}"}],
          ",", "20"}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"82", ",", "3", ",", 
         RowBox[{"{", 
          RowBox[{"5.74024500465257`", ",", "120.53469250588243`"}], "}"}], 
         ",", "20"}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"83", ",", "3", ",", 
         RowBox[{"{", 
          RowBox[{"0.37764613830232374`", ",", "161.00407751764732`"}], "}"}],
          ",", "20"}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"84", ",", "3", ",", 
         RowBox[{"{", 
          RowBox[{"5.74024500465257`", ",", "161.00407751764732`"}], "}"}], 
         ",", "20"}], "}"}]}], "}"}]}], "}"}]}], "}"}]], "Output"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"x", "=", 
  RowBox[{"ConditionalDistribution", "[", 
   RowBox[{"Schwartz2FactorsDistributionD", "[", 
    RowBox[{"0.5", ",", "5", ",", "0.1", ",", "30", ",", "0.", ",", "1."}], 
    "]"}], "]"}]}]], "Input"],

Cell[BoxData[
 RowBox[{"Function", "[", 
  RowBox[{
   RowBox[{"{", 
    RowBox[{"chi$", ",", "zeta$"}], "}"}], ",", 
   RowBox[{"MultinormalDistribution", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
       RowBox[{
        RowBox[{"-", "0.3934693402873666`"}], " ", "chi$"}], ",", "0.1`"}], 
      "}"}], ",", 
     TagBox[
      RowBox[{"{", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{"15.803013970713941`", ",", "0.`"}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{"0.`", ",", "900.`"}], "}"}]}], "}"}],
      Short]}], "]"}]}], "]"}]], "Output"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"h", "=", 
  RowBox[{"x", "[", 
   RowBox[{"10", ",", "100"}], "]"}]}]], "Input"],

Cell[BoxData[
 RowBox[{"MultinormalDistribution", "[", 
  RowBox[{
   RowBox[{"{", 
    RowBox[{
     RowBox[{"-", "3.934693402873666`"}], ",", "0.1`"}], "}"}], ",", 
   TagBox[
    RowBox[{"{", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"15.803013970713941`", ",", "0.`"}], "}"}], ",", 
      RowBox[{"{", 
       RowBox[{"0.`", ",", "900.`"}], "}"}]}], "}"}],
    Short]}], "]"}]], "Output"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"Random", "[", "h", "]"}]], "Input"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{"-", "1.9346934028736662`"}], ",", "2.1`"}], "}"}]], "Output"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"Length", "[", "h", "]"}]], "Input"],

Cell[BoxData["3"], "Output"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"h", "[", 
  RowBox[{"[", "3", "]"}], "]"}]], "Input"],

Cell[BoxData["2"], "Output"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"x", "=", 
  RowBox[{"CompileProcess", "[", 
   RowBox[{"FromProcessTree", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"\"\<Equity\>\"", ",", "\"\<IR\>\"", ",", "\"\<Spread\>\""}], 
      "}"}], ",", 
     RowBox[{"MultiNormalProcess", "[", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"0.1", ",", "0.2", ",", "0.1"}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{"1", ",", "0.5", ",", "0.25"}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{"0.5", ",", "1", ",", "0.25"}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{"0.25", ",", "0.25", ",", "1"}], "}"}]}], "}"}], ",", "2"}],
       "]"}], ",", 
     RowBox[{"{", 
      RowBox[{"1", ",", "1", ",", "1", ",", "1", ",", "1"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"2", ",", "2", ",", "2", ",", "2", ",", "2"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"100", ",", "100", ",", "100"}], "}"}]}], "]"}], 
   "]"}]}]], "Input"],

Cell[BoxData[
 RowBox[{"FromDistributionTree", "[", 
  RowBox[{
   RowBox[{"{", 
    RowBox[{"\<\"Equity\"\>", ",", "\<\"IR\"\>", ",", "\<\"Spread\"\>"}], 
    "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"100", ",", "100", ",", "100"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
       RowBox[{"MultinormalDistributionD", "[", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{"0.1`", ",", "0.2`", ",", "0.1`"}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{"{", 
            RowBox[{"1", ",", "0.5`", ",", "0.25`"}], "}"}], ",", 
           RowBox[{"{", 
            RowBox[{"0.5`", ",", "1", ",", "0.25`"}], "}"}], ",", 
           RowBox[{"{", 
            RowBox[{"0.25`", ",", "0.25`", ",", "1"}], "}"}]}], "}"}], ",", 
         "2"}], "]"}], ",", "1", ",", "2"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"MultinormalDistributionD", "[", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{"0.1`", ",", "0.2`", ",", "0.1`"}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{"{", 
            RowBox[{"1", ",", "0.5`", ",", "0.25`"}], "}"}], ",", 
           RowBox[{"{", 
            RowBox[{"0.5`", ",", "1", ",", "0.25`"}], "}"}], ",", 
           RowBox[{"{", 
            RowBox[{"0.25`", ",", "0.25`", ",", "1"}], "}"}]}], "}"}], ",", 
         "2"}], "]"}], ",", "1", ",", "2"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"MultinormalDistributionD", "[", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{"0.1`", ",", "0.2`", ",", "0.1`"}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{"{", 
            RowBox[{"1", ",", "0.5`", ",", "0.25`"}], "}"}], ",", 
           RowBox[{"{", 
            RowBox[{"0.5`", ",", "1", ",", "0.25`"}], "}"}], ",", 
           RowBox[{"{", 
            RowBox[{"0.25`", ",", "0.25`", ",", "1"}], "}"}]}], "}"}], ",", 
         "2"}], "]"}], ",", "1", ",", "2"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"MultinormalDistributionD", "[", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{"0.1`", ",", "0.2`", ",", "0.1`"}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{"{", 
            RowBox[{"1", ",", "0.5`", ",", "0.25`"}], "}"}], ",", 
           RowBox[{"{", 
            RowBox[{"0.5`", ",", "1", ",", "0.25`"}], "}"}], ",", 
           RowBox[{"{", 
            RowBox[{"0.25`", ",", "0.25`", ",", "1"}], "}"}]}], "}"}], ",", 
         "2"}], "]"}], ",", "1", ",", "2"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"MultinormalDistributionD", "[", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{"0.1`", ",", "0.2`", ",", "0.1`"}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{"{", 
            RowBox[{"1", ",", "0.5`", ",", "0.25`"}], "}"}], ",", 
           RowBox[{"{", 
            RowBox[{"0.5`", ",", "1", ",", "0.25`"}], "}"}], ",", 
           RowBox[{"{", 
            RowBox[{"0.25`", ",", "0.25`", ",", "1"}], "}"}]}], "}"}], ",", 
         "2"}], "]"}], ",", "1", ",", "2"}], "}"}]}], "}"}]}], 
  "]"}]], "Output"]
}, Open  ]]
},
AutoGeneratedPackage->Automatic,
WindowSize->{950, 883},
WindowMargins->{{66, Automatic}, {Automatic, 11}},
PrintingCopies->1,
PrintingPageRange->{Automatic, Automatic},
FrontEndVersion->"7.0 for Mac OS X x86 (32-bit) (February 18, 2009)",
StyleDefinitions->"Default.nb"
]
(* End of Notebook Content *)

(* Internal cache information *)
(*CellTagsOutline
CellTagsIndex->{}
*)
(*CellTagsIndex
CellTagsIndex->{}
*)
(*NotebookFileOutline
Notebook[{
Cell[545, 20, 148, 4, 27, "Input",
 InitializationCell->True],
Cell[696, 26, 146, 4, 27, "Input",
 InitializationCell->True],
Cell[845, 32, 143, 4, 27, "Input",
 InitializationCell->True],
Cell[991, 38, 136, 4, 27, "Input",
 InitializationCell->True],
Cell[1130, 44, 1784, 33, 118, "Input"],
Cell[2917, 79, 552, 16, 43, "Input"],
Cell[3472, 97, 1204, 26, 88, "Input"],
Cell[4679, 125, 922, 20, 118, "Input"],
Cell[5604, 147, 775, 15, 73, "Input"],
Cell[6382, 164, 319, 6, 58, "Input"],
Cell[6704, 172, 187, 4, 27, "Input"],
Cell[6894, 178, 279, 5, 27, "Input"],
Cell[7176, 185, 727, 14, 58, "Input"],
Cell[CellGroupData[{
Cell[7928, 203, 99, 2, 27, "Input"],
Cell[8030, 207, 77, 1, 27, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[8144, 213, 92, 2, 27, "Input"],
Cell[8239, 217, 62, 1, 27, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[8338, 223, 274, 9, 27, "Input"],
Cell[8615, 234, 5112, 275, 186, 3390, 243, "GraphicsData", "PostScript", \
"Graphics"],
Cell[13730, 511, 134, 4, 27, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[13901, 520, 296, 10, 27, "Input"],
Cell[14200, 532, 5568, 327, 186, 4366, 304, "GraphicsData", "PostScript", \
"Graphics"],
Cell[19771, 861, 134, 4, 27, "Output"]
}, Open  ]],
Cell[19920, 868, 314, 10, 27, "Input",
 InitializationCell->True],
Cell[20237, 880, 468, 15, 34, "Input",
 InitializationCell->True],
Cell[CellGroupData[{
Cell[20730, 899, 124, 3, 27, "Input",
 InitializationCell->True],
Cell[20857, 904, 101, 2, 27, "Output"]
}, Open  ]],
Cell[20973, 909, 363, 12, 55, "Input",
 InitializationCell->True],
Cell[21339, 923, 418, 12, 27, "Input",
 InitializationCell->True],
Cell[CellGroupData[{
Cell[21782, 939, 122, 3, 27, "Input",
 InitializationCell->True],
Cell[21907, 944, 101, 2, 27, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[22045, 951, 165, 4, 27, "Input"],
Cell[22213, 957, 296, 9, 68, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[22546, 971, 159, 4, 27, "Input"],
Cell[22708, 977, 171, 5, 30, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[22916, 987, 148, 4, 27, "Input"],
Cell[23067, 993, 290, 9, 34, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[23394, 1007, 202, 6, 27, "Input"],
Cell[23599, 1015, 47, 0, 27, "Output"]
}, Open  ]],
Cell[23661, 1018, 126, 3, 27, "Input",
 InitializationCell->True],
Cell[23790, 1023, 331, 9, 33, "Input"],
Cell[24124, 1034, 366, 10, 43, "Input",
 InitializationCell->True],
Cell[24493, 1046, 303, 8, 27, "Input",
 InitializationCell->True],
Cell[24799, 1056, 1097, 31, 73, "Input",
 InitializationCell->True],
Cell[25899, 1089, 211, 6, 27, "Input",
 InitializationCell->True],
Cell[26113, 1097, 276, 7, 33, "Input"],
Cell[26392, 1106, 369, 11, 27, "Input",
 InitializationCell->True],
Cell[26764, 1119, 1819, 48, 103, "Input",
 InitializationCell->True],
Cell[28586, 1169, 1861, 49, 118, "Input",
 InitializationCell->True],
Cell[CellGroupData[{
Cell[30472, 1222, 485, 14, 43, "Input"],
Cell[30960, 1238, 73, 2, 27, "Output"]
}, Open  ]],
Cell[31048, 1243, 234, 7, 33, "Input"],
Cell[31285, 1252, 1102, 31, 58, "Input",
 InitializationCell->True],
Cell[32390, 1285, 1321, 36, 58, "Input",
 InitializationCell->True],
Cell[33714, 1323, 1780, 47, 88, "Input",
 InitializationCell->True],
Cell[35497, 1372, 2258, 58, 88, "Input",
 InitializationCell->True],
Cell[37758, 1432, 2115, 58, 103, "Input",
 InitializationCell->True],
Cell[39876, 1492, 2686, 71, 118, "Input",
 InitializationCell->True],
Cell[42565, 1565, 4397, 110, 193, "Input",
 InitializationCell->True],
Cell[46965, 1677, 5655, 139, 223, "Input",
 InitializationCell->True],
Cell[52623, 1818, 1367, 37, 103, "Input",
 InitializationCell->True],
Cell[53993, 1857, 788, 22, 58, "Input",
 InitializationCell->True],
Cell[54784, 1881, 523, 17, 27, "Input",
 InitializationCell->True],
Cell[55310, 1900, 165, 5, 33, "Input"],
Cell[55478, 1907, 378, 10, 27, "Input",
 InitializationCell->True],
Cell[55859, 1919, 220, 7, 27, "Input",
 InitializationCell->True],
Cell[56082, 1928, 646, 19, 43, "Input",
 InitializationCell->True],
Cell[56731, 1949, 646, 19, 43, "Input",
 InitializationCell->True],
Cell[57380, 1970, 161, 5, 33, "Input"],
Cell[57544, 1977, 374, 10, 27, "Input",
 InitializationCell->True],
Cell[57921, 1989, 218, 7, 27, "Input",
 InitializationCell->True],
Cell[58142, 1998, 642, 19, 43, "Input",
 InitializationCell->True],
Cell[58787, 2019, 642, 19, 43, "Input",
 InitializationCell->True],
Cell[59432, 2040, 160, 5, 33, "Input"],
Cell[59595, 2047, 312, 8, 27, "Input",
 InitializationCell->True],
Cell[59910, 2057, 577, 17, 43, "Input",
 InitializationCell->True],
Cell[60490, 2076, 576, 17, 43, "Input",
 InitializationCell->True],
Cell[61069, 2095, 186, 6, 27, "Input",
 InitializationCell->True],
Cell[61258, 2103, 322, 8, 27, "Input",
 InitializationCell->True],
Cell[61583, 2113, 167, 5, 33, "Input"],
Cell[61753, 2120, 591, 18, 43, "Input",
 InitializationCell->True],
Cell[62347, 2140, 590, 18, 43, "Input",
 InitializationCell->True],
Cell[62940, 2160, 192, 6, 27, "Input",
 InitializationCell->True],
Cell[63135, 2168, 163, 5, 33, "Input"],
Cell[63301, 2175, 310, 8, 27, "Input",
 InitializationCell->True],
Cell[63614, 2185, 573, 17, 43, "Input",
 InitializationCell->True],
Cell[64190, 2204, 574, 17, 43, "Input",
 InitializationCell->True],
Cell[64767, 2223, 185, 6, 27, "Input",
 InitializationCell->True],
Cell[64955, 2231, 168, 5, 33, "Input"],
Cell[65126, 2238, 388, 10, 43, "Input",
 InitializationCell->True],
Cell[65517, 2250, 656, 19, 43, "Input",
 InitializationCell->True],
Cell[66176, 2271, 656, 19, 43, "Input",
 InitializationCell->True],
Cell[66835, 2292, 225, 7, 27, "Input",
 InitializationCell->True],
Cell[67063, 2301, 162, 5, 33, "Input"],
Cell[67228, 2308, 376, 10, 27, "Input",
 InitializationCell->True],
Cell[67607, 2320, 644, 19, 43, "Input",
 InitializationCell->True],
Cell[68254, 2341, 644, 19, 43, "Input",
 InitializationCell->True],
Cell[68901, 2362, 219, 7, 27, "Input",
 InitializationCell->True],
Cell[69123, 2371, 163, 5, 33, "Input"],
Cell[69289, 2378, 354, 10, 27, "Input",
 InitializationCell->True],
Cell[69646, 2390, 622, 19, 43, "Input",
 InitializationCell->True],
Cell[70271, 2411, 622, 19, 43, "Input",
 InitializationCell->True],
Cell[70896, 2432, 208, 7, 27, "Input",
 InitializationCell->True],
Cell[71107, 2441, 163, 5, 33, "Input"],
Cell[71273, 2448, 368, 10, 27, "Input",
 InitializationCell->True],
Cell[71644, 2460, 636, 19, 43, "Input",
 InitializationCell->True],
Cell[72283, 2481, 636, 19, 43, "Input",
 InitializationCell->True],
Cell[72922, 2502, 212, 6, 27, "Input",
 InitializationCell->True],
Cell[73137, 2510, 162, 5, 33, "Input"],
Cell[73302, 2517, 366, 10, 27, "Input",
 InitializationCell->True],
Cell[73671, 2529, 385, 12, 27, "Input",
 InitializationCell->True],
Cell[74059, 2543, 360, 11, 27, "Input",
 InitializationCell->True],
Cell[74422, 2556, 211, 6, 27, "Input",
 InitializationCell->True],
Cell[74636, 2564, 186, 6, 33, "Input"],
Cell[74825, 2572, 421, 11, 43, "Input",
 InitializationCell->True],
Cell[75249, 2585, 896, 25, 58, "Input",
 InitializationCell->True],
Cell[76148, 2612, 151, 4, 33, "Input"],
Cell[76302, 2618, 451, 13, 27, "Input",
 InitializationCell->True],
Cell[76756, 2633, 443, 14, 27, "Input",
 InitializationCell->True],
Cell[77202, 2649, 422, 12, 27, "Input",
 InitializationCell->True],
Cell[77627, 2663, 233, 7, 27, "Input",
 InitializationCell->True],
Cell[77863, 2672, 172, 5, 33, "Input"],
Cell[78038, 2679, 2075, 60, 73, "Input",
 InitializationCell->True],
Cell[CellGroupData[{
Cell[80138, 2743, 285, 7, 27, "Input",
 InitializationCell->True],
Cell[80426, 2752, 28, 0, 27, "Output"]
}, Open  ]],
Cell[80469, 2755, 181, 5, 33, "Input"],
Cell[80653, 2762, 257, 6, 27, "Input"],
Cell[80913, 2770, 5759, 130, 388, "Input",
 InitializationCell->True],
Cell[86675, 2902, 3696, 92, 238, "Input",
 InitializationCell->True],
Cell[90374, 2996, 6547, 146, 388, "Input",
 InitializationCell->True],
Cell[96924, 3144, 331, 10, 27, "Input"],
Cell[97258, 3156, 10169, 227, 508, "Input",
 InitializationCell->True],
Cell[107430, 3385, 26, 0, 27, "Input"],
Cell[107459, 3387, 4241, 110, 253, "Input",
 InitializationCell->True],
Cell[111703, 3499, 2145, 58, 118, "Input",
 InitializationCell->True],
Cell[113851, 3559, 7127, 178, 418, "Input",
 InitializationCell->True],
Cell[120981, 3739, 5058, 124, 223, "Input",
 InitializationCell->True],
Cell[126042, 3865, 1267, 34, 88, "Input",
 InitializationCell->True],
Cell[127312, 3901, 125, 3, 27, "Input",
 InitializationCell->True],
Cell[127440, 3906, 191, 6, 33, "Input"],
Cell[127634, 3914, 464, 13, 27, "Input",
 InitializationCell->True],
Cell[128101, 3929, 467, 13, 43, "Input",
 InitializationCell->True],
Cell[128571, 3944, 507, 14, 43, "Input",
 InitializationCell->True],
Cell[129081, 3960, 1196, 36, 58, "Input",
 InitializationCell->True],
Cell[130280, 3998, 570, 14, 43, "Input",
 InitializationCell->True],
Cell[130853, 4014, 149, 5, 33, "Input"],
Cell[CellGroupData[{
Cell[131027, 4023, 2111, 55, 118, "Input"],
Cell[133141, 4080, 135, 4, 27, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[133313, 4089, 856, 23, 58, "Input"],
Cell[CellGroupData[{
Cell[134194, 4116, 140, 4, 20, "Print"],
Cell[134337, 4122, 140, 4, 20, "Print"],
Cell[134480, 4128, 140, 4, 20, "Print"]
}, Open  ]],
Cell[134635, 4135, 653, 18, 27, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[135325, 4158, 1706, 43, 73, "Input"],
Cell[CellGroupData[{
Cell[137056, 4205, 196, 6, 20, "Print"],
Cell[137255, 4213, 196, 6, 20, "Print"]
}, Open  ]],
Cell[137466, 4222, 759, 23, 27, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[138262, 4250, 1702, 43, 73, "Input"],
Cell[139967, 4295, 22906, 576, 508, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[162910, 4876, 854, 23, 58, "Input"],
Cell[163767, 4901, 3897, 107, 103, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[167701, 5013, 1416, 36, 73, "Input"],
Cell[169120, 5051, 647, 19, 27, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[169804, 5075, 1914, 50, 88, "Input"],
Cell[CellGroupData[{
Cell[171743, 5129, 51, 0, 20, "Print"],
Cell[171797, 5131, 8214, 231, 201, "Print"]
}, Open  ]],
Cell[180026, 5365, 126, 4, 27, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[180189, 5374, 2516, 65, 118, "Input"],
Cell[182708, 5441, 52, 0, 20, "Print"],
Cell[182763, 5443, 127, 4, 27, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[182927, 5452, 2413, 62, 118, "Input"],
Cell[185343, 5516, 757, 23, 27, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[186137, 5544, 2927, 75, 133, "Input"],
Cell[189067, 5621, 52, 0, 20, "Print"],
Cell[189122, 5623, 110, 3, 27, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[189269, 5631, 491, 12, 27, "Input"],
Cell[189763, 5645, 969, 27, 43, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[190769, 5677, 117, 3, 27, "Input"],
Cell[190889, 5682, 10626, 291, 253, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[201552, 5978, 494, 12, 27, "Input"],
Cell[202049, 5992, 984, 27, 43, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[203070, 6024, 117, 3, 27, "Input"],
Cell[203190, 6029, 10752, 295, 253, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[213979, 6329, 993, 27, 58, "Input"],
Cell[214975, 6358, 3183, 85, 103, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[218195, 6448, 594, 17, 43, "Input"],
Cell[218792, 6467, 53, 0, 20, "Print"],
Cell[218848, 6469, 126, 4, 27, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[219011, 6478, 511, 12, 27, "Input"],
Cell[219525, 6492, 1514, 37, 88, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[221076, 6534, 117, 3, 27, "Input"],
Cell[221196, 6539, 10776, 295, 253, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[232009, 6839, 2193, 58, 103, "Input"],
Cell[CellGroupData[{
Cell[234227, 6901, 50, 0, 20, "Print"],
Cell[234280, 6903, 1447, 41, 66, "Print"]
}, Open  ]],
Cell[235742, 6947, 107, 3, 27, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[235886, 6955, 1440, 40, 73, "Input"],
Cell[237329, 6997, 1308, 38, 73, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[238674, 7040, 93, 2, 27, "Input"],
Cell[238770, 7044, 8714, 236, 223, "Output"]
}, Open  ]],
Cell[247499, 7283, 501, 11, 43, "Input"],
Cell[248003, 7296, 376, 9, 27, "Input"],
Cell[CellGroupData[{
Cell[248404, 7309, 1496, 39, 88, "Input"],
Cell[249903, 7350, 10207, 284, 261, "Print"],
Cell[260113, 7636, 148, 4, 27, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[260298, 7645, 2454, 62, 133, "Input"],
Cell[262755, 7709, 151, 4, 27, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[262943, 7718, 855, 23, 73, "Input"],
Cell[263801, 7743, 747, 22, 43, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[264585, 7770, 88, 2, 27, "Input"],
Cell[264676, 7774, 10208, 284, 268, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[274921, 8063, 1435, 40, 73, "Input"],
Cell[276359, 8105, 1308, 38, 73, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[277704, 8148, 88, 2, 27, "Input"],
Cell[277795, 8152, 8714, 236, 223, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[286546, 8393, 312, 10, 27, "Input"],
Cell[286861, 8405, 516, 12, 27, "Output"]
}, Open  ]],
Cell[287392, 8420, 1115, 31, 73, "Input"],
Cell[CellGroupData[{
Cell[288532, 8455, 587, 15, 43, "Input"],
Cell[289122, 8472, 960, 26, 58, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[290119, 8503, 92, 2, 27, "Input"],
Cell[290214, 8507, 18534, 510, 448, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[308785, 9022, 233, 5, 27, "Input"],
Cell[309021, 9029, 579, 19, 27, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[309637, 9053, 104, 3, 27, "Input"],
Cell[309744, 9058, 400, 13, 27, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[310181, 9076, 59, 1, 27, "Input"],
Cell[310243, 9079, 113, 3, 27, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[310393, 9087, 59, 1, 27, "Input"],
Cell[310455, 9090, 28, 0, 27, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[310520, 9095, 77, 2, 27, "Input"],
Cell[310600, 9099, 28, 0, 27, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[310665, 9104, 993, 27, 58, "Input"],
Cell[311661, 9133, 3183, 85, 103, "Output"]
}, Open  ]]
}
]
*)

(* End of internal cache information *)
